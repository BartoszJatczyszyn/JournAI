2025-08-05 18:17:17,364 - INFO - Database tables created/verified
2025-08-05 18:17:17,364 - INFO - Starting enhanced Garmin data migration...
2025-08-05 18:17:17,625 - INFO - Migrated 277 RHR records
2025-08-05 18:17:17,632 - ERROR - Error migrating sleep data: (psycopg2.errors.NumericValueOutOfRange) integer out of range

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1730419180000, 'day': datetime.date(2024, 11, 1), 'sleep_start': datetime.datetime(2024, 11, 1, 1, 59, 40), 'sleep_end': datetime.datetime(2024, 11, 1, 8, 8, 40), 'sleep_duration_seconds': 21120, 'nap_duration_seconds': 0, 'sleep_score': 69, 'created_at': datetime.datetime(2025, 8, 5, 16, 17, 17, 630454)}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-08-05 18:17:17,632 - ERROR - Migration failed: (psycopg2.errors.NumericValueOutOfRange) integer out of range

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1730419180000, 'day': datetime.date(2024, 11, 1), 'sleep_start': datetime.datetime(2024, 11, 1, 1, 59, 40), 'sleep_end': datetime.datetime(2024, 11, 1, 8, 8, 40), 'sleep_duration_seconds': 21120, 'nap_duration_seconds': 0, 'sleep_score': 69, 'created_at': datetime.datetime(2025, 8, 5, 16, 17, 17, 630454)}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-08-05 18:27:35,763 - INFO - Database tables created/verified
2025-08-05 18:27:35,763 - INFO - Starting enhanced Garmin data migration...
2025-08-05 18:27:36,058 - INFO - Migrated 277 RHR records (0 errors)
2025-08-05 18:27:36,062 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-01.json: (psycopg2.errors.NumericValueOutOfRange) integer out of range

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1730419180000, 'day': datetime.date(2024, 11, 1), 'sleep_start': datetime.datetime(2024, 11, 1, 1, 59, 40), 'sleep_end': datetime.datetime(2024, 11, 1, 8, 8, 40), 'sleep_duration_seconds': 21120, 'nap_duration_seconds': 0, 'sleep_score': 69, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 60609)}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-08-05 18:27:36,063 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1730497155000, 'day': datetime.date(2024, 11, 2), 'sleep_start': datetime.datetime(2024, 11, 1, 23, 39, 15), 'sleep_end': datetime.datetime(2024, 11, 2, 9, 17, 3), 'sleep_duration_seconds': 29508, 'nap_duration_seconds': 0, 'sleep_score': 52, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 62877)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,064 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1730581786000, 'day': datetime.date(2024, 11, 3), 'sleep_start': datetime.datetime(2024, 11, 2, 23, 9, 46), 'sleep_end': datetime.datetime(2024, 11, 3, 8, 16, 46), 'sleep_duration_seconds': 29880, 'nap_duration_seconds': 0, 'sleep_score': 75, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 64087)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,066 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1730670757000, 'day': datetime.date(2024, 11, 4), 'sleep_start': datetime.datetime(2024, 11, 3, 23, 52, 37), 'sleep_end': datetime.datetime(2024, 11, 4, 7, 32, 37), 'sleep_duration_seconds': 26040, 'nap_duration_seconds': 2100, 'sleep_score': 79, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 65534)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,067 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1730762636000, 'day': datetime.date(2024, 11, 5), 'sleep_start': datetime.datetime(2024, 11, 5, 1, 23, 56), 'sleep_end': datetime.datetime(2024, 11, 5, 7, 44, 46), 'sleep_duration_seconds': 21590, 'nap_duration_seconds': 0, 'sleep_score': 73, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 66752)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,068 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1730849001000, 'day': datetime.date(2024, 11, 6), 'sleep_start': datetime.datetime(2024, 11, 6, 1, 23, 21), 'sleep_end': datetime.datetime(2024, 11, 6, 8, 9, 21), 'sleep_duration_seconds': 20640, 'nap_duration_seconds': 0, 'sleep_score': 65, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 68079)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,069 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1730936932000, 'day': datetime.date(2024, 11, 7), 'sleep_start': datetime.datetime(2024, 11, 7, 1, 48, 52), 'sleep_end': datetime.datetime(2024, 11, 7, 8, 10, 52), 'sleep_duration_seconds': 21780, 'nap_duration_seconds': 0, 'sleep_score': 74, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 69235)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,070 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1731075527464, 'day': datetime.date(2024, 11, 8), 'sleep_start': datetime.datetime(2024, 11, 8, 16, 18, 47, 464000), 'sleep_end': datetime.datetime(2024, 11, 8, 22, 8, 47, 464000), 'sleep_duration_seconds': 21000, 'nap_duration_seconds': 1260, 'sleep_score': None, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 70371)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,071 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1731113685000, 'day': datetime.date(2024, 11, 9), 'sleep_start': datetime.datetime(2024, 11, 9, 2, 54, 45), 'sleep_end': datetime.datetime(2024, 11, 9, 8, 20, 45), 'sleep_duration_seconds': 17160, 'nap_duration_seconds': 0, 'sleep_score': 57, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 71499)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,072 - WARNING - No sleep ID found for 2024-11-10
2025-08-05 18:27:36,073 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1731280736000, 'day': datetime.date(2024, 11, 11), 'sleep_start': datetime.datetime(2024, 11, 11, 1, 18, 56), 'sleep_end': datetime.datetime(2024, 11, 11, 4, 46, 56), 'sleep_duration_seconds': 8520, 'nap_duration_seconds': 0, 'sleep_score': 30, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 73038)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,074 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1731356883000, 'day': datetime.date(2024, 11, 12), 'sleep_start': datetime.datetime(2024, 11, 11, 22, 28, 3), 'sleep_end': datetime.datetime(2024, 11, 12, 8, 31, 57), 'sleep_duration_seconds': 32394, 'nap_duration_seconds': 1560, 'sleep_score': 77, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 74277)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,075 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1731452090000, 'day': datetime.date(2024, 11, 13), 'sleep_start': datetime.datetime(2024, 11, 13, 0, 54, 50), 'sleep_end': datetime.datetime(2024, 11, 13, 9, 25, 50), 'sleep_duration_seconds': 29820, 'nap_duration_seconds': 0, 'sleep_score': 88, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 75388)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,077 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1731547447000, 'day': datetime.date(2024, 11, 14), 'sleep_start': datetime.datetime(2024, 11, 14, 3, 24, 7), 'sleep_end': datetime.datetime(2024, 11, 14, 8, 40, 54), 'sleep_duration_seconds': 18947, 'nap_duration_seconds': 2820, 'sleep_score': 68, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 76924)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,078 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1731643703000, 'day': datetime.date(2024, 11, 15), 'sleep_start': datetime.datetime(2024, 11, 15, 6, 8, 23), 'sleep_end': datetime.datetime(2024, 11, 15, 12, 13, 23), 'sleep_duration_seconds': 21780, 'nap_duration_seconds': 0, 'sleep_score': 50, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 78034)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,080 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1731731213000, 'day': datetime.date(2024, 11, 16), 'sleep_start': datetime.datetime(2024, 11, 16, 6, 26, 53), 'sleep_end': datetime.datetime(2024, 11, 16, 12, 32, 53), 'sleep_duration_seconds': 20220, 'nap_duration_seconds': 0, 'sleep_score': 68, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 79458)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,081 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1731798536000, 'day': datetime.date(2024, 11, 17), 'sleep_start': datetime.datetime(2024, 11, 17, 1, 8, 56), 'sleep_end': datetime.datetime(2024, 11, 17, 8, 50, 56), 'sleep_duration_seconds': 27660, 'nap_duration_seconds': 0, 'sleep_score': 88, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 80765)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,082 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1731890937000, 'day': datetime.date(2024, 11, 18), 'sleep_start': datetime.datetime(2024, 11, 18, 2, 48, 57), 'sleep_end': datetime.datetime(2024, 11, 18, 9, 4, 57), 'sleep_duration_seconds': 22260, 'nap_duration_seconds': 0, 'sleep_score': 73, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 81927)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,083 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1731976584000, 'day': datetime.date(2024, 11, 19), 'sleep_start': datetime.datetime(2024, 11, 19, 2, 36, 24), 'sleep_end': datetime.datetime(2024, 11, 19, 10, 30, 24), 'sleep_duration_seconds': 26940, 'nap_duration_seconds': 0, 'sleep_score': 83, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 83070)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,084 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1732060956000, 'day': datetime.date(2024, 11, 20), 'sleep_start': datetime.datetime(2024, 11, 20, 2, 2, 36), 'sleep_end': datetime.datetime(2024, 11, 20, 9, 7, 36), 'sleep_duration_seconds': 25080, 'nap_duration_seconds': 0, 'sleep_score': 79, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 84284)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,086 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1732146689000, 'day': datetime.date(2024, 11, 21), 'sleep_start': datetime.datetime(2024, 11, 21, 1, 51, 29), 'sleep_end': datetime.datetime(2024, 11, 21, 9, 14, 29), 'sleep_duration_seconds': 24900, 'nap_duration_seconds': 0, 'sleep_score': 76, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 85616)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,087 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1732243351000, 'day': datetime.date(2024, 11, 22), 'sleep_start': datetime.datetime(2024, 11, 22, 4, 42, 31), 'sleep_end': datetime.datetime(2024, 11, 22, 7, 43, 31), 'sleep_duration_seconds': 10320, 'nap_duration_seconds': 0, 'sleep_score': None, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 86716)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,088 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1732311339000, 'day': datetime.date(2024, 11, 23), 'sleep_start': datetime.datetime(2024, 11, 22, 23, 35, 39), 'sleep_end': datetime.datetime(2024, 11, 23, 7, 48, 39), 'sleep_duration_seconds': 28920, 'nap_duration_seconds': 0, 'sleep_score': 85, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 87819)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,089 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1732410834000, 'day': datetime.date(2024, 11, 24), 'sleep_start': datetime.datetime(2024, 11, 24, 3, 13, 54), 'sleep_end': datetime.datetime(2024, 11, 24, 10, 45, 54), 'sleep_duration_seconds': 26100, 'nap_duration_seconds': 0, 'sleep_score': 80, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 89252)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,090 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1732491772000, 'day': datetime.date(2024, 11, 25), 'sleep_start': datetime.datetime(2024, 11, 25, 1, 42, 52), 'sleep_end': datetime.datetime(2024, 11, 25, 9, 11, 52), 'sleep_duration_seconds': 26940, 'nap_duration_seconds': 0, 'sleep_score': 92, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 90299)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,092 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1732574165000, 'day': datetime.date(2024, 11, 26), 'sleep_start': datetime.datetime(2024, 11, 26, 0, 36, 5), 'sleep_end': datetime.datetime(2024, 11, 26, 8, 46, 5), 'sleep_duration_seconds': 27000, 'nap_duration_seconds': 1860, 'sleep_score': 77, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 91549)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,093 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1732666440000, 'day': datetime.date(2024, 11, 27), 'sleep_start': datetime.datetime(2024, 11, 27, 2, 14), 'sleep_end': datetime.datetime(2024, 11, 27, 8, 27), 'sleep_duration_seconds': 22140, 'nap_duration_seconds': 0, 'sleep_score': 76, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 92701)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,094 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1732751501000, 'day': datetime.date(2024, 11, 28), 'sleep_start': datetime.datetime(2024, 11, 28, 1, 51, 41), 'sleep_end': datetime.datetime(2024, 11, 28, 9, 14, 41), 'sleep_duration_seconds': 24360, 'nap_duration_seconds': 0, 'sleep_score': 80, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 93840)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,095 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1732836786000, 'day': datetime.date(2024, 11, 29), 'sleep_start': datetime.datetime(2024, 11, 29, 1, 33, 6), 'sleep_end': datetime.datetime(2024, 11, 29, 8, 30, 6), 'sleep_duration_seconds': 24900, 'nap_duration_seconds': 0, 'sleep_score': 84, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 94969)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,096 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1732938498000, 'day': datetime.date(2024, 11, 30), 'sleep_start': datetime.datetime(2024, 11, 30, 5, 48, 18), 'sleep_end': datetime.datetime(2024, 11, 30, 11, 9, 18), 'sleep_duration_seconds': 17940, 'nap_duration_seconds': 0, 'sleep_score': 64, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 96405)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,098 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1733006727000, 'day': datetime.date(2024, 12, 1), 'sleep_start': datetime.datetime(2024, 12, 1, 0, 45, 27), 'sleep_end': datetime.datetime(2024, 12, 1, 9, 25, 27), 'sleep_duration_seconds': 30360, 'nap_duration_seconds': 0, 'sleep_score': 84, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 97688)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,099 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1733095877000, 'day': datetime.date(2024, 12, 2), 'sleep_start': datetime.datetime(2024, 12, 2, 1, 31, 17), 'sleep_end': datetime.datetime(2024, 12, 2, 8, 30, 14), 'sleep_duration_seconds': 24297, 'nap_duration_seconds': 0, 'sleep_score': 76, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 98824)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,100 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1733180955000, 'day': datetime.date(2024, 12, 3), 'sleep_start': datetime.datetime(2024, 12, 3, 1, 9, 15), 'sleep_end': datetime.datetime(2024, 12, 3, 8, 45, 15), 'sleep_duration_seconds': 23820, 'nap_duration_seconds': 0, 'sleep_score': 74, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 99945)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,102 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1733266707000, 'day': datetime.date(2024, 12, 4), 'sleep_start': datetime.datetime(2024, 12, 4, 0, 58, 27), 'sleep_end': datetime.datetime(2024, 12, 4, 8, 18, 27), 'sleep_duration_seconds': 24720, 'nap_duration_seconds': 0, 'sleep_score': 80, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 101596)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,103 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1733364903000, 'day': datetime.date(2024, 12, 5), 'sleep_start': datetime.datetime(2024, 12, 5, 4, 15, 3), 'sleep_end': datetime.datetime(2024, 12, 5, 9, 30, 3), 'sleep_duration_seconds': 18720, 'nap_duration_seconds': 0, 'sleep_score': 66, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 102770)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,104 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1733454000000, 'day': datetime.date(2024, 12, 6), 'sleep_start': datetime.datetime(2024, 12, 6, 5, 0), 'sleep_end': datetime.datetime(2024, 12, 6, 12, 0), 'sleep_duration_seconds': 25200, 'nap_duration_seconds': 0, 'sleep_score': None, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 103935)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,105 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1733523338000, 'day': datetime.date(2024, 12, 7), 'sleep_start': datetime.datetime(2024, 12, 7, 0, 15, 38), 'sleep_end': datetime.datetime(2024, 12, 7, 6, 31, 32), 'sleep_duration_seconds': 22074, 'nap_duration_seconds': 3120, 'sleep_score': 78, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 105097)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,106 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1733616991000, 'day': datetime.date(2024, 12, 8), 'sleep_start': datetime.datetime(2024, 12, 8, 2, 16, 31), 'sleep_end': datetime.datetime(2024, 12, 8, 10, 6, 31), 'sleep_duration_seconds': 25260, 'nap_duration_seconds': 0, 'sleep_score': 76, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 106180)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,107 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1733699294000, 'day': datetime.date(2024, 12, 9), 'sleep_start': datetime.datetime(2024, 12, 9, 1, 8, 14), 'sleep_end': datetime.datetime(2024, 12, 9, 9, 9, 14), 'sleep_duration_seconds': 28380, 'nap_duration_seconds': 0, 'sleep_score': 93, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 107317)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,109 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1733789808000, 'day': datetime.date(2024, 12, 10), 'sleep_start': datetime.datetime(2024, 12, 10, 2, 16, 48), 'sleep_end': datetime.datetime(2024, 12, 10, 9, 48, 48), 'sleep_duration_seconds': 21840, 'nap_duration_seconds': 0, 'sleep_score': 63, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 108457)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,110 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1733876067000, 'day': datetime.date(2024, 12, 11), 'sleep_start': datetime.datetime(2024, 12, 11, 2, 14, 27), 'sleep_end': datetime.datetime(2024, 12, 11, 8, 58, 23), 'sleep_duration_seconds': 21416, 'nap_duration_seconds': 0, 'sleep_score': 62, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 109699)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,111 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1733966368000, 'day': datetime.date(2024, 12, 12), 'sleep_start': datetime.datetime(2024, 12, 12, 3, 19, 28), 'sleep_end': datetime.datetime(2024, 12, 12, 9, 21, 28), 'sleep_duration_seconds': 20280, 'nap_duration_seconds': 4200, 'sleep_score': 67, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 110848)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,112 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1734062732000, 'day': datetime.date(2024, 12, 13), 'sleep_start': datetime.datetime(2024, 12, 13, 6, 5, 32), 'sleep_end': datetime.datetime(2024, 12, 13, 11, 21, 32), 'sleep_duration_seconds': 17700, 'nap_duration_seconds': 7920, 'sleep_score': 56, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 111975)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,113 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1734145184000, 'day': datetime.date(2024, 12, 14), 'sleep_start': datetime.datetime(2024, 12, 14, 4, 59, 44), 'sleep_end': datetime.datetime(2024, 12, 14, 12, 8, 43), 'sleep_duration_seconds': 24059, 'nap_duration_seconds': 0, 'sleep_score': 83, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 113416)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,115 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1734223783000, 'day': datetime.date(2024, 12, 15), 'sleep_start': datetime.datetime(2024, 12, 15, 2, 49, 43), 'sleep_end': datetime.datetime(2024, 12, 15, 10, 37, 38), 'sleep_duration_seconds': 26155, 'nap_duration_seconds': 0, 'sleep_score': 84, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 114766)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,116 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1734302240000, 'day': datetime.date(2024, 12, 16), 'sleep_start': datetime.datetime(2024, 12, 16, 0, 37, 20), 'sleep_end': datetime.datetime(2024, 12, 16, 8, 22, 20), 'sleep_duration_seconds': 27060, 'nap_duration_seconds': 0, 'sleep_score': 84, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 115869)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,117 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1734388679000, 'day': datetime.date(2024, 12, 17), 'sleep_start': datetime.datetime(2024, 12, 17, 0, 37, 59), 'sleep_end': datetime.datetime(2024, 12, 17, 8, 41, 59), 'sleep_duration_seconds': 28620, 'nap_duration_seconds': 0, 'sleep_score': 90, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 117144)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,118 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1734478200000, 'day': datetime.date(2024, 12, 18), 'sleep_start': datetime.datetime(2024, 12, 18, 1, 30), 'sleep_end': datetime.datetime(2024, 12, 18, 8, 21), 'sleep_duration_seconds': 22620, 'nap_duration_seconds': 0, 'sleep_score': 74, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 118340)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,120 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1734560951000, 'day': datetime.date(2024, 12, 19), 'sleep_start': datetime.datetime(2024, 12, 19, 0, 29, 11), 'sleep_end': datetime.datetime(2024, 12, 19, 8, 20, 11), 'sleep_duration_seconds': 23220, 'nap_duration_seconds': 0, 'sleep_score': 44, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 119605)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,121 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1734655498000, 'day': datetime.date(2024, 12, 20), 'sleep_start': datetime.datetime(2024, 12, 20, 2, 44, 58), 'sleep_end': datetime.datetime(2024, 12, 20, 9, 57, 58), 'sleep_duration_seconds': 22620, 'nap_duration_seconds': 0, 'sleep_score': 61, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 120910)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,122 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1734734905000, 'day': datetime.date(2024, 12, 21), 'sleep_start': datetime.datetime(2024, 12, 21, 0, 48, 25), 'sleep_end': datetime.datetime(2024, 12, 21, 9, 48, 25), 'sleep_duration_seconds': 28920, 'nap_duration_seconds': 0, 'sleep_score': 61, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 122170)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,123 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1734826548000, 'day': datetime.date(2024, 12, 22), 'sleep_start': datetime.datetime(2024, 12, 22, 2, 15, 48), 'sleep_end': datetime.datetime(2024, 12, 22, 9, 13, 48), 'sleep_duration_seconds': 22260, 'nap_duration_seconds': 0, 'sleep_score': 68, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 123290)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,125 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1734901126000, 'day': datetime.date(2024, 12, 23), 'sleep_start': datetime.datetime(2024, 12, 22, 22, 58, 46), 'sleep_end': datetime.datetime(2024, 12, 23, 9, 49, 46), 'sleep_duration_seconds': 35160, 'nap_duration_seconds': 0, 'sleep_score': 73, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 124679)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,126 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1734995263000, 'day': datetime.date(2024, 12, 24), 'sleep_start': datetime.datetime(2024, 12, 24, 1, 7, 43), 'sleep_end': datetime.datetime(2024, 12, 24, 9, 39, 43), 'sleep_duration_seconds': 26760, 'nap_duration_seconds': 0, 'sleep_score': 58, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 125947)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,127 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1735087768000, 'day': datetime.date(2024, 12, 25), 'sleep_start': datetime.datetime(2024, 12, 25, 2, 49, 28), 'sleep_end': datetime.datetime(2024, 12, 25, 9, 31, 28), 'sleep_duration_seconds': 22860, 'nap_duration_seconds': 0, 'sleep_score': 75, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 127072)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,128 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1735159367000, 'day': datetime.date(2024, 12, 26), 'sleep_start': datetime.datetime(2024, 12, 25, 22, 42, 47), 'sleep_end': datetime.datetime(2024, 12, 26, 7, 31, 47), 'sleep_duration_seconds': 30600, 'nap_duration_seconds': 0, 'sleep_score': 88, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 128161)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,129 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1735252953000, 'day': datetime.date(2024, 12, 27), 'sleep_start': datetime.datetime(2024, 12, 27, 0, 42, 33), 'sleep_end': datetime.datetime(2024, 12, 27, 8, 3, 33), 'sleep_duration_seconds': 23580, 'nap_duration_seconds': 0, 'sleep_score': 64, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 129268)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,130 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1735341838000, 'day': datetime.date(2024, 12, 28), 'sleep_start': datetime.datetime(2024, 12, 28, 1, 23, 58), 'sleep_end': datetime.datetime(2024, 12, 28, 9, 26, 58), 'sleep_duration_seconds': 27180, 'nap_duration_seconds': 0, 'sleep_score': 83, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 130440)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,132 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1735425118000, 'day': datetime.date(2024, 12, 29), 'sleep_start': datetime.datetime(2024, 12, 29, 0, 31, 58), 'sleep_end': datetime.datetime(2024, 12, 29, 7, 15, 58), 'sleep_duration_seconds': 22440, 'nap_duration_seconds': 0, 'sleep_score': 69, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 131576)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,133 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1735512162000, 'day': datetime.date(2024, 12, 30), 'sleep_start': datetime.datetime(2024, 12, 30, 0, 42, 42), 'sleep_end': datetime.datetime(2024, 12, 30, 7, 30, 42), 'sleep_duration_seconds': 22980, 'nap_duration_seconds': 3060, 'sleep_score': 75, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 132780)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,134 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-31.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1735596602000, 'day': datetime.date(2024, 12, 31), 'sleep_start': datetime.datetime(2024, 12, 31, 0, 10, 2), 'sleep_end': datetime.datetime(2024, 12, 31, 7, 30, 2), 'sleep_duration_seconds': 24420, 'nap_duration_seconds': 0, 'sleep_score': 63, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 134024)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,135 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1735703507000, 'day': datetime.date(2025, 1, 1), 'sleep_start': datetime.datetime(2025, 1, 1, 5, 51, 47), 'sleep_end': datetime.datetime(2025, 1, 1, 12, 34, 47), 'sleep_duration_seconds': 16440, 'nap_duration_seconds': 0, 'sleep_score': 29, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 135202)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,137 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1735766673000, 'day': datetime.date(2025, 1, 2), 'sleep_start': datetime.datetime(2025, 1, 1, 23, 24, 33), 'sleep_end': datetime.datetime(2025, 1, 2, 7, 43, 33), 'sleep_duration_seconds': 28500, 'nap_duration_seconds': 0, 'sleep_score': 83, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 136721)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,138 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1735864366000, 'day': datetime.date(2025, 1, 3), 'sleep_start': datetime.datetime(2025, 1, 3, 2, 32, 46), 'sleep_end': datetime.datetime(2025, 1, 3, 9, 16, 25), 'sleep_duration_seconds': 23859, 'nap_duration_seconds': 0, 'sleep_score': 81, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 137836)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,139 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1735946588000, 'day': datetime.date(2025, 1, 4), 'sleep_start': datetime.datetime(2025, 1, 4, 1, 23, 8), 'sleep_end': datetime.datetime(2025, 1, 4, 8, 30, 8), 'sleep_duration_seconds': 25440, 'nap_duration_seconds': 0, 'sleep_score': 85, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 139137)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,140 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1736033918000, 'day': datetime.date(2025, 1, 5), 'sleep_start': datetime.datetime(2025, 1, 5, 1, 38, 38), 'sleep_end': datetime.datetime(2025, 1, 5, 9, 19, 38), 'sleep_duration_seconds': 25860, 'nap_duration_seconds': 0, 'sleep_score': 79, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 140392)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,142 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1736120556000, 'day': datetime.date(2025, 1, 6), 'sleep_start': datetime.datetime(2025, 1, 6, 1, 42, 36), 'sleep_end': datetime.datetime(2025, 1, 6, 8, 34, 36), 'sleep_duration_seconds': 23280, 'nap_duration_seconds': 0, 'sleep_score': 74, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 141548)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,143 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1736199003000, 'day': datetime.date(2025, 1, 7), 'sleep_start': datetime.datetime(2025, 1, 6, 23, 30, 3), 'sleep_end': datetime.datetime(2025, 1, 7, 10, 0, 20), 'sleep_duration_seconds': 35117, 'nap_duration_seconds': 0, 'sleep_score': 79, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 142647)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,144 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1736292466000, 'day': datetime.date(2025, 1, 8), 'sleep_start': datetime.datetime(2025, 1, 8, 1, 27, 46), 'sleep_end': datetime.datetime(2025, 1, 8, 9, 47, 3), 'sleep_duration_seconds': 27797, 'nap_duration_seconds': 0, 'sleep_score': 81, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 143788)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,145 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1736380346000, 'day': datetime.date(2025, 1, 9), 'sleep_start': datetime.datetime(2025, 1, 9, 1, 52, 26), 'sleep_end': datetime.datetime(2025, 1, 9, 9, 35, 26), 'sleep_duration_seconds': 26760, 'nap_duration_seconds': 0, 'sleep_score': 86, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 144865)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,146 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1736461866000, 'day': datetime.date(2025, 1, 10), 'sleep_start': datetime.datetime(2025, 1, 10, 0, 31, 6), 'sleep_end': datetime.datetime(2025, 1, 10, 8, 53, 6), 'sleep_duration_seconds': 28500, 'nap_duration_seconds': 0, 'sleep_score': 87, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 146082)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,147 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1736557266000, 'day': datetime.date(2025, 1, 11), 'sleep_start': datetime.datetime(2025, 1, 11, 3, 1, 6), 'sleep_end': datetime.datetime(2025, 1, 11, 9, 57, 6), 'sleep_duration_seconds': 24000, 'nap_duration_seconds': 0, 'sleep_score': 79, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 147234)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,149 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1736643708000, 'day': datetime.date(2025, 1, 12), 'sleep_start': datetime.datetime(2025, 1, 12, 3, 1, 48), 'sleep_end': datetime.datetime(2025, 1, 12, 11, 5, 48), 'sleep_duration_seconds': 24660, 'nap_duration_seconds': 0, 'sleep_score': 72, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 148650)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,150 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1736733380000, 'day': datetime.date(2025, 1, 13), 'sleep_start': datetime.datetime(2025, 1, 13, 3, 56, 20), 'sleep_end': datetime.datetime(2025, 1, 13, 8, 39, 20), 'sleep_duration_seconds': 15960, 'nap_duration_seconds': 0, 'sleep_score': 49, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 149916)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,151 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1736813289000, 'day': datetime.date(2025, 1, 14), 'sleep_start': datetime.datetime(2025, 1, 14, 2, 8, 9), 'sleep_end': datetime.datetime(2025, 1, 14, 8, 30, 9), 'sleep_duration_seconds': 22320, 'nap_duration_seconds': 2160, 'sleep_score': 78, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 151039)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,152 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1736892759000, 'day': datetime.date(2025, 1, 15), 'sleep_start': datetime.datetime(2025, 1, 15, 0, 12, 39), 'sleep_end': datetime.datetime(2025, 1, 15, 8, 48, 39), 'sleep_duration_seconds': 29760, 'nap_duration_seconds': 0, 'sleep_score': 91, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 152115)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,153 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1736981813000, 'day': datetime.date(2025, 1, 16), 'sleep_start': datetime.datetime(2025, 1, 16, 0, 56, 53), 'sleep_end': datetime.datetime(2025, 1, 16, 10, 25, 48), 'sleep_duration_seconds': 31855, 'nap_duration_seconds': 0, 'sleep_score': 81, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 153201)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,155 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1737086350000, 'day': datetime.date(2025, 1, 17), 'sleep_start': datetime.datetime(2025, 1, 17, 5, 59, 10), 'sleep_end': datetime.datetime(2025, 1, 17, 11, 19, 10), 'sleep_duration_seconds': 16980, 'nap_duration_seconds': 0, 'sleep_score': 49, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 154526)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,156 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1737149027000, 'day': datetime.date(2025, 1, 18), 'sleep_start': datetime.datetime(2025, 1, 17, 23, 23, 47), 'sleep_end': datetime.datetime(2025, 1, 18, 3, 30, 16), 'sleep_duration_seconds': 14729, 'nap_duration_seconds': 0, 'sleep_score': 55, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 155689)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,157 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1737238169000, 'day': datetime.date(2025, 1, 19), 'sleep_start': datetime.datetime(2025, 1, 19, 0, 9, 29), 'sleep_end': datetime.datetime(2025, 1, 19, 8, 55, 19), 'sleep_duration_seconds': 31490, 'nap_duration_seconds': 0, 'sleep_score': 95, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 157001)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,158 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1737335139000, 'day': datetime.date(2025, 1, 20), 'sleep_start': datetime.datetime(2025, 1, 20, 3, 5, 39), 'sleep_end': datetime.datetime(2025, 1, 20, 10, 23, 39), 'sleep_duration_seconds': 24780, 'nap_duration_seconds': 0, 'sleep_score': 76, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 158138)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,159 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1737413110000, 'day': datetime.date(2025, 1, 21), 'sleep_start': datetime.datetime(2025, 1, 21, 0, 45, 10), 'sleep_end': datetime.datetime(2025, 1, 21, 9, 4, 10), 'sleep_duration_seconds': 26460, 'nap_duration_seconds': 0, 'sleep_score': 83, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 159341)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,161 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1737499781000, 'day': datetime.date(2025, 1, 22), 'sleep_start': datetime.datetime(2025, 1, 22, 0, 49, 41), 'sleep_end': datetime.datetime(2025, 1, 22, 8, 30, 41), 'sleep_duration_seconds': 26520, 'nap_duration_seconds': 0, 'sleep_score': 85, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 161180)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,162 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1737587687000, 'day': datetime.date(2025, 1, 23), 'sleep_start': datetime.datetime(2025, 1, 23, 1, 14, 47), 'sleep_end': datetime.datetime(2025, 1, 23, 8, 13, 47), 'sleep_duration_seconds': 24240, 'nap_duration_seconds': 0, 'sleep_score': 84, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 162309)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,164 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1737672157000, 'day': datetime.date(2025, 1, 24), 'sleep_start': datetime.datetime(2025, 1, 24, 0, 42, 37), 'sleep_end': datetime.datetime(2025, 1, 24, 8, 23, 37), 'sleep_duration_seconds': 24000, 'nap_duration_seconds': 0, 'sleep_score': 80, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 163490)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,165 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1737760045000, 'day': datetime.date(2025, 1, 25), 'sleep_start': datetime.datetime(2025, 1, 25, 1, 7, 25), 'sleep_end': datetime.datetime(2025, 1, 25, 9, 34, 25), 'sleep_duration_seconds': 30360, 'nap_duration_seconds': 0, 'sleep_score': 88, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 164652)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,166 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1737842022000, 'day': datetime.date(2025, 1, 26), 'sleep_start': datetime.datetime(2025, 1, 25, 23, 53, 42), 'sleep_end': datetime.datetime(2025, 1, 26, 9, 0, 42), 'sleep_duration_seconds': 28800, 'nap_duration_seconds': 0, 'sleep_score': 92, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 165729)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,167 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1737937578000, 'day': datetime.date(2025, 1, 27), 'sleep_start': datetime.datetime(2025, 1, 27, 2, 26, 18), 'sleep_end': datetime.datetime(2025, 1, 27, 8, 51, 18), 'sleep_duration_seconds': 21060, 'nap_duration_seconds': 0, 'sleep_score': 71, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 166898)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,168 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1738018644000, 'day': datetime.date(2025, 1, 28), 'sleep_start': datetime.datetime(2025, 1, 28, 3, 57, 24), 'sleep_end': datetime.datetime(2025, 1, 28, 7, 28, 24), 'sleep_duration_seconds': 9120, 'nap_duration_seconds': 0, 'sleep_score': 33, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 168005)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,169 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1738089083000, 'day': datetime.date(2025, 1, 29), 'sleep_start': datetime.datetime(2025, 1, 29, 2, 31, 23), 'sleep_end': datetime.datetime(2025, 1, 29, 6, 1, 5), 'sleep_duration_seconds': 10722, 'nap_duration_seconds': 0, 'sleep_score': 34, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 169198)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,170 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1738175891000, 'day': datetime.date(2025, 1, 30), 'sleep_start': datetime.datetime(2025, 1, 30, 2, 38, 11), 'sleep_end': datetime.datetime(2025, 1, 30, 6, 11, 41), 'sleep_duration_seconds': 11130, 'nap_duration_seconds': 0, 'sleep_score': 39, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 170410)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,172 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-31.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1738251586000, 'day': datetime.date(2025, 1, 31), 'sleep_start': datetime.datetime(2025, 1, 30, 23, 39, 46), 'sleep_end': datetime.datetime(2025, 1, 31, 5, 58, 46), 'sleep_duration_seconds': 20220, 'nap_duration_seconds': 0, 'sleep_score': 72, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 171709)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,173 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1738340805000, 'day': datetime.date(2025, 2, 1), 'sleep_start': datetime.datetime(2025, 2, 1, 0, 26, 45), 'sleep_end': datetime.datetime(2025, 2, 1, 8, 23, 45), 'sleep_duration_seconds': 27600, 'nap_duration_seconds': 0, 'sleep_score': 82, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 173136)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,174 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1738429981000, 'day': datetime.date(2025, 2, 2), 'sleep_start': datetime.datetime(2025, 2, 2, 1, 13, 1), 'sleep_end': datetime.datetime(2025, 2, 2, 7, 40, 1), 'sleep_duration_seconds': 22200, 'nap_duration_seconds': 0, 'sleep_score': 72, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 174272)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,175 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1738513711000, 'day': datetime.date(2025, 2, 3), 'sleep_start': datetime.datetime(2025, 2, 3, 0, 28, 31), 'sleep_end': datetime.datetime(2025, 2, 3, 7, 5, 24), 'sleep_duration_seconds': 23633, 'nap_duration_seconds': 0, 'sleep_score': 48, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 175477)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,177 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1738606259000, 'day': datetime.date(2025, 2, 4), 'sleep_start': datetime.datetime(2025, 2, 4, 2, 10, 59), 'sleep_end': datetime.datetime(2025, 2, 4, 7, 14, 59), 'sleep_duration_seconds': 16920, 'nap_duration_seconds': 0, 'sleep_score': 57, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 176729)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,178 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1738686494000, 'day': datetime.date(2025, 2, 5), 'sleep_start': datetime.datetime(2025, 2, 5, 0, 28, 14), 'sleep_end': datetime.datetime(2025, 2, 5, 7, 54, 14), 'sleep_duration_seconds': 26640, 'nap_duration_seconds': 0, 'sleep_score': 60, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 177906)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,179 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1738770717000, 'day': datetime.date(2025, 2, 6), 'sleep_start': datetime.datetime(2025, 2, 5, 23, 51, 57), 'sleep_end': datetime.datetime(2025, 2, 6, 6, 37, 57), 'sleep_duration_seconds': 22740, 'nap_duration_seconds': 0, 'sleep_score': 68, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 179227)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,180 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1738863988000, 'day': datetime.date(2025, 2, 7), 'sleep_start': datetime.datetime(2025, 2, 7, 1, 46, 28), 'sleep_end': datetime.datetime(2025, 2, 7, 8, 25, 28), 'sleep_duration_seconds': 23520, 'nap_duration_seconds': 0, 'sleep_score': 79, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 180432)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,182 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1738949963000, 'day': datetime.date(2025, 2, 8), 'sleep_start': datetime.datetime(2025, 2, 8, 1, 39, 23), 'sleep_end': datetime.datetime(2025, 2, 8, 2, 21, 23), 'sleep_duration_seconds': 2460, 'nap_duration_seconds': 4200, 'sleep_score': 29, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 181539)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,183 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1739027059000, 'day': datetime.date(2025, 2, 9), 'sleep_start': datetime.datetime(2025, 2, 8, 23, 4, 19), 'sleep_end': datetime.datetime(2025, 2, 9, 8, 32, 49), 'sleep_duration_seconds': 33330, 'nap_duration_seconds': 0, 'sleep_score': 59, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 182791)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,184 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1739116721000, 'day': datetime.date(2025, 2, 10), 'sleep_start': datetime.datetime(2025, 2, 9, 23, 58, 41), 'sleep_end': datetime.datetime(2025, 2, 10, 6, 40, 41), 'sleep_duration_seconds': 21000, 'nap_duration_seconds': 0, 'sleep_score': 60, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 184206)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,185 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1739212791000, 'day': datetime.date(2025, 2, 11), 'sleep_start': datetime.datetime(2025, 2, 11, 2, 39, 51), 'sleep_end': datetime.datetime(2025, 2, 11, 8, 7, 47), 'sleep_duration_seconds': 18776, 'nap_duration_seconds': 0, 'sleep_score': 68, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 185327)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,187 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1739297535000, 'day': datetime.date(2025, 2, 12), 'sleep_start': datetime.datetime(2025, 2, 12, 2, 12, 15), 'sleep_end': datetime.datetime(2025, 2, 12, 8, 2, 15), 'sleep_duration_seconds': 21000, 'nap_duration_seconds': 0, 'sleep_score': 74, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 186494)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,188 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1739379969000, 'day': datetime.date(2025, 2, 13), 'sleep_start': datetime.datetime(2025, 2, 13, 1, 6, 9), 'sleep_end': datetime.datetime(2025, 2, 13, 7, 24, 9), 'sleep_duration_seconds': 20340, 'nap_duration_seconds': 0, 'sleep_score': 32, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 187884)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,189 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1739470402000, 'day': datetime.date(2025, 2, 14), 'sleep_start': datetime.datetime(2025, 2, 14, 2, 13, 22), 'sleep_end': datetime.datetime(2025, 2, 14, 5, 45, 22), 'sleep_duration_seconds': 12300, 'nap_duration_seconds': 0, 'sleep_score': 43, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 189155)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,190 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1739548363000, 'day': datetime.date(2025, 2, 15), 'sleep_start': datetime.datetime(2025, 2, 14, 23, 52, 43), 'sleep_end': datetime.datetime(2025, 2, 15, 7, 40, 43), 'sleep_duration_seconds': 21780, 'nap_duration_seconds': 0, 'sleep_score': 77, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 190360)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,191 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1739638599000, 'day': datetime.date(2025, 2, 16), 'sleep_start': datetime.datetime(2025, 2, 16, 0, 56, 39), 'sleep_end': datetime.datetime(2025, 2, 16, 7, 38, 28), 'sleep_duration_seconds': 22069, 'nap_duration_seconds': 1980, 'sleep_score': 76, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 191497)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,193 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1739717369000, 'day': datetime.date(2025, 2, 17), 'sleep_start': datetime.datetime(2025, 2, 16, 22, 49, 29), 'sleep_end': datetime.datetime(2025, 2, 17, 7, 9, 25), 'sleep_duration_seconds': 26576, 'nap_duration_seconds': 0, 'sleep_score': 73, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 192617)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,194 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1739804427000, 'day': datetime.date(2025, 2, 18), 'sleep_start': datetime.datetime(2025, 2, 17, 23, 0, 27), 'sleep_end': datetime.datetime(2025, 2, 18, 7, 10, 10), 'sleep_duration_seconds': 27283, 'nap_duration_seconds': 0, 'sleep_score': 84, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 193682)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,195 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1739892511000, 'day': datetime.date(2025, 2, 19), 'sleep_start': datetime.datetime(2025, 2, 18, 23, 28, 31), 'sleep_end': datetime.datetime(2025, 2, 19, 6, 30, 9), 'sleep_duration_seconds': 23798, 'nap_duration_seconds': 1440, 'sleep_score': 80, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 194774)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,196 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1739981177000, 'day': datetime.date(2025, 2, 20), 'sleep_start': datetime.datetime(2025, 2, 20, 0, 6, 17), 'sleep_end': datetime.datetime(2025, 2, 20, 6, 25, 17), 'sleep_duration_seconds': 20280, 'nap_duration_seconds': 0, 'sleep_score': 63, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 196429)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,198 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1740064927000, 'day': datetime.date(2025, 2, 21), 'sleep_start': datetime.datetime(2025, 2, 20, 23, 22, 7), 'sleep_end': datetime.datetime(2025, 2, 21, 5, 50, 7), 'sleep_duration_seconds': 21540, 'nap_duration_seconds': 0, 'sleep_score': 77, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 197704)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,199 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1740149230000, 'day': datetime.date(2025, 2, 22), 'sleep_start': datetime.datetime(2025, 2, 21, 22, 47, 10), 'sleep_end': datetime.datetime(2025, 2, 22, 7, 1, 10), 'sleep_duration_seconds': 24780, 'nap_duration_seconds': 0, 'sleep_score': 69, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 198808)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,200 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1740251562000, 'day': datetime.date(2025, 2, 23), 'sleep_start': datetime.datetime(2025, 2, 23, 3, 12, 42), 'sleep_end': datetime.datetime(2025, 2, 23, 8, 38, 42), 'sleep_duration_seconds': 13860, 'nap_duration_seconds': 0, 'sleep_score': 46, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 199906)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,200 - WARNING - No sleep ID found for 2025-02-24
2025-08-05 18:27:36,201 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1740409893000, 'day': datetime.date(2025, 2, 25), 'sleep_start': datetime.datetime(2025, 2, 24, 23, 11, 33), 'sleep_end': datetime.datetime(2025, 2, 25, 7, 58, 21), 'sleep_duration_seconds': 28488, 'nap_duration_seconds': 0, 'sleep_score': 96, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 201404)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,203 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1740498605000, 'day': datetime.date(2025, 2, 26), 'sleep_start': datetime.datetime(2025, 2, 25, 23, 50, 5), 'sleep_end': datetime.datetime(2025, 2, 26, 6, 43, 5), 'sleep_duration_seconds': 24780, 'nap_duration_seconds': 0, 'sleep_score': 85, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 202483)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,204 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1740586757000, 'day': datetime.date(2025, 2, 27), 'sleep_start': datetime.datetime(2025, 2, 27, 0, 19, 17), 'sleep_end': datetime.datetime(2025, 2, 27, 6, 21, 17), 'sleep_duration_seconds': 20460, 'nap_duration_seconds': 0, 'sleep_score': 70, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 203796)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,205 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1740671293000, 'day': datetime.date(2025, 2, 28), 'sleep_start': datetime.datetime(2025, 2, 27, 23, 48, 13), 'sleep_end': datetime.datetime(2025, 2, 28, 8, 9, 40), 'sleep_duration_seconds': 28287, 'nap_duration_seconds': 0, 'sleep_score': 97, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 204920)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,207 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1740755358000, 'day': datetime.date(2025, 3, 1), 'sleep_start': datetime.datetime(2025, 2, 28, 23, 9, 18), 'sleep_end': datetime.datetime(2025, 3, 1, 7, 8, 47), 'sleep_duration_seconds': 25349, 'nap_duration_seconds': 0, 'sleep_score': 68, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 206793)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,209 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1740843135000, 'day': datetime.date(2025, 3, 2), 'sleep_start': datetime.datetime(2025, 3, 1, 23, 32, 15), 'sleep_end': datetime.datetime(2025, 3, 2, 7, 53, 5), 'sleep_duration_seconds': 28790, 'nap_duration_seconds': 0, 'sleep_score': 62, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 209322)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,211 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1740935495000, 'day': datetime.date(2025, 3, 3), 'sleep_start': datetime.datetime(2025, 3, 3, 1, 11, 35), 'sleep_end': datetime.datetime(2025, 3, 3, 6, 55, 33), 'sleep_duration_seconds': 20578, 'nap_duration_seconds': 0, 'sleep_score': 57, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 211191)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,213 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1741020058000, 'day': datetime.date(2025, 3, 4), 'sleep_start': datetime.datetime(2025, 3, 4, 0, 40, 58), 'sleep_end': datetime.datetime(2025, 3, 4, 6, 33, 58), 'sleep_duration_seconds': 21180, 'nap_duration_seconds': 0, 'sleep_score': 56, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 213007)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,215 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1741101046000, 'day': datetime.date(2025, 3, 5), 'sleep_start': datetime.datetime(2025, 3, 4, 23, 10, 46), 'sleep_end': datetime.datetime(2025, 3, 5, 7, 48, 33), 'sleep_duration_seconds': 30827, 'nap_duration_seconds': 0, 'sleep_score': 50, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 215318)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,217 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1741190173000, 'day': datetime.date(2025, 3, 6), 'sleep_start': datetime.datetime(2025, 3, 5, 23, 56, 13), 'sleep_end': datetime.datetime(2025, 3, 6, 8, 9, 13), 'sleep_duration_seconds': 28680, 'nap_duration_seconds': 0, 'sleep_score': 75, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 217214)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,219 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1741277500000, 'day': datetime.date(2025, 3, 7), 'sleep_start': datetime.datetime(2025, 3, 7, 0, 11, 40), 'sleep_end': datetime.datetime(2025, 3, 7, 7, 45, 14), 'sleep_duration_seconds': 25594, 'nap_duration_seconds': 0, 'sleep_score': 84, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 219016)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,221 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1741367697000, 'day': datetime.date(2025, 3, 8), 'sleep_start': datetime.datetime(2025, 3, 8, 1, 14, 57), 'sleep_end': datetime.datetime(2025, 3, 8, 6, 8, 50), 'sleep_duration_seconds': 17573, 'nap_duration_seconds': 0, 'sleep_score': 64, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 220739)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,222 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1741451022000, 'day': datetime.date(2025, 3, 9), 'sleep_start': datetime.datetime(2025, 3, 9, 0, 23, 42), 'sleep_end': datetime.datetime(2025, 3, 9, 7, 0, 9), 'sleep_duration_seconds': 22107, 'nap_duration_seconds': 0, 'sleep_score': 70, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 222364)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,225 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1741536145000, 'day': datetime.date(2025, 3, 10), 'sleep_start': datetime.datetime(2025, 3, 10, 0, 2, 25), 'sleep_end': datetime.datetime(2025, 3, 10, 9, 1, 25), 'sleep_duration_seconds': 30060, 'nap_duration_seconds': 0, 'sleep_score': 79, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 224692)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,226 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1741627040000, 'day': datetime.date(2025, 3, 11), 'sleep_start': datetime.datetime(2025, 3, 11, 1, 17, 20), 'sleep_end': datetime.datetime(2025, 3, 11, 7, 22, 54), 'sleep_duration_seconds': 18754, 'nap_duration_seconds': 0, 'sleep_score': 67, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 226403)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,228 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1741790188000, 'day': datetime.date(2025, 3, 12), 'sleep_start': datetime.datetime(2025, 3, 12, 19, 36, 28), 'sleep_end': datetime.datetime(2025, 3, 12, 21, 59, 28), 'sleep_duration_seconds': 7980, 'nap_duration_seconds': 0, 'sleep_score': 30, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 227723)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,228 - WARNING - No sleep ID found for 2025-03-13
2025-08-05 18:27:36,230 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1741964832000, 'day': datetime.date(2025, 3, 14), 'sleep_start': datetime.datetime(2025, 3, 14, 17, 7, 12), 'sleep_end': datetime.datetime(2025, 3, 14, 21, 3, 12), 'sleep_duration_seconds': 14160, 'nap_duration_seconds': 0, 'sleep_score': 51, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 229612)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,231 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1742000206000, 'day': datetime.date(2025, 3, 15), 'sleep_start': datetime.datetime(2025, 3, 15, 2, 56, 46), 'sleep_end': datetime.datetime(2025, 3, 15, 7, 13, 7), 'sleep_duration_seconds': 15381, 'nap_duration_seconds': 0, 'sleep_score': 56, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 231216)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,231 - WARNING - No sleep ID found for 2025-03-16
2025-08-05 18:27:36,233 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1742176367000, 'day': datetime.date(2025, 3, 17), 'sleep_start': datetime.datetime(2025, 3, 17, 3, 52, 47), 'sleep_end': datetime.datetime(2025, 3, 17, 9, 45, 47), 'sleep_duration_seconds': 19320, 'nap_duration_seconds': 0, 'sleep_score': 67, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 232939)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,235 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1742244024000, 'day': datetime.date(2025, 3, 18), 'sleep_start': datetime.datetime(2025, 3, 17, 22, 40, 24), 'sleep_end': datetime.datetime(2025, 3, 18, 7, 18, 2), 'sleep_duration_seconds': 29978, 'nap_duration_seconds': 0, 'sleep_score': 83, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 235292)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,237 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1742333663000, 'day': datetime.date(2025, 3, 19), 'sleep_start': datetime.datetime(2025, 3, 18, 23, 34, 23), 'sleep_end': datetime.datetime(2025, 3, 19, 6, 47, 23), 'sleep_duration_seconds': 23880, 'nap_duration_seconds': 0, 'sleep_score': 75, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 237134)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,239 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1742417244000, 'day': datetime.date(2025, 3, 20), 'sleep_start': datetime.datetime(2025, 3, 19, 22, 47, 24), 'sleep_end': datetime.datetime(2025, 3, 20, 7, 52, 24), 'sleep_duration_seconds': 31200, 'nap_duration_seconds': 0, 'sleep_score': 82, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 239116)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,241 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1742509215000, 'day': datetime.date(2025, 3, 21), 'sleep_start': datetime.datetime(2025, 3, 21, 0, 20, 15), 'sleep_end': datetime.datetime(2025, 3, 21, 8, 25, 15), 'sleep_duration_seconds': 28260, 'nap_duration_seconds': 0, 'sleep_score': 92, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 241125)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,243 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1742593324000, 'day': datetime.date(2025, 3, 22), 'sleep_start': datetime.datetime(2025, 3, 21, 23, 42, 4), 'sleep_end': datetime.datetime(2025, 3, 22, 7, 59, 4), 'sleep_duration_seconds': 27780, 'nap_duration_seconds': 0, 'sleep_score': 83, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 243069)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,245 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1742685870000, 'day': datetime.date(2025, 3, 23), 'sleep_start': datetime.datetime(2025, 3, 23, 1, 24, 30), 'sleep_end': datetime.datetime(2025, 3, 23, 7, 59, 6), 'sleep_duration_seconds': 23676, 'nap_duration_seconds': 0, 'sleep_score': 81, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 244923)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,247 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1742766816000, 'day': datetime.date(2025, 3, 24), 'sleep_start': datetime.datetime(2025, 3, 23, 23, 53, 36), 'sleep_end': datetime.datetime(2025, 3, 24, 7, 41, 36), 'sleep_duration_seconds': 27960, 'nap_duration_seconds': 0, 'sleep_score': 93, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 246909)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,249 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1742857109000, 'day': datetime.date(2025, 3, 25), 'sleep_start': datetime.datetime(2025, 3, 25, 0, 58, 29), 'sleep_end': datetime.datetime(2025, 3, 25, 8, 32, 29), 'sleep_duration_seconds': 26640, 'nap_duration_seconds': 0, 'sleep_score': 84, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 249031)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,251 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1742938051000, 'day': datetime.date(2025, 3, 26), 'sleep_start': datetime.datetime(2025, 3, 25, 23, 27, 31), 'sleep_end': datetime.datetime(2025, 3, 26, 7, 20, 31), 'sleep_duration_seconds': 28380, 'nap_duration_seconds': 0, 'sleep_score': 96, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 251021)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,253 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1743025273000, 'day': datetime.date(2025, 3, 27), 'sleep_start': datetime.datetime(2025, 3, 26, 23, 41, 13), 'sleep_end': datetime.datetime(2025, 3, 27, 8, 0, 13), 'sleep_duration_seconds': 29880, 'nap_duration_seconds': 0, 'sleep_score': 99, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 252929)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,255 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1743118928000, 'day': datetime.date(2025, 3, 28), 'sleep_start': datetime.datetime(2025, 3, 28, 1, 42, 8), 'sleep_end': datetime.datetime(2025, 3, 28, 9, 2, 8), 'sleep_duration_seconds': 25980, 'nap_duration_seconds': 0, 'sleep_score': 86, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 254845)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,257 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1743203877000, 'day': datetime.date(2025, 3, 29), 'sleep_start': datetime.datetime(2025, 3, 29, 1, 17, 57), 'sleep_end': datetime.datetime(2025, 3, 29, 6, 0, 57), 'sleep_duration_seconds': 15000, 'nap_duration_seconds': 0, 'sleep_score': 55, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 256563)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,258 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1743296400000, 'day': datetime.date(2025, 3, 30), 'sleep_start': datetime.datetime(2025, 3, 30, 5, 0), 'sleep_end': datetime.datetime(2025, 3, 30, 12, 30), 'sleep_duration_seconds': 26880, 'nap_duration_seconds': 7200, 'sleep_score': 87, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 258458)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,260 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-31.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1743368293000, 'day': datetime.date(2025, 3, 31), 'sleep_start': datetime.datetime(2025, 3, 31, 0, 58, 13), 'sleep_end': datetime.datetime(2025, 3, 31, 10, 0, 13), 'sleep_duration_seconds': 32460, 'nap_duration_seconds': 0, 'sleep_score': 93, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 260462)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,263 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1743454302000, 'day': datetime.date(2025, 4, 1), 'sleep_start': datetime.datetime(2025, 4, 1, 0, 51, 42), 'sleep_end': datetime.datetime(2025, 4, 1, 10, 17, 42), 'sleep_duration_seconds': 33780, 'nap_duration_seconds': 0, 'sleep_score': 93, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 262547)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,265 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1743543731000, 'day': datetime.date(2025, 4, 2), 'sleep_start': datetime.datetime(2025, 4, 2, 1, 42, 11), 'sleep_end': datetime.datetime(2025, 4, 2, 10, 20, 27), 'sleep_duration_seconds': 27376, 'nap_duration_seconds': 0, 'sleep_score': 83, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 264854)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,267 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1743633998000, 'day': datetime.date(2025, 4, 3), 'sleep_start': datetime.datetime(2025, 4, 3, 2, 46, 38), 'sleep_end': datetime.datetime(2025, 4, 3, 9, 13, 57), 'sleep_duration_seconds': 23239, 'nap_duration_seconds': 0, 'sleep_score': 88, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 266648)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,267 - WARNING - No sleep ID found for 2025-04-04
2025-08-05 18:27:36,269 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1743809996000, 'day': datetime.date(2025, 4, 5), 'sleep_start': datetime.datetime(2025, 4, 5, 4, 39, 56), 'sleep_end': datetime.datetime(2025, 4, 5, 11, 3, 56), 'sleep_duration_seconds': 21780, 'nap_duration_seconds': 0, 'sleep_score': 70, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 268622)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,270 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1743898366000, 'day': datetime.date(2025, 4, 6), 'sleep_start': datetime.datetime(2025, 4, 6, 5, 12, 46), 'sleep_end': datetime.datetime(2025, 4, 6, 11, 13, 46), 'sleep_duration_seconds': 21660, 'nap_duration_seconds': 0, 'sleep_score': 75, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 270275)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,272 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1743978333000, 'day': datetime.date(2025, 4, 7), 'sleep_start': datetime.datetime(2025, 4, 7, 3, 25, 33), 'sleep_end': datetime.datetime(2025, 4, 7, 9, 0, 9), 'sleep_duration_seconds': 19956, 'nap_duration_seconds': 0, 'sleep_score': 70, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 271811)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,274 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1744058303000, 'day': datetime.date(2025, 4, 8), 'sleep_start': datetime.datetime(2025, 4, 8, 0, 38, 23), 'sleep_end': datetime.datetime(2025, 4, 8, 10, 30, 23), 'sleep_duration_seconds': 34380, 'nap_duration_seconds': 0, 'sleep_score': 93, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 274155)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,276 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1744149467000, 'day': datetime.date(2025, 4, 9), 'sleep_start': datetime.datetime(2025, 4, 9, 1, 57, 47), 'sleep_end': datetime.datetime(2025, 4, 9, 8, 52, 47), 'sleep_duration_seconds': 22380, 'nap_duration_seconds': 0, 'sleep_score': 76, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 275993)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,278 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1744235021000, 'day': datetime.date(2025, 4, 10), 'sleep_start': datetime.datetime(2025, 4, 10, 1, 43, 41), 'sleep_end': datetime.datetime(2025, 4, 10, 9, 0, 41), 'sleep_duration_seconds': 25320, 'nap_duration_seconds': 0, 'sleep_score': 85, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 277921)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,280 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1744339469000, 'day': datetime.date(2025, 4, 11), 'sleep_start': datetime.datetime(2025, 4, 11, 6, 44, 29), 'sleep_end': datetime.datetime(2025, 4, 11, 10, 47, 29), 'sleep_duration_seconds': 14400, 'nap_duration_seconds': 0, 'sleep_score': 48, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 279638)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,282 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1744412006000, 'day': datetime.date(2025, 4, 12), 'sleep_start': datetime.datetime(2025, 4, 12, 2, 53, 26), 'sleep_end': datetime.datetime(2025, 4, 12, 10, 7, 26), 'sleep_duration_seconds': 26040, 'nap_duration_seconds': 0, 'sleep_score': 88, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 281574)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,284 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1744494448000, 'day': datetime.date(2025, 4, 13), 'sleep_start': datetime.datetime(2025, 4, 13, 1, 47, 28), 'sleep_end': datetime.datetime(2025, 4, 13, 10, 46, 50), 'sleep_duration_seconds': 30262, 'nap_duration_seconds': 0, 'sleep_score': 91, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 283641)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,286 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1744579800000, 'day': datetime.date(2025, 4, 14), 'sleep_start': datetime.datetime(2025, 4, 14, 1, 30), 'sleep_end': datetime.datetime(2025, 4, 14, 10, 37), 'sleep_duration_seconds': 29100, 'nap_duration_seconds': 0, 'sleep_score': 84, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 285536)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,287 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1744666099000, 'day': datetime.date(2025, 4, 15), 'sleep_start': datetime.datetime(2025, 4, 15, 1, 28, 19), 'sleep_end': datetime.datetime(2025, 4, 15, 8, 32, 19), 'sleep_duration_seconds': 25320, 'nap_duration_seconds': 0, 'sleep_score': 81, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 287422)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,289 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1744754464000, 'day': datetime.date(2025, 4, 16), 'sleep_start': datetime.datetime(2025, 4, 16, 2, 1, 4), 'sleep_end': datetime.datetime(2025, 4, 16, 8, 4, 4), 'sleep_duration_seconds': 19440, 'nap_duration_seconds': 0, 'sleep_score': 71, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 289019)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,291 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1744838706000, 'day': datetime.date(2025, 4, 17), 'sleep_start': datetime.datetime(2025, 4, 17, 1, 25, 6), 'sleep_end': datetime.datetime(2025, 4, 17, 10, 1, 6), 'sleep_duration_seconds': 29280, 'nap_duration_seconds': 0, 'sleep_score': 79, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 291154)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,293 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1744925456000, 'day': datetime.date(2025, 4, 18), 'sleep_start': datetime.datetime(2025, 4, 18, 1, 30, 56), 'sleep_end': datetime.datetime(2025, 4, 18, 8, 44, 56), 'sleep_duration_seconds': 24360, 'nap_duration_seconds': 0, 'sleep_score': 78, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 293074)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,295 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1745012736000, 'day': datetime.date(2025, 4, 19), 'sleep_start': datetime.datetime(2025, 4, 19, 1, 45, 36), 'sleep_end': datetime.datetime(2025, 4, 19, 10, 18, 36), 'sleep_duration_seconds': 28620, 'nap_duration_seconds': 0, 'sleep_score': 91, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 294986)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,297 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1745086741000, 'day': datetime.date(2025, 4, 20), 'sleep_start': datetime.datetime(2025, 4, 19, 22, 19, 1), 'sleep_end': datetime.datetime(2025, 4, 20, 9, 11, 1), 'sleep_duration_seconds': 34620, 'nap_duration_seconds': 0, 'sleep_score': 84, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 297248)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,299 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1745188694000, 'day': datetime.date(2025, 4, 21), 'sleep_start': datetime.datetime(2025, 4, 21, 2, 38, 14), 'sleep_end': datetime.datetime(2025, 4, 21, 10, 44, 14), 'sleep_duration_seconds': 26580, 'nap_duration_seconds': 0, 'sleep_score': 66, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 299218)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,302 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1745261846000, 'day': datetime.date(2025, 4, 22), 'sleep_start': datetime.datetime(2025, 4, 21, 22, 57, 26), 'sleep_end': datetime.datetime(2025, 4, 22, 10, 53, 26), 'sleep_duration_seconds': 41040, 'nap_duration_seconds': 0, 'sleep_score': 90, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 301756)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,304 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1745357799000, 'day': datetime.date(2025, 4, 23), 'sleep_start': datetime.datetime(2025, 4, 23, 1, 36, 39), 'sleep_end': datetime.datetime(2025, 4, 23, 7, 42, 28), 'sleep_duration_seconds': 21889, 'nap_duration_seconds': 0, 'sleep_score': 77, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 303585)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,306 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1745448434000, 'day': datetime.date(2025, 4, 24), 'sleep_start': datetime.datetime(2025, 4, 24, 2, 47, 14), 'sleep_end': datetime.datetime(2025, 4, 24, 9, 11, 2), 'sleep_duration_seconds': 22848, 'nap_duration_seconds': 0, 'sleep_score': 81, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 305805)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,308 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1745530818000, 'day': datetime.date(2025, 4, 25), 'sleep_start': datetime.datetime(2025, 4, 25, 1, 40, 18), 'sleep_end': datetime.datetime(2025, 4, 25, 9, 16, 18), 'sleep_duration_seconds': 23700, 'nap_duration_seconds': 0, 'sleep_score': 80, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 308192)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,311 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1745614440000, 'day': datetime.date(2025, 4, 26), 'sleep_start': datetime.datetime(2025, 4, 26, 0, 54), 'sleep_end': datetime.datetime(2025, 4, 26, 8, 51), 'sleep_duration_seconds': 28140, 'nap_duration_seconds': 0, 'sleep_score': 94, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 310575)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,312 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1745712068000, 'day': datetime.date(2025, 4, 27), 'sleep_start': datetime.datetime(2025, 4, 27, 4, 1, 8), 'sleep_end': datetime.datetime(2025, 4, 27, 9, 52, 8), 'sleep_duration_seconds': 20280, 'nap_duration_seconds': 0, 'sleep_score': 71, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 312457)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,315 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1745789400000, 'day': datetime.date(2025, 4, 28), 'sleep_start': datetime.datetime(2025, 4, 28, 1, 30), 'sleep_end': datetime.datetime(2025, 4, 28, 10, 0), 'sleep_duration_seconds': 24420, 'nap_duration_seconds': 0, 'sleep_score': 75, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 314799)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,317 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1745877568000, 'day': datetime.date(2025, 4, 29), 'sleep_start': datetime.datetime(2025, 4, 29, 1, 59, 28), 'sleep_end': datetime.datetime(2025, 4, 29, 9, 2, 28), 'sleep_duration_seconds': 25020, 'nap_duration_seconds': 0, 'sleep_score': 79, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 317398)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,320 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1745962749000, 'day': datetime.date(2025, 4, 30), 'sleep_start': datetime.datetime(2025, 4, 30, 1, 39, 9), 'sleep_end': datetime.datetime(2025, 4, 30, 8, 14, 9), 'sleep_duration_seconds': 20940, 'nap_duration_seconds': 0, 'sleep_score': 72, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 319809)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,322 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1746065542000, 'day': datetime.date(2025, 5, 1), 'sleep_start': datetime.datetime(2025, 5, 1, 6, 12, 22), 'sleep_end': datetime.datetime(2025, 5, 1, 9, 51, 22), 'sleep_duration_seconds': 13020, 'nap_duration_seconds': 0, 'sleep_score': 38, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 321720)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,324 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1746145611000, 'day': datetime.date(2025, 5, 2), 'sleep_start': datetime.datetime(2025, 5, 2, 4, 26, 51), 'sleep_end': datetime.datetime(2025, 5, 2, 12, 19, 16), 'sleep_duration_seconds': 27805, 'nap_duration_seconds': 0, 'sleep_score': 92, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 324014)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,326 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1746245954000, 'day': datetime.date(2025, 5, 3), 'sleep_start': datetime.datetime(2025, 5, 3, 8, 19, 14), 'sleep_end': datetime.datetime(2025, 5, 3, 11, 25, 14), 'sleep_duration_seconds': 8640, 'nap_duration_seconds': 0, 'sleep_score': 30, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 325707)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,328 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1746315310000, 'day': datetime.date(2025, 5, 4), 'sleep_start': datetime.datetime(2025, 5, 4, 3, 35, 10), 'sleep_end': datetime.datetime(2025, 5, 4, 9, 18, 10), 'sleep_duration_seconds': 19860, 'nap_duration_seconds': 1020, 'sleep_score': 57, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 327675)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,330 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1746393807000, 'day': datetime.date(2025, 5, 5), 'sleep_start': datetime.datetime(2025, 5, 5, 1, 23, 27), 'sleep_end': datetime.datetime(2025, 5, 5, 10, 0, 11), 'sleep_duration_seconds': 25784, 'nap_duration_seconds': 0, 'sleep_score': 84, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 330240)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,333 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1746484955000, 'day': datetime.date(2025, 5, 6), 'sleep_start': datetime.datetime(2025, 5, 6, 2, 42, 35), 'sleep_end': datetime.datetime(2025, 5, 6, 10, 47, 35), 'sleep_duration_seconds': 27720, 'nap_duration_seconds': 0, 'sleep_score': 87, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 332619)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,335 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1746570026000, 'day': datetime.date(2025, 5, 7), 'sleep_start': datetime.datetime(2025, 5, 7, 2, 20, 26), 'sleep_end': datetime.datetime(2025, 5, 7, 9, 30, 26), 'sleep_duration_seconds': 25800, 'nap_duration_seconds': 0, 'sleep_score': 85, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 334843)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,337 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1746657306000, 'day': datetime.date(2025, 5, 8), 'sleep_start': datetime.datetime(2025, 5, 8, 2, 35, 6), 'sleep_end': datetime.datetime(2025, 5, 8, 9, 20, 6), 'sleep_duration_seconds': 19500, 'nap_duration_seconds': 0, 'sleep_score': 71, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 337055)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,340 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1746734697000, 'day': datetime.date(2025, 5, 9), 'sleep_start': datetime.datetime(2025, 5, 9, 0, 4, 57), 'sleep_end': datetime.datetime(2025, 5, 9, 8, 25, 57), 'sleep_duration_seconds': 28620, 'nap_duration_seconds': 0, 'sleep_score': 89, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 339714)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,342 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1746822600000, 'day': datetime.date(2025, 5, 10), 'sleep_start': datetime.datetime(2025, 5, 10, 0, 30), 'sleep_end': datetime.datetime(2025, 5, 10, 9, 45), 'sleep_duration_seconds': 31860, 'nap_duration_seconds': 0, 'sleep_score': 80, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 342369)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,345 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1746910500000, 'day': datetime.date(2025, 5, 11), 'sleep_start': datetime.datetime(2025, 5, 11, 0, 55), 'sleep_end': datetime.datetime(2025, 5, 11, 7, 15), 'sleep_duration_seconds': 21060, 'nap_duration_seconds': 4260, 'sleep_score': 69, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 344561)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,347 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1747002660000, 'day': datetime.date(2025, 5, 12), 'sleep_start': datetime.datetime(2025, 5, 12, 2, 31), 'sleep_end': datetime.datetime(2025, 5, 12, 10, 0), 'sleep_duration_seconds': 26460, 'nap_duration_seconds': 0, 'sleep_score': 83, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 346731)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,349 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1747080000000, 'day': datetime.date(2025, 5, 13), 'sleep_start': datetime.datetime(2025, 5, 13, 0, 0), 'sleep_end': datetime.datetime(2025, 5, 13, 9, 59), 'sleep_duration_seconds': 32280, 'nap_duration_seconds': 0, 'sleep_score': 61, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 349337)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,352 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1747169104000, 'day': datetime.date(2025, 5, 14), 'sleep_start': datetime.datetime(2025, 5, 14, 0, 45, 4), 'sleep_end': datetime.datetime(2025, 5, 14, 10, 6, 4), 'sleep_duration_seconds': 29340, 'nap_duration_seconds': 0, 'sleep_score': 79, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 351751)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,354 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1747281135000, 'day': datetime.date(2025, 5, 15), 'sleep_start': datetime.datetime(2025, 5, 15, 7, 52, 15), 'sleep_end': datetime.datetime(2025, 5, 15, 14, 57, 15), 'sleep_duration_seconds': 21840, 'nap_duration_seconds': 0, 'sleep_score': 68, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 353789)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,356 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1747341497000, 'day': datetime.date(2025, 5, 16), 'sleep_start': datetime.datetime(2025, 5, 16, 0, 38, 17), 'sleep_end': datetime.datetime(2025, 5, 16, 10, 44, 17), 'sleep_duration_seconds': 31920, 'nap_duration_seconds': 0, 'sleep_score': 90, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 356365)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,358 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1747452967000, 'day': datetime.date(2025, 5, 17), 'sleep_start': datetime.datetime(2025, 5, 17, 7, 36, 7), 'sleep_end': datetime.datetime(2025, 5, 17, 12, 11, 7), 'sleep_duration_seconds': 16500, 'nap_duration_seconds': 0, 'sleep_score': 53, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 358194)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,359 - WARNING - No sleep ID found for 2025-05-18
2025-08-05 18:27:36,362 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1747581533000, 'day': datetime.date(2025, 5, 19), 'sleep_start': datetime.datetime(2025, 5, 18, 19, 18, 53), 'sleep_end': datetime.datetime(2025, 5, 19, 10, 58, 53), 'sleep_duration_seconds': 47760, 'nap_duration_seconds': 0, 'sleep_score': 73, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 361523)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,364 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1747689773000, 'day': datetime.date(2025, 5, 20), 'sleep_start': datetime.datetime(2025, 5, 20, 1, 22, 53), 'sleep_end': datetime.datetime(2025, 5, 20, 10, 38, 53), 'sleep_duration_seconds': 32040, 'nap_duration_seconds': 0, 'sleep_score': 92, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 364124)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,367 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1747774049000, 'day': datetime.date(2025, 5, 21), 'sleep_start': datetime.datetime(2025, 5, 21, 0, 47, 29), 'sleep_end': datetime.datetime(2025, 5, 21, 9, 14, 29), 'sleep_duration_seconds': 30420, 'nap_duration_seconds': 0, 'sleep_score': 95, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 366515)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,369 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1747864719000, 'day': datetime.date(2025, 5, 22), 'sleep_start': datetime.datetime(2025, 5, 22, 1, 58, 39), 'sleep_end': datetime.datetime(2025, 5, 22, 9, 44, 8), 'sleep_duration_seconds': 27569, 'nap_duration_seconds': 0, 'sleep_score': 90, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 368794)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,371 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1747951291000, 'day': datetime.date(2025, 5, 23), 'sleep_start': datetime.datetime(2025, 5, 23, 2, 1, 31), 'sleep_end': datetime.datetime(2025, 5, 23, 7, 20, 31), 'sleep_duration_seconds': 17400, 'nap_duration_seconds': 0, 'sleep_score': 66, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 370836)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,373 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1748053245000, 'day': datetime.date(2025, 5, 24), 'sleep_start': datetime.datetime(2025, 5, 24, 6, 20, 45), 'sleep_end': datetime.datetime(2025, 5, 24, 10, 32, 45), 'sleep_duration_seconds': 15120, 'nap_duration_seconds': 0, 'sleep_score': 34, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 372685)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,374 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1748141753000, 'day': datetime.date(2025, 5, 25), 'sleep_start': datetime.datetime(2025, 5, 25, 6, 55, 53), 'sleep_end': datetime.datetime(2025, 5, 25, 11, 0, 53), 'sleep_duration_seconds': 14700, 'nap_duration_seconds': 1260, 'sleep_score': 35, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 374252)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,377 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1748199732000, 'day': datetime.date(2025, 5, 26), 'sleep_start': datetime.datetime(2025, 5, 25, 23, 2, 12), 'sleep_end': datetime.datetime(2025, 5, 26, 10, 38, 12), 'sleep_duration_seconds': 30780, 'nap_duration_seconds': 2280, 'sleep_score': 54, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 377381)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,380 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1748291666000, 'day': datetime.date(2025, 5, 27), 'sleep_start': datetime.datetime(2025, 5, 27, 0, 34, 26), 'sleep_end': datetime.datetime(2025, 5, 27, 10, 8, 26), 'sleep_duration_seconds': 34140, 'nap_duration_seconds': 0, 'sleep_score': 91, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 379913)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,382 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1748379443000, 'day': datetime.date(2025, 5, 28), 'sleep_start': datetime.datetime(2025, 5, 28, 0, 57, 23), 'sleep_end': datetime.datetime(2025, 5, 28, 9, 22, 23), 'sleep_duration_seconds': 30240, 'nap_duration_seconds': 0, 'sleep_score': 96, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 382284)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,385 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1748464163000, 'day': datetime.date(2025, 5, 29), 'sleep_start': datetime.datetime(2025, 5, 29, 0, 29, 23), 'sleep_end': datetime.datetime(2025, 5, 29, 10, 21, 23), 'sleep_duration_seconds': 34140, 'nap_duration_seconds': 0, 'sleep_score': 94, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 385045)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,388 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1748552368000, 'day': datetime.date(2025, 5, 30), 'sleep_start': datetime.datetime(2025, 5, 30, 0, 59, 28), 'sleep_end': datetime.datetime(2025, 5, 30, 8, 51, 28), 'sleep_duration_seconds': 27540, 'nap_duration_seconds': 0, 'sleep_score': 88, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 387534)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,390 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-31.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1748638395000, 'day': datetime.date(2025, 5, 31), 'sleep_start': datetime.datetime(2025, 5, 31, 0, 53, 15), 'sleep_end': datetime.datetime(2025, 5, 31, 10, 14, 15), 'sleep_duration_seconds': 30840, 'nap_duration_seconds': 0, 'sleep_score': 79, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 390198)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,392 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1748728865000, 'day': datetime.date(2025, 6, 1), 'sleep_start': datetime.datetime(2025, 6, 1, 2, 1, 5), 'sleep_end': datetime.datetime(2025, 6, 1, 8, 23, 5), 'sleep_duration_seconds': 22140, 'nap_duration_seconds': 0, 'sleep_score': 74, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 392449)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,395 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1748818253000, 'day': datetime.date(2025, 6, 2), 'sleep_start': datetime.datetime(2025, 6, 2, 2, 50, 53), 'sleep_end': datetime.datetime(2025, 6, 2, 9, 36, 53), 'sleep_duration_seconds': 21840, 'nap_duration_seconds': 0, 'sleep_score': 67, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 394660)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,397 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1748896866000, 'day': datetime.date(2025, 6, 3), 'sleep_start': datetime.datetime(2025, 6, 3, 0, 41, 6), 'sleep_end': datetime.datetime(2025, 6, 3, 8, 38, 6), 'sleep_duration_seconds': 28380, 'nap_duration_seconds': 0, 'sleep_score': 92, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 397373)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,400 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1748985359000, 'day': datetime.date(2025, 6, 4), 'sleep_start': datetime.datetime(2025, 6, 4, 1, 15, 59), 'sleep_end': datetime.datetime(2025, 6, 4, 8, 42, 59), 'sleep_duration_seconds': 26580, 'nap_duration_seconds': 0, 'sleep_score': 90, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 399758)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,403 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1749070242000, 'day': datetime.date(2025, 6, 5), 'sleep_start': datetime.datetime(2025, 6, 5, 0, 50, 42), 'sleep_end': datetime.datetime(2025, 6, 5, 9, 45, 42), 'sleep_duration_seconds': 31680, 'nap_duration_seconds': 0, 'sleep_score': 89, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 402616)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,405 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1749161528000, 'day': datetime.date(2025, 6, 6), 'sleep_start': datetime.datetime(2025, 6, 6, 2, 12, 8), 'sleep_end': datetime.datetime(2025, 6, 6, 9, 11, 8), 'sleep_duration_seconds': 24840, 'nap_duration_seconds': 0, 'sleep_score': 83, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 405306)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,408 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1749246703000, 'day': datetime.date(2025, 6, 7), 'sleep_start': datetime.datetime(2025, 6, 7, 1, 51, 43), 'sleep_end': datetime.datetime(2025, 6, 7, 9, 46, 43), 'sleep_duration_seconds': 28380, 'nap_duration_seconds': 0, 'sleep_score': 84, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 407842)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,410 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1749337276000, 'day': datetime.date(2025, 6, 8), 'sleep_start': datetime.datetime(2025, 6, 8, 3, 1, 16), 'sleep_end': datetime.datetime(2025, 6, 8, 9, 46, 16), 'sleep_duration_seconds': 23880, 'nap_duration_seconds': 0, 'sleep_score': 82, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 410090)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,412 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1749423995000, 'day': datetime.date(2025, 6, 9), 'sleep_start': datetime.datetime(2025, 6, 9, 3, 6, 35), 'sleep_end': datetime.datetime(2025, 6, 9, 9, 43, 58), 'sleep_duration_seconds': 20243, 'nap_duration_seconds': 0, 'sleep_score': 67, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 412288)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,415 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1749503773000, 'day': datetime.date(2025, 6, 10), 'sleep_start': datetime.datetime(2025, 6, 10, 1, 16, 13), 'sleep_end': datetime.datetime(2025, 6, 10, 8, 37, 45), 'sleep_duration_seconds': 20912, 'nap_duration_seconds': 0, 'sleep_score': 57, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 414771)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,417 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1749590518000, 'day': datetime.date(2025, 6, 11), 'sleep_start': datetime.datetime(2025, 6, 11, 1, 21, 58), 'sleep_end': datetime.datetime(2025, 6, 11, 9, 55, 57), 'sleep_duration_seconds': 28979, 'nap_duration_seconds': 0, 'sleep_score': 98, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 417268)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,420 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1749674446000, 'day': datetime.date(2025, 6, 12), 'sleep_start': datetime.datetime(2025, 6, 12, 0, 40, 46), 'sleep_end': datetime.datetime(2025, 6, 12, 8, 43, 46), 'sleep_duration_seconds': 27420, 'nap_duration_seconds': 0, 'sleep_score': 87, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 419738)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,423 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1749760856000, 'day': datetime.date(2025, 6, 13), 'sleep_start': datetime.datetime(2025, 6, 13, 0, 40, 56), 'sleep_end': datetime.datetime(2025, 6, 13, 9, 51, 32), 'sleep_duration_seconds': 32676, 'nap_duration_seconds': 0, 'sleep_score': 93, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 422945)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,425 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1749852092000, 'day': datetime.date(2025, 6, 14), 'sleep_start': datetime.datetime(2025, 6, 14, 2, 1, 32), 'sleep_end': datetime.datetime(2025, 6, 14, 9, 1, 32), 'sleep_duration_seconds': 25020, 'nap_duration_seconds': 0, 'sleep_score': 84, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 425347)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,428 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1749940119000, 'day': datetime.date(2025, 6, 15), 'sleep_start': datetime.datetime(2025, 6, 15, 2, 28, 39), 'sleep_end': datetime.datetime(2025, 6, 15, 9, 42, 39), 'sleep_duration_seconds': 24060, 'nap_duration_seconds': 0, 'sleep_score': 73, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 428039)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,431 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1750025663000, 'day': datetime.date(2025, 6, 16), 'sleep_start': datetime.datetime(2025, 6, 16, 2, 14, 23), 'sleep_end': datetime.datetime(2025, 6, 16, 9, 21, 3), 'sleep_duration_seconds': 25540, 'nap_duration_seconds': 0, 'sleep_score': 85, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 430515)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,433 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1750108902000, 'day': datetime.date(2025, 6, 17), 'sleep_start': datetime.datetime(2025, 6, 17, 1, 21, 42), 'sleep_end': datetime.datetime(2025, 6, 17, 9, 24, 42), 'sleep_duration_seconds': 27660, 'nap_duration_seconds': 0, 'sleep_score': 88, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 433082)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,435 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1750198018000, 'day': datetime.date(2025, 6, 18), 'sleep_start': datetime.datetime(2025, 6, 18, 2, 6, 58), 'sleep_end': datetime.datetime(2025, 6, 18, 9, 28, 58), 'sleep_duration_seconds': 26160, 'nap_duration_seconds': 0, 'sleep_score': 89, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 435505)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,438 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1750276813000, 'day': datetime.date(2025, 6, 19), 'sleep_start': datetime.datetime(2025, 6, 19, 0, 0, 13), 'sleep_end': datetime.datetime(2025, 6, 19, 9, 35, 5), 'sleep_duration_seconds': 32092, 'nap_duration_seconds': 0, 'sleep_score': 83, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 438135)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,440 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1750366937000, 'day': datetime.date(2025, 6, 20), 'sleep_start': datetime.datetime(2025, 6, 20, 1, 2, 17), 'sleep_end': datetime.datetime(2025, 6, 20, 6, 45, 17), 'sleep_duration_seconds': 17700, 'nap_duration_seconds': 0, 'sleep_score': 63, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 440268)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,443 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1750450438000, 'day': datetime.date(2025, 6, 21), 'sleep_start': datetime.datetime(2025, 6, 21, 0, 13, 58), 'sleep_end': datetime.datetime(2025, 6, 21, 9, 26, 58), 'sleep_duration_seconds': 30960, 'nap_duration_seconds': 0, 'sleep_score': 72, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 442848)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,443 - WARNING - No sleep ID found for 2025-06-22
2025-08-05 18:27:36,446 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1750624404000, 'day': datetime.date(2025, 6, 23), 'sleep_start': datetime.datetime(2025, 6, 23, 0, 33, 24), 'sleep_end': datetime.datetime(2025, 6, 23, 9, 38, 39), 'sleep_duration_seconds': 30195, 'nap_duration_seconds': 0, 'sleep_score': 77, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 445894)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,449 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1750712650000, 'day': datetime.date(2025, 6, 24), 'sleep_start': datetime.datetime(2025, 6, 24, 1, 4, 10), 'sleep_end': datetime.datetime(2025, 6, 24, 10, 30, 10), 'sleep_duration_seconds': 32340, 'nap_duration_seconds': 0, 'sleep_score': 85, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 448922)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,452 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1750803056000, 'day': datetime.date(2025, 6, 25), 'sleep_start': datetime.datetime(2025, 6, 25, 2, 10, 56), 'sleep_end': datetime.datetime(2025, 6, 25, 10, 9, 56), 'sleep_duration_seconds': 28500, 'nap_duration_seconds': 0, 'sleep_score': 90, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 451497)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,455 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1750884382000, 'day': datetime.date(2025, 6, 26), 'sleep_start': datetime.datetime(2025, 6, 26, 0, 46, 22), 'sleep_end': datetime.datetime(2025, 6, 26, 9, 42, 22), 'sleep_duration_seconds': 30600, 'nap_duration_seconds': 0, 'sleep_score': 85, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 454437)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,457 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1750983023000, 'day': datetime.date(2025, 6, 27), 'sleep_start': datetime.datetime(2025, 6, 27, 4, 10, 23), 'sleep_end': datetime.datetime(2025, 6, 27, 8, 42, 23), 'sleep_duration_seconds': 15900, 'nap_duration_seconds': 0, 'sleep_score': 56, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 456496)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,457 - WARNING - No sleep ID found for 2025-06-28
2025-08-05 18:27:36,457 - WARNING - No sleep ID found for 2025-06-29
2025-08-05 18:27:36,459 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1751246322000, 'day': datetime.date(2025, 6, 30), 'sleep_start': datetime.datetime(2025, 6, 30, 5, 18, 42), 'sleep_end': datetime.datetime(2025, 6, 30, 9, 1, 42), 'sleep_duration_seconds': 13380, 'nap_duration_seconds': 0, 'sleep_score': 49, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 458911)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,462 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1751318502000, 'day': datetime.date(2025, 7, 1), 'sleep_start': datetime.datetime(2025, 7, 1, 1, 21, 42), 'sleep_end': datetime.datetime(2025, 7, 1, 11, 46), 'sleep_duration_seconds': 37038, 'nap_duration_seconds': 0, 'sleep_score': 92, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 462082)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,465 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1751404059000, 'day': datetime.date(2025, 7, 2), 'sleep_start': datetime.datetime(2025, 7, 2, 1, 7, 39), 'sleep_end': datetime.datetime(2025, 7, 2, 11, 18, 39), 'sleep_duration_seconds': 36540, 'nap_duration_seconds': 0, 'sleep_score': 97, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 465126)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,467 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1751493270000, 'day': datetime.date(2025, 7, 3), 'sleep_start': datetime.datetime(2025, 7, 3, 1, 54, 30), 'sleep_end': datetime.datetime(2025, 7, 3, 4, 54, 30), 'sleep_duration_seconds': 10800, 'nap_duration_seconds': 0, 'sleep_score': 40, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 467122)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,470 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1751573120000, 'day': datetime.date(2025, 7, 4), 'sleep_start': datetime.datetime(2025, 7, 4, 0, 5, 20), 'sleep_end': datetime.datetime(2025, 7, 4, 10, 38, 20), 'sleep_duration_seconds': 37140, 'nap_duration_seconds': 0, 'sleep_score': 90, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 470126)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,473 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1751679987000, 'day': datetime.date(2025, 7, 5), 'sleep_start': datetime.datetime(2025, 7, 5, 5, 46, 27), 'sleep_end': datetime.datetime(2025, 7, 5, 11, 5, 27), 'sleep_duration_seconds': 18480, 'nap_duration_seconds': 4560, 'sleep_score': 50, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 472762)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,475 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1751754972000, 'day': datetime.date(2025, 7, 6), 'sleep_start': datetime.datetime(2025, 7, 6, 2, 36, 12), 'sleep_end': datetime.datetime(2025, 7, 6, 10, 11, 12), 'sleep_duration_seconds': 27060, 'nap_duration_seconds': 0, 'sleep_score': 88, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 475274)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,478 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1751833584000, 'day': datetime.date(2025, 7, 7), 'sleep_start': datetime.datetime(2025, 7, 7, 0, 26, 24), 'sleep_end': datetime.datetime(2025, 7, 7, 9, 0, 18), 'sleep_duration_seconds': 30234, 'nap_duration_seconds': 0, 'sleep_score': 96, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 478037)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,490 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1751922151000, 'day': datetime.date(2025, 7, 8), 'sleep_start': datetime.datetime(2025, 7, 8, 1, 2, 31), 'sleep_end': datetime.datetime(2025, 7, 8, 8, 32, 7), 'sleep_duration_seconds': 26976, 'nap_duration_seconds': 0, 'sleep_score': 90, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 489557)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,493 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1752008673000, 'day': datetime.date(2025, 7, 9), 'sleep_start': datetime.datetime(2025, 7, 9, 1, 4, 33), 'sleep_end': datetime.datetime(2025, 7, 9, 9, 18, 33), 'sleep_duration_seconds': 28080, 'nap_duration_seconds': 0, 'sleep_score': 80, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 492817)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,496 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1752092668000, 'day': datetime.date(2025, 7, 10), 'sleep_start': datetime.datetime(2025, 7, 10, 0, 24, 28), 'sleep_end': datetime.datetime(2025, 7, 10, 8, 22, 27), 'sleep_duration_seconds': 28079, 'nap_duration_seconds': 0, 'sleep_score': 95, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 495732)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,498 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1752182343000, 'day': datetime.date(2025, 7, 11), 'sleep_start': datetime.datetime(2025, 7, 11, 1, 19, 3), 'sleep_end': datetime.datetime(2025, 7, 11, 9, 40, 3), 'sleep_duration_seconds': 29580, 'nap_duration_seconds': 0, 'sleep_score': 96, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 498349)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,501 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1752273639000, 'day': datetime.date(2025, 7, 12), 'sleep_start': datetime.datetime(2025, 7, 12, 2, 40, 39), 'sleep_end': datetime.datetime(2025, 7, 12, 10, 59, 39), 'sleep_duration_seconds': 24960, 'nap_duration_seconds': 0, 'sleep_score': 61, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 500584)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,501 - WARNING - No sleep ID found for 2025-07-13
2025-08-05 18:27:36,503 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1752441300000, 'day': datetime.date(2025, 7, 14), 'sleep_start': datetime.datetime(2025, 7, 14, 1, 15), 'sleep_end': datetime.datetime(2025, 7, 14, 10, 40), 'sleep_duration_seconds': 32280, 'nap_duration_seconds': 0, 'sleep_score': 61, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 503328)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,506 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1752529731000, 'day': datetime.date(2025, 7, 15), 'sleep_start': datetime.datetime(2025, 7, 15, 1, 48, 51), 'sleep_end': datetime.datetime(2025, 7, 15, 9, 58, 51), 'sleep_duration_seconds': 27120, 'nap_duration_seconds': 0, 'sleep_score': 91, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 505879)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,508 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1752617408000, 'day': datetime.date(2025, 7, 16), 'sleep_start': datetime.datetime(2025, 7, 16, 2, 10, 8), 'sleep_end': datetime.datetime(2025, 7, 16, 10, 1, 8), 'sleep_duration_seconds': 27300, 'nap_duration_seconds': 0, 'sleep_score': 89, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 508196)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,510 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1752698817000, 'day': datetime.date(2025, 7, 17), 'sleep_start': datetime.datetime(2025, 7, 17, 0, 46, 57), 'sleep_end': datetime.datetime(2025, 7, 17, 9, 53, 10), 'sleep_duration_seconds': 32233, 'nap_duration_seconds': 0, 'sleep_score': 99, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 510425)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,513 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1752786480000, 'day': datetime.date(2025, 7, 18), 'sleep_start': datetime.datetime(2025, 7, 18, 1, 8), 'sleep_end': datetime.datetime(2025, 7, 18, 9, 13, 58), 'sleep_duration_seconds': 28378, 'nap_duration_seconds': 0, 'sleep_score': 94, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 512932)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,515 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1752877518000, 'day': datetime.date(2025, 7, 19), 'sleep_start': datetime.datetime(2025, 7, 19, 2, 25, 18), 'sleep_end': datetime.datetime(2025, 7, 19, 9, 43, 18), 'sleep_duration_seconds': 24960, 'nap_duration_seconds': 0, 'sleep_score': 79, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 515277)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,518 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1752962019000, 'day': datetime.date(2025, 7, 20), 'sleep_start': datetime.datetime(2025, 7, 20, 1, 53, 39), 'sleep_end': datetime.datetime(2025, 7, 20, 8, 51, 39), 'sleep_duration_seconds': 24840, 'nap_duration_seconds': 0, 'sleep_score': 85, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 517516)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,520 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1753044933000, 'day': datetime.date(2025, 7, 21), 'sleep_start': datetime.datetime(2025, 7, 21, 0, 55, 33), 'sleep_end': datetime.datetime(2025, 7, 21, 9, 30, 31), 'sleep_duration_seconds': 28378, 'nap_duration_seconds': 0, 'sleep_score': 90, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 519926)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,522 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1753134216000, 'day': datetime.date(2025, 7, 22), 'sleep_start': datetime.datetime(2025, 7, 22, 1, 43, 36), 'sleep_end': datetime.datetime(2025, 7, 22, 9, 2, 18), 'sleep_duration_seconds': 25902, 'nap_duration_seconds': 0, 'sleep_score': 83, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 522443)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,525 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1753218356000, 'day': datetime.date(2025, 7, 23), 'sleep_start': datetime.datetime(2025, 7, 23, 1, 5, 56), 'sleep_end': datetime.datetime(2025, 7, 23, 9, 26, 56), 'sleep_duration_seconds': 28380, 'nap_duration_seconds': 0, 'sleep_score': 87, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 524585)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,527 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1753305962000, 'day': datetime.date(2025, 7, 24), 'sleep_start': datetime.datetime(2025, 7, 24, 1, 26, 2), 'sleep_end': datetime.datetime(2025, 7, 24, 9, 0, 2), 'sleep_duration_seconds': 26700, 'nap_duration_seconds': 0, 'sleep_score': 89, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 526690)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,530 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1753387447000, 'day': datetime.date(2025, 7, 25), 'sleep_start': datetime.datetime(2025, 7, 25, 0, 4, 7), 'sleep_end': datetime.datetime(2025, 7, 25, 9, 35, 7), 'sleep_duration_seconds': 33300, 'nap_duration_seconds': 0, 'sleep_score': 89, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 529508)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,532 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1753491417000, 'day': datetime.date(2025, 7, 26), 'sleep_start': datetime.datetime(2025, 7, 26, 4, 56, 57), 'sleep_end': datetime.datetime(2025, 7, 26, 11, 33, 57), 'sleep_duration_seconds': 23820, 'nap_duration_seconds': 0, 'sleep_score': 82, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 531556)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,534 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1753576283000, 'day': datetime.date(2025, 7, 27), 'sleep_start': datetime.datetime(2025, 7, 27, 4, 31, 23), 'sleep_end': datetime.datetime(2025, 7, 27, 11, 34, 15), 'sleep_duration_seconds': 25252, 'nap_duration_seconds': 0, 'sleep_score': 84, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 533512)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,536 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1753654408000, 'day': datetime.date(2025, 7, 28), 'sleep_start': datetime.datetime(2025, 7, 28, 2, 13, 28), 'sleep_end': datetime.datetime(2025, 7, 28, 11, 4, 28), 'sleep_duration_seconds': 30000, 'nap_duration_seconds': 0, 'sleep_score': 98, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 535765)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,538 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1753738619000, 'day': datetime.date(2025, 7, 29), 'sleep_start': datetime.datetime(2025, 7, 29, 1, 36, 59), 'sleep_end': datetime.datetime(2025, 7, 29, 8, 42, 40), 'sleep_duration_seconds': 23921, 'nap_duration_seconds': 0, 'sleep_score': 76, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 537761)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,541 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1753824233000, 'day': datetime.date(2025, 7, 30), 'sleep_start': datetime.datetime(2025, 7, 30, 1, 23, 53), 'sleep_end': datetime.datetime(2025, 7, 30, 9, 11, 14), 'sleep_duration_seconds': 24621, 'nap_duration_seconds': 0, 'sleep_score': 75, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 540495)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,543 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-31.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1753913996000, 'day': datetime.date(2025, 7, 31), 'sleep_start': datetime.datetime(2025, 7, 31, 2, 19, 56), 'sleep_end': datetime.datetime(2025, 7, 31, 10, 30, 56), 'sleep_duration_seconds': 29460, 'nap_duration_seconds': 0, 'sleep_score': 90, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 542923)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,545 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-08-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1753997429000, 'day': datetime.date(2025, 8, 1), 'sleep_start': datetime.datetime(2025, 8, 1, 1, 30, 29), 'sleep_end': datetime.datetime(2025, 8, 1, 5, 31, 29), 'sleep_duration_seconds': 14400, 'nap_duration_seconds': 0, 'sleep_score': 53, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 544774)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,547 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-08-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1754096942000, 'day': datetime.date(2025, 8, 2), 'sleep_start': datetime.datetime(2025, 8, 2, 5, 9, 2), 'sleep_end': datetime.datetime(2025, 8, 2, 10, 29, 2), 'sleep_duration_seconds': 19200, 'nap_duration_seconds': 7080, 'sleep_score': 61, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 546780)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,549 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-08-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1754176833000, 'day': datetime.date(2025, 8, 3), 'sleep_start': datetime.datetime(2025, 8, 3, 3, 20, 33), 'sleep_end': datetime.datetime(2025, 8, 3, 9, 54, 9), 'sleep_duration_seconds': 20616, 'nap_duration_seconds': 0, 'sleep_score': 61, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 548985)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,551 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-08-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, nap_duration_seconds, sleep_score, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score]
[parameters: {'sleep_id': 1754254377000, 'day': datetime.date(2025, 8, 4), 'sleep_start': datetime.datetime(2025, 8, 4, 0, 52, 57), 'sleep_end': datetime.datetime(2025, 8, 4, 8, 56, 57), 'sleep_duration_seconds': 26340, 'nap_duration_seconds': 2460, 'sleep_score': 70, 'created_at': datetime.datetime(2025, 8, 5, 16, 27, 36, 551101)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 18:27:36,552 - INFO - Migrated 0 sleep records (267 errors)
2025-08-05 18:27:36,673 - INFO - Migrated 98 weight records
2025-08-05 18:27:36,915 - INFO - Created 277 new journal entries
2025-08-05 18:27:36,915 - INFO - Migration completed successfully!
2025-08-05 18:28:34,882 - INFO - Database tables created/verified
2025-08-05 18:28:34,903 - WARNING - No sleep ID found for 2024-11-10
2025-08-05 18:28:35,024 - WARNING - No sleep ID found for 2025-02-24
2025-08-05 18:28:35,049 - WARNING - No sleep ID found for 2025-03-13
2025-08-05 18:28:35,053 - WARNING - No sleep ID found for 2025-03-16
2025-08-05 18:28:35,087 - WARNING - No sleep ID found for 2025-04-04
2025-08-05 18:28:35,175 - WARNING - No sleep ID found for 2025-05-18
2025-08-05 18:28:35,256 - WARNING - No sleep ID found for 2025-06-22
2025-08-05 18:28:35,267 - WARNING - No sleep ID found for 2025-06-28
2025-08-05 18:28:35,267 - WARNING - No sleep ID found for 2025-06-29
2025-08-05 18:28:35,298 - WARNING - No sleep ID found for 2025-07-13
2025-08-05 18:28:35,352 - INFO - Migrated 267 sleep records (0 errors)
2025-08-05 18:28:56,588 - INFO - Database tables created/verified
2025-08-05 18:30:27,285 - INFO - Database tables created/verified
2025-08-05 18:30:27,306 - WARNING - No sleep ID found for 2024-11-10
2025-08-05 18:30:27,427 - WARNING - No sleep ID found for 2025-02-24
2025-08-05 18:30:27,451 - WARNING - No sleep ID found for 2025-03-13
2025-08-05 18:30:27,455 - WARNING - No sleep ID found for 2025-03-16
2025-08-05 18:30:27,486 - WARNING - No sleep ID found for 2025-04-04
2025-08-05 18:30:27,569 - WARNING - No sleep ID found for 2025-05-18
2025-08-05 18:30:27,641 - WARNING - No sleep ID found for 2025-06-22
2025-08-05 18:30:27,652 - WARNING - No sleep ID found for 2025-06-28
2025-08-05 18:30:27,652 - WARNING - No sleep ID found for 2025-06-29
2025-08-05 18:30:27,679 - WARNING - No sleep ID found for 2025-07-13
2025-08-05 18:30:27,729 - INFO - Migrated 267 sleep records (0 errors)
2025-08-05 18:30:37,508 - INFO - Database tables created/verified
2025-08-05 18:30:37,508 - INFO - Starting enhanced Garmin data migration...
2025-08-05 18:30:37,794 - INFO - Migrated 277 RHR records (0 errors)
2025-08-05 18:30:37,805 - WARNING - No sleep ID found for 2024-11-10
2025-08-05 18:30:37,913 - WARNING - No sleep ID found for 2025-02-24
2025-08-05 18:30:37,937 - WARNING - No sleep ID found for 2025-03-13
2025-08-05 18:30:37,940 - WARNING - No sleep ID found for 2025-03-16
2025-08-05 18:30:37,971 - WARNING - No sleep ID found for 2025-04-04
2025-08-05 18:30:38,046 - WARNING - No sleep ID found for 2025-05-18
2025-08-05 18:30:38,117 - WARNING - No sleep ID found for 2025-06-22
2025-08-05 18:30:38,128 - WARNING - No sleep ID found for 2025-06-28
2025-08-05 18:30:38,128 - WARNING - No sleep ID found for 2025-06-29
2025-08-05 18:30:38,153 - WARNING - No sleep ID found for 2025-07-13
2025-08-05 18:30:38,206 - INFO - Migrated 267 sleep records (0 errors)
2025-08-05 18:30:38,317 - INFO - Migrated 98 weight records
2025-08-05 18:30:38,489 - INFO - Created 0 new journal entries
2025-08-05 18:30:38,489 - INFO - Migration completed successfully!
2025-08-05 19:48:48,488 - INFO - Database tables created/verified
2025-08-05 19:48:48,488 - INFO - Starting enhanced Garmin data migration...
2025-08-05 19:48:48,781 - INFO - Migrated 277 RHR records (0 errors)
2025-08-05 19:48:48,785 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-01.json: (psycopg2.errors.UndefinedColumn) column "avg_sleep_stress" of relation "garmin_sleep_sessions" does not exist
LINE 1: ...awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_...
                                                             ^

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1730419180000, 'day': datetime.date(2024, 11, 1), 'sleep_start': datetime.datetime(2024, 11, 1, 1, 59, 40), 'sleep_end': datetime.datetime(2024, 11, 1, 8, 8, 40), 'sleep_duration_seconds': 21120, 'deep_sleep_seconds': 6420, 'light_sleep_seconds': 11640, 'rem_sleep_seconds': 3060, 'awake_seconds': 1020, 'nap_duration_seconds': 0, 'sleep_score': 69, 'avg_sleep_stress': 20.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 14.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 783535)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-05 19:48:48,788 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1730497155000, 'day': datetime.date(2024, 11, 2), 'sleep_start': datetime.datetime(2024, 11, 1, 23, 39, 15), 'sleep_end': datetime.datetime(2024, 11, 2, 9, 17, 3), 'sleep_duration_seconds': 29508, 'deep_sleep_seconds': 4680, 'light_sleep_seconds': 22140, 'rem_sleep_seconds': 2700, 'awake_seconds': 5160, 'nap_duration_seconds': 0, 'sleep_score': 52, 'avg_sleep_stress': 21.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 8, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 786537)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,789 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1730581786000, 'day': datetime.date(2024, 11, 3), 'sleep_start': datetime.datetime(2024, 11, 2, 23, 9, 46), 'sleep_end': datetime.datetime(2024, 11, 3, 8, 16, 46), 'sleep_duration_seconds': 29880, 'deep_sleep_seconds': 5160, 'light_sleep_seconds': 22560, 'rem_sleep_seconds': 2160, 'awake_seconds': 2040, 'nap_duration_seconds': 0, 'sleep_score': 75, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 789550)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,792 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1730670757000, 'day': datetime.date(2024, 11, 4), 'sleep_start': datetime.datetime(2024, 11, 3, 23, 52, 37), 'sleep_end': datetime.datetime(2024, 11, 4, 7, 32, 37), 'sleep_duration_seconds': 26040, 'deep_sleep_seconds': 7440, 'light_sleep_seconds': 14580, 'rem_sleep_seconds': 4020, 'awake_seconds': 1560, 'nap_duration_seconds': 2100, 'sleep_score': 79, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 791060)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,793 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1730762636000, 'day': datetime.date(2024, 11, 5), 'sleep_start': datetime.datetime(2024, 11, 5, 1, 23, 56), 'sleep_end': datetime.datetime(2024, 11, 5, 7, 44, 46), 'sleep_duration_seconds': 21590, 'deep_sleep_seconds': 5460, 'light_sleep_seconds': 13200, 'rem_sleep_seconds': 2940, 'awake_seconds': 1260, 'nap_duration_seconds': 0, 'sleep_score': 73, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 793132)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,793 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1730849001000, 'day': datetime.date(2024, 11, 6), 'sleep_start': datetime.datetime(2024, 11, 6, 1, 23, 21), 'sleep_end': datetime.datetime(2024, 11, 6, 8, 9, 21), 'sleep_duration_seconds': 20640, 'deep_sleep_seconds': 6420, 'light_sleep_seconds': 11220, 'rem_sleep_seconds': 3000, 'awake_seconds': 3720, 'nap_duration_seconds': 0, 'sleep_score': 65, 'avg_sleep_stress': 19.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 14.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 793132)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,793 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1730936932000, 'day': datetime.date(2024, 11, 7), 'sleep_start': datetime.datetime(2024, 11, 7, 1, 48, 52), 'sleep_end': datetime.datetime(2024, 11, 7, 8, 10, 52), 'sleep_duration_seconds': 21780, 'deep_sleep_seconds': 7260, 'light_sleep_seconds': 10620, 'rem_sleep_seconds': 3900, 'awake_seconds': 1140, 'nap_duration_seconds': 0, 'sleep_score': 74, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 793132)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,798 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731075527464, 'day': datetime.date(2024, 11, 8), 'sleep_start': datetime.datetime(2024, 11, 8, 16, 18, 47, 464000), 'sleep_end': datetime.datetime(2024, 11, 8, 22, 8, 47, 464000), 'sleep_duration_seconds': 21000, 'deep_sleep_seconds': None, 'light_sleep_seconds': None, 'rem_sleep_seconds': None, 'awake_seconds': None, 'nap_duration_seconds': 1260, 'sleep_score': None, 'avg_sleep_stress': None, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': None, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 798210)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,799 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731113685000, 'day': datetime.date(2024, 11, 9), 'sleep_start': datetime.datetime(2024, 11, 9, 2, 54, 45), 'sleep_end': datetime.datetime(2024, 11, 9, 8, 20, 45), 'sleep_duration_seconds': 17160, 'deep_sleep_seconds': 4500, 'light_sleep_seconds': 10740, 'rem_sleep_seconds': 1920, 'awake_seconds': 2400, 'nap_duration_seconds': 0, 'sleep_score': 57, 'avg_sleep_stress': 21.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 799565)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,799 - WARNING - No sleep ID found for 2024-11-10
2025-08-05 19:48:48,801 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731280736000, 'day': datetime.date(2024, 11, 11), 'sleep_start': datetime.datetime(2024, 11, 11, 1, 18, 56), 'sleep_end': datetime.datetime(2024, 11, 11, 4, 46, 56), 'sleep_duration_seconds': 8520, 'deep_sleep_seconds': 3060, 'light_sleep_seconds': 4620, 'rem_sleep_seconds': 840, 'awake_seconds': 3960, 'nap_duration_seconds': 0, 'sleep_score': 30, 'avg_sleep_stress': 23.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 14.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 801574)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,801 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731356883000, 'day': datetime.date(2024, 11, 12), 'sleep_start': datetime.datetime(2024, 11, 11, 22, 28, 3), 'sleep_end': datetime.datetime(2024, 11, 12, 8, 31, 57), 'sleep_duration_seconds': 32394, 'deep_sleep_seconds': 5820, 'light_sleep_seconds': 18900, 'rem_sleep_seconds': 7680, 'awake_seconds': 3840, 'nap_duration_seconds': 1560, 'sleep_score': 77, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 801574)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,801 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731452090000, 'day': datetime.date(2024, 11, 13), 'sleep_start': datetime.datetime(2024, 11, 13, 0, 54, 50), 'sleep_end': datetime.datetime(2024, 11, 13, 9, 25, 50), 'sleep_duration_seconds': 29820, 'deep_sleep_seconds': 4140, 'light_sleep_seconds': 20580, 'rem_sleep_seconds': 5100, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 801574)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,801 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731547447000, 'day': datetime.date(2024, 11, 14), 'sleep_start': datetime.datetime(2024, 11, 14, 3, 24, 7), 'sleep_end': datetime.datetime(2024, 11, 14, 8, 40, 54), 'sleep_duration_seconds': 18947, 'deep_sleep_seconds': 2580, 'light_sleep_seconds': 11160, 'rem_sleep_seconds': 5220, 'awake_seconds': 60, 'nap_duration_seconds': 2820, 'sleep_score': 68, 'avg_sleep_stress': 5.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 17.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 801574)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,808 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731643703000, 'day': datetime.date(2024, 11, 15), 'sleep_start': datetime.datetime(2024, 11, 15, 6, 8, 23), 'sleep_end': datetime.datetime(2024, 11, 15, 12, 13, 23), 'sleep_duration_seconds': 21780, 'deep_sleep_seconds': 5520, 'light_sleep_seconds': 15900, 'rem_sleep_seconds': 360, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 50, 'avg_sleep_stress': 37.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 801574)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,810 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731731213000, 'day': datetime.date(2024, 11, 16), 'sleep_start': datetime.datetime(2024, 11, 16, 6, 26, 53), 'sleep_end': datetime.datetime(2024, 11, 16, 12, 32, 53), 'sleep_duration_seconds': 20220, 'deep_sleep_seconds': 3780, 'light_sleep_seconds': 13860, 'rem_sleep_seconds': 2580, 'awake_seconds': 960, 'nap_duration_seconds': 0, 'sleep_score': 68, 'avg_sleep_stress': 19.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 809973)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,811 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731798536000, 'day': datetime.date(2024, 11, 17), 'sleep_start': datetime.datetime(2024, 11, 17, 1, 8, 56), 'sleep_end': datetime.datetime(2024, 11, 17, 8, 50, 56), 'sleep_duration_seconds': 27660, 'deep_sleep_seconds': 11700, 'light_sleep_seconds': 8340, 'rem_sleep_seconds': 7620, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 19.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 811972)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,814 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731890937000, 'day': datetime.date(2024, 11, 18), 'sleep_start': datetime.datetime(2024, 11, 18, 2, 48, 57), 'sleep_end': datetime.datetime(2024, 11, 18, 9, 4, 57), 'sleep_duration_seconds': 22260, 'deep_sleep_seconds': 9000, 'light_sleep_seconds': 8580, 'rem_sleep_seconds': 4680, 'awake_seconds': 300, 'nap_duration_seconds': 0, 'sleep_score': 73, 'avg_sleep_stress': 22.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 16.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 813450)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,815 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731976584000, 'day': datetime.date(2024, 11, 19), 'sleep_start': datetime.datetime(2024, 11, 19, 2, 36, 24), 'sleep_end': datetime.datetime(2024, 11, 19, 10, 30, 24), 'sleep_duration_seconds': 26940, 'deep_sleep_seconds': 7740, 'light_sleep_seconds': 11940, 'rem_sleep_seconds': 7260, 'awake_seconds': 1500, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 20.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 815451)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,816 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732060956000, 'day': datetime.date(2024, 11, 20), 'sleep_start': datetime.datetime(2024, 11, 20, 2, 2, 36), 'sleep_end': datetime.datetime(2024, 11, 20, 9, 7, 36), 'sleep_duration_seconds': 25080, 'deep_sleep_seconds': 5700, 'light_sleep_seconds': 15000, 'rem_sleep_seconds': 4380, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 19.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 816519)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,819 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732146689000, 'day': datetime.date(2024, 11, 21), 'sleep_start': datetime.datetime(2024, 11, 21, 1, 51, 29), 'sleep_end': datetime.datetime(2024, 11, 21, 9, 14, 29), 'sleep_duration_seconds': 24900, 'deep_sleep_seconds': 3540, 'light_sleep_seconds': 17040, 'rem_sleep_seconds': 4320, 'awake_seconds': 1680, 'nap_duration_seconds': 0, 'sleep_score': 76, 'avg_sleep_stress': 17.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 818023)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,821 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732243351000, 'day': datetime.date(2024, 11, 22), 'sleep_start': datetime.datetime(2024, 11, 22, 4, 42, 31), 'sleep_end': datetime.datetime(2024, 11, 22, 7, 43, 31), 'sleep_duration_seconds': 10320, 'deep_sleep_seconds': 3540, 'light_sleep_seconds': 6000, 'rem_sleep_seconds': 780, 'awake_seconds': 540, 'nap_duration_seconds': 0, 'sleep_score': None, 'avg_sleep_stress': 20.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 15.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 820446)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,822 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732311339000, 'day': datetime.date(2024, 11, 23), 'sleep_start': datetime.datetime(2024, 11, 22, 23, 35, 39), 'sleep_end': datetime.datetime(2024, 11, 23, 7, 48, 39), 'sleep_duration_seconds': 28920, 'deep_sleep_seconds': 6540, 'light_sleep_seconds': 18000, 'rem_sleep_seconds': 4380, 'awake_seconds': 660, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 822446)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,824 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732410834000, 'day': datetime.date(2024, 11, 24), 'sleep_start': datetime.datetime(2024, 11, 24, 3, 13, 54), 'sleep_end': datetime.datetime(2024, 11, 24, 10, 45, 54), 'sleep_duration_seconds': 26100, 'deep_sleep_seconds': 8220, 'light_sleep_seconds': 12240, 'rem_sleep_seconds': 5640, 'awake_seconds': 1020, 'nap_duration_seconds': 0, 'sleep_score': 80, 'avg_sleep_stress': 18.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 824507)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,827 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732491772000, 'day': datetime.date(2024, 11, 25), 'sleep_start': datetime.datetime(2024, 11, 25, 1, 42, 52), 'sleep_end': datetime.datetime(2024, 11, 25, 9, 11, 52), 'sleep_duration_seconds': 26940, 'deep_sleep_seconds': 7980, 'light_sleep_seconds': 12600, 'rem_sleep_seconds': 6360, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 92, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 826018)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,828 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732574165000, 'day': datetime.date(2024, 11, 26), 'sleep_start': datetime.datetime(2024, 11, 26, 0, 36, 5), 'sleep_end': datetime.datetime(2024, 11, 26, 8, 46, 5), 'sleep_duration_seconds': 27000, 'deep_sleep_seconds': 3840, 'light_sleep_seconds': 14880, 'rem_sleep_seconds': 8280, 'awake_seconds': 2400, 'nap_duration_seconds': 1860, 'sleep_score': 77, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 21.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 828195)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,830 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732666440000, 'day': datetime.date(2024, 11, 27), 'sleep_start': datetime.datetime(2024, 11, 27, 2, 14), 'sleep_end': datetime.datetime(2024, 11, 27, 8, 27), 'sleep_duration_seconds': 22140, 'deep_sleep_seconds': 7140, 'light_sleep_seconds': 10920, 'rem_sleep_seconds': 4080, 'awake_seconds': 240, 'nap_duration_seconds': 0, 'sleep_score': 76, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 829202)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,831 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732751501000, 'day': datetime.date(2024, 11, 28), 'sleep_start': datetime.datetime(2024, 11, 28, 1, 51, 41), 'sleep_end': datetime.datetime(2024, 11, 28, 9, 14, 41), 'sleep_duration_seconds': 24360, 'deep_sleep_seconds': 4980, 'light_sleep_seconds': 15300, 'rem_sleep_seconds': 4080, 'awake_seconds': 2220, 'nap_duration_seconds': 0, 'sleep_score': 80, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 16.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 830238)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,832 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732836786000, 'day': datetime.date(2024, 11, 29), 'sleep_start': datetime.datetime(2024, 11, 29, 1, 33, 6), 'sleep_end': datetime.datetime(2024, 11, 29, 8, 30, 6), 'sleep_duration_seconds': 24900, 'deep_sleep_seconds': 5580, 'light_sleep_seconds': 11100, 'rem_sleep_seconds': 8220, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 832475)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,834 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732938498000, 'day': datetime.date(2024, 11, 30), 'sleep_start': datetime.datetime(2024, 11, 30, 5, 48, 18), 'sleep_end': datetime.datetime(2024, 11, 30, 11, 9, 18), 'sleep_duration_seconds': 17940, 'deep_sleep_seconds': 7620, 'light_sleep_seconds': 7860, 'rem_sleep_seconds': 2460, 'awake_seconds': 1320, 'nap_duration_seconds': 0, 'sleep_score': 64, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 834496)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,836 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733006727000, 'day': datetime.date(2024, 12, 1), 'sleep_start': datetime.datetime(2024, 12, 1, 0, 45, 27), 'sleep_end': datetime.datetime(2024, 12, 1, 9, 25, 27), 'sleep_duration_seconds': 30360, 'deep_sleep_seconds': 12780, 'light_sleep_seconds': 14340, 'rem_sleep_seconds': 3240, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 835502)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,838 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733095877000, 'day': datetime.date(2024, 12, 2), 'sleep_start': datetime.datetime(2024, 12, 2, 1, 31, 17), 'sleep_end': datetime.datetime(2024, 12, 2, 8, 30, 14), 'sleep_duration_seconds': 24297, 'deep_sleep_seconds': 7980, 'light_sleep_seconds': 12540, 'rem_sleep_seconds': 3780, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 76, 'avg_sleep_stress': 20.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 837502)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,839 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733180955000, 'day': datetime.date(2024, 12, 3), 'sleep_start': datetime.datetime(2024, 12, 3, 1, 9, 15), 'sleep_end': datetime.datetime(2024, 12, 3, 8, 45, 15), 'sleep_duration_seconds': 23820, 'deep_sleep_seconds': 6960, 'light_sleep_seconds': 13140, 'rem_sleep_seconds': 3720, 'awake_seconds': 3540, 'nap_duration_seconds': 0, 'sleep_score': 74, 'avg_sleep_stress': 11.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 839320)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,841 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733266707000, 'day': datetime.date(2024, 12, 4), 'sleep_start': datetime.datetime(2024, 12, 4, 0, 58, 27), 'sleep_end': datetime.datetime(2024, 12, 4, 8, 18, 27), 'sleep_duration_seconds': 24720, 'deep_sleep_seconds': 7620, 'light_sleep_seconds': 11760, 'rem_sleep_seconds': 5340, 'awake_seconds': 1680, 'nap_duration_seconds': 0, 'sleep_score': 80, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 840875)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,843 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733364903000, 'day': datetime.date(2024, 12, 5), 'sleep_start': datetime.datetime(2024, 12, 5, 4, 15, 3), 'sleep_end': datetime.datetime(2024, 12, 5, 9, 30, 3), 'sleep_duration_seconds': 18720, 'deep_sleep_seconds': 2760, 'light_sleep_seconds': 11160, 'rem_sleep_seconds': 3660, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 66, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 842948)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,845 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733454000000, 'day': datetime.date(2024, 12, 6), 'sleep_start': datetime.datetime(2024, 12, 6, 5, 0), 'sleep_end': datetime.datetime(2024, 12, 6, 12, 0), 'sleep_duration_seconds': 25200, 'deep_sleep_seconds': None, 'light_sleep_seconds': None, 'rem_sleep_seconds': None, 'awake_seconds': None, 'nap_duration_seconds': 0, 'sleep_score': None, 'avg_sleep_stress': None, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': None, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 843987)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,846 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733523338000, 'day': datetime.date(2024, 12, 7), 'sleep_start': datetime.datetime(2024, 12, 7, 0, 15, 38), 'sleep_end': datetime.datetime(2024, 12, 7, 6, 31, 32), 'sleep_duration_seconds': 22074, 'deep_sleep_seconds': 6480, 'light_sleep_seconds': 10980, 'rem_sleep_seconds': 4620, 'awake_seconds': 480, 'nap_duration_seconds': 3120, 'sleep_score': 78, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 846550)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,848 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733616991000, 'day': datetime.date(2024, 12, 8), 'sleep_start': datetime.datetime(2024, 12, 8, 2, 16, 31), 'sleep_end': datetime.datetime(2024, 12, 8, 10, 6, 31), 'sleep_duration_seconds': 25260, 'deep_sleep_seconds': 2880, 'light_sleep_seconds': 14460, 'rem_sleep_seconds': 7920, 'awake_seconds': 1860, 'nap_duration_seconds': 0, 'sleep_score': 76, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 17.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 440, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 848061)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,850 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733699294000, 'day': datetime.date(2024, 12, 9), 'sleep_start': datetime.datetime(2024, 12, 9, 1, 8, 14), 'sleep_end': datetime.datetime(2024, 12, 9, 9, 9, 14), 'sleep_duration_seconds': 28380, 'deep_sleep_seconds': 6660, 'light_sleep_seconds': 16560, 'rem_sleep_seconds': 5160, 'awake_seconds': 480, 'nap_duration_seconds': 0, 'sleep_score': 93, 'avg_sleep_stress': 7.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 849067)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,851 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733789808000, 'day': datetime.date(2024, 12, 10), 'sleep_start': datetime.datetime(2024, 12, 10, 2, 16, 48), 'sleep_end': datetime.datetime(2024, 12, 10, 9, 48, 48), 'sleep_duration_seconds': 21840, 'deep_sleep_seconds': 5940, 'light_sleep_seconds': 13260, 'rem_sleep_seconds': 2640, 'awake_seconds': 5280, 'nap_duration_seconds': 0, 'sleep_score': 63, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 14.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 851099)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,853 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733876067000, 'day': datetime.date(2024, 12, 11), 'sleep_start': datetime.datetime(2024, 12, 11, 2, 14, 27), 'sleep_end': datetime.datetime(2024, 12, 11, 8, 58, 23), 'sleep_duration_seconds': 21416, 'deep_sleep_seconds': 3840, 'light_sleep_seconds': 14640, 'rem_sleep_seconds': 2940, 'awake_seconds': 2820, 'nap_duration_seconds': 0, 'sleep_score': 62, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 18.0, 'awake_count': 4, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 852098)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,854 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733966368000, 'day': datetime.date(2024, 12, 12), 'sleep_start': datetime.datetime(2024, 12, 12, 3, 19, 28), 'sleep_end': datetime.datetime(2024, 12, 12, 9, 21, 28), 'sleep_duration_seconds': 20280, 'deep_sleep_seconds': 5520, 'light_sleep_seconds': 12360, 'rem_sleep_seconds': 2400, 'awake_seconds': 1440, 'nap_duration_seconds': 4200, 'sleep_score': 67, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 854202)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,855 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734062732000, 'day': datetime.date(2024, 12, 13), 'sleep_start': datetime.datetime(2024, 12, 13, 6, 5, 32), 'sleep_end': datetime.datetime(2024, 12, 13, 11, 21, 32), 'sleep_duration_seconds': 17700, 'deep_sleep_seconds': 5400, 'light_sleep_seconds': 11340, 'rem_sleep_seconds': 960, 'awake_seconds': 1260, 'nap_duration_seconds': 7920, 'sleep_score': 56, 'avg_sleep_stress': 20.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 16.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 855766)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,858 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734145184000, 'day': datetime.date(2024, 12, 14), 'sleep_start': datetime.datetime(2024, 12, 14, 4, 59, 44), 'sleep_end': datetime.datetime(2024, 12, 14, 12, 8, 43), 'sleep_duration_seconds': 24059, 'deep_sleep_seconds': 8880, 'light_sleep_seconds': 9120, 'rem_sleep_seconds': 6060, 'awake_seconds': 1680, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 856771)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,860 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734223783000, 'day': datetime.date(2024, 12, 15), 'sleep_start': datetime.datetime(2024, 12, 15, 2, 49, 43), 'sleep_end': datetime.datetime(2024, 12, 15, 10, 37, 38), 'sleep_duration_seconds': 26155, 'deep_sleep_seconds': 5160, 'light_sleep_seconds': 16860, 'rem_sleep_seconds': 4140, 'awake_seconds': 1020, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 859282)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,861 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734302240000, 'day': datetime.date(2024, 12, 16), 'sleep_start': datetime.datetime(2024, 12, 16, 0, 37, 20), 'sleep_end': datetime.datetime(2024, 12, 16, 8, 22, 20), 'sleep_duration_seconds': 27060, 'deep_sleep_seconds': 5160, 'light_sleep_seconds': 19020, 'rem_sleep_seconds': 2880, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 861079)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,863 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734388679000, 'day': datetime.date(2024, 12, 17), 'sleep_start': datetime.datetime(2024, 12, 17, 0, 37, 59), 'sleep_end': datetime.datetime(2024, 12, 17, 8, 41, 59), 'sleep_duration_seconds': 28620, 'deep_sleep_seconds': 4200, 'light_sleep_seconds': 19020, 'rem_sleep_seconds': 5400, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 11.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 862584)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,865 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734478200000, 'day': datetime.date(2024, 12, 18), 'sleep_start': datetime.datetime(2024, 12, 18, 1, 30), 'sleep_end': datetime.datetime(2024, 12, 18, 8, 21), 'sleep_duration_seconds': 22620, 'deep_sleep_seconds': 3300, 'light_sleep_seconds': 16020, 'rem_sleep_seconds': 3300, 'awake_seconds': 2040, 'nap_duration_seconds': 0, 'sleep_score': 74, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 863592)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,866 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734560951000, 'day': datetime.date(2024, 12, 19), 'sleep_start': datetime.datetime(2024, 12, 19, 0, 29, 11), 'sleep_end': datetime.datetime(2024, 12, 19, 8, 20, 11), 'sleep_duration_seconds': 23220, 'deep_sleep_seconds': 4740, 'light_sleep_seconds': 18480, 'rem_sleep_seconds': 0, 'awake_seconds': 5040, 'nap_duration_seconds': 0, 'sleep_score': 44, 'avg_sleep_stress': 20.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 14.0, 'awake_count': 6, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 866200)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,868 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734655498000, 'day': datetime.date(2024, 12, 20), 'sleep_start': datetime.datetime(2024, 12, 20, 2, 44, 58), 'sleep_end': datetime.datetime(2024, 12, 20, 9, 57, 58), 'sleep_duration_seconds': 22620, 'deep_sleep_seconds': 3660, 'light_sleep_seconds': 16080, 'rem_sleep_seconds': 2880, 'awake_seconds': 3360, 'nap_duration_seconds': 0, 'sleep_score': 61, 'avg_sleep_stress': 22.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 4, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 867199)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,869 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734734905000, 'day': datetime.date(2024, 12, 21), 'sleep_start': datetime.datetime(2024, 12, 21, 0, 48, 25), 'sleep_end': datetime.datetime(2024, 12, 21, 9, 48, 25), 'sleep_duration_seconds': 28920, 'deep_sleep_seconds': 5520, 'light_sleep_seconds': 18540, 'rem_sleep_seconds': 4860, 'awake_seconds': 3480, 'nap_duration_seconds': 0, 'sleep_score': 61, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 5, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 869299)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,871 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734826548000, 'day': datetime.date(2024, 12, 22), 'sleep_start': datetime.datetime(2024, 12, 22, 2, 15, 48), 'sleep_end': datetime.datetime(2024, 12, 22, 9, 13, 48), 'sleep_duration_seconds': 22260, 'deep_sleep_seconds': 6780, 'light_sleep_seconds': 12660, 'rem_sleep_seconds': 2820, 'awake_seconds': 2820, 'nap_duration_seconds': 0, 'sleep_score': 68, 'avg_sleep_stress': 19.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 871304)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,873 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734901126000, 'day': datetime.date(2024, 12, 23), 'sleep_start': datetime.datetime(2024, 12, 22, 22, 58, 46), 'sleep_end': datetime.datetime(2024, 12, 23, 9, 49, 46), 'sleep_duration_seconds': 35160, 'deep_sleep_seconds': 5340, 'light_sleep_seconds': 22080, 'rem_sleep_seconds': 7740, 'awake_seconds': 3900, 'nap_duration_seconds': 0, 'sleep_score': 73, 'avg_sleep_stress': 17.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 872851)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,875 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734995263000, 'day': datetime.date(2024, 12, 24), 'sleep_start': datetime.datetime(2024, 12, 24, 1, 7, 43), 'sleep_end': datetime.datetime(2024, 12, 24, 9, 39, 43), 'sleep_duration_seconds': 26760, 'deep_sleep_seconds': 3780, 'light_sleep_seconds': 18060, 'rem_sleep_seconds': 4920, 'awake_seconds': 3960, 'nap_duration_seconds': 0, 'sleep_score': 58, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 5, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 873851)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,876 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735087768000, 'day': datetime.date(2024, 12, 25), 'sleep_start': datetime.datetime(2024, 12, 25, 2, 49, 28), 'sleep_end': datetime.datetime(2024, 12, 25, 9, 31, 28), 'sleep_duration_seconds': 22860, 'deep_sleep_seconds': 6840, 'light_sleep_seconds': 13620, 'rem_sleep_seconds': 2400, 'awake_seconds': 1260, 'nap_duration_seconds': 0, 'sleep_score': 75, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 876088)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,878 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735159367000, 'day': datetime.date(2024, 12, 26), 'sleep_start': datetime.datetime(2024, 12, 25, 22, 42, 47), 'sleep_end': datetime.datetime(2024, 12, 26, 7, 31, 47), 'sleep_duration_seconds': 30600, 'deep_sleep_seconds': 4980, 'light_sleep_seconds': 21120, 'rem_sleep_seconds': 4500, 'awake_seconds': 1140, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 11.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 877088)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,879 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735252953000, 'day': datetime.date(2024, 12, 27), 'sleep_start': datetime.datetime(2024, 12, 27, 0, 42, 33), 'sleep_end': datetime.datetime(2024, 12, 27, 8, 3, 33), 'sleep_duration_seconds': 23580, 'deep_sleep_seconds': 5400, 'light_sleep_seconds': 16620, 'rem_sleep_seconds': 1560, 'awake_seconds': 2880, 'nap_duration_seconds': 0, 'sleep_score': 64, 'avg_sleep_stress': 19.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 879501)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,881 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735341838000, 'day': datetime.date(2024, 12, 28), 'sleep_start': datetime.datetime(2024, 12, 28, 1, 23, 58), 'sleep_end': datetime.datetime(2024, 12, 28, 9, 26, 58), 'sleep_duration_seconds': 27180, 'deep_sleep_seconds': 5100, 'light_sleep_seconds': 18660, 'rem_sleep_seconds': 3420, 'awake_seconds': 1800, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 880506)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,882 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735425118000, 'day': datetime.date(2024, 12, 29), 'sleep_start': datetime.datetime(2024, 12, 29, 0, 31, 58), 'sleep_end': datetime.datetime(2024, 12, 29, 7, 15, 58), 'sleep_duration_seconds': 22440, 'deep_sleep_seconds': 6060, 'light_sleep_seconds': 12540, 'rem_sleep_seconds': 3840, 'awake_seconds': 1800, 'nap_duration_seconds': 0, 'sleep_score': 69, 'avg_sleep_stress': 22.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 882506)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,885 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735512162000, 'day': datetime.date(2024, 12, 30), 'sleep_start': datetime.datetime(2024, 12, 30, 0, 42, 42), 'sleep_end': datetime.datetime(2024, 12, 30, 7, 30, 42), 'sleep_duration_seconds': 22980, 'deep_sleep_seconds': 6120, 'light_sleep_seconds': 11640, 'rem_sleep_seconds': 5220, 'awake_seconds': 1500, 'nap_duration_seconds': 3060, 'sleep_score': 75, 'avg_sleep_stress': 21.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 884009)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,886 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-31.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735596602000, 'day': datetime.date(2024, 12, 31), 'sleep_start': datetime.datetime(2024, 12, 31, 0, 10, 2), 'sleep_end': datetime.datetime(2024, 12, 31, 7, 30, 2), 'sleep_duration_seconds': 24420, 'deep_sleep_seconds': 3360, 'light_sleep_seconds': 20220, 'rem_sleep_seconds': 840, 'awake_seconds': 1980, 'nap_duration_seconds': 0, 'sleep_score': 63, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 886014)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,888 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735703507000, 'day': datetime.date(2025, 1, 1), 'sleep_start': datetime.datetime(2025, 1, 1, 5, 51, 47), 'sleep_end': datetime.datetime(2025, 1, 1, 12, 34, 47), 'sleep_duration_seconds': 16440, 'deep_sleep_seconds': 3900, 'light_sleep_seconds': 12540, 'rem_sleep_seconds': 0, 'awake_seconds': 7740, 'nap_duration_seconds': 0, 'sleep_score': 29, 'avg_sleep_stress': 44.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 14.0, 'awake_count': 7, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 888067)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,890 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735766673000, 'day': datetime.date(2025, 1, 2), 'sleep_start': datetime.datetime(2025, 1, 1, 23, 24, 33), 'sleep_end': datetime.datetime(2025, 1, 2, 7, 43, 33), 'sleep_duration_seconds': 28500, 'deep_sleep_seconds': 7020, 'light_sleep_seconds': 16200, 'rem_sleep_seconds': 5280, 'awake_seconds': 1440, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 17.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 889073)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,892 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735864366000, 'day': datetime.date(2025, 1, 3), 'sleep_start': datetime.datetime(2025, 1, 3, 2, 32, 46), 'sleep_end': datetime.datetime(2025, 1, 3, 9, 16, 25), 'sleep_duration_seconds': 23859, 'deep_sleep_seconds': 4380, 'light_sleep_seconds': 15240, 'rem_sleep_seconds': 4260, 'awake_seconds': 360, 'nap_duration_seconds': 0, 'sleep_score': 81, 'avg_sleep_stress': 6.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 891140)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,894 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735946588000, 'day': datetime.date(2025, 1, 4), 'sleep_start': datetime.datetime(2025, 1, 4, 1, 23, 8), 'sleep_end': datetime.datetime(2025, 1, 4, 8, 30, 8), 'sleep_duration_seconds': 25440, 'deep_sleep_seconds': 6360, 'light_sleep_seconds': 14820, 'rem_sleep_seconds': 4260, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 6.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 893212)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,894 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736033918000, 'day': datetime.date(2025, 1, 5), 'sleep_start': datetime.datetime(2025, 1, 5, 1, 38, 38), 'sleep_end': datetime.datetime(2025, 1, 5, 9, 19, 38), 'sleep_duration_seconds': 25860, 'deep_sleep_seconds': 5640, 'light_sleep_seconds': 16680, 'rem_sleep_seconds': 3540, 'awake_seconds': 1800, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 894214)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,894 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736120556000, 'day': datetime.date(2025, 1, 6), 'sleep_start': datetime.datetime(2025, 1, 6, 1, 42, 36), 'sleep_end': datetime.datetime(2025, 1, 6, 8, 34, 36), 'sleep_duration_seconds': 23280, 'deep_sleep_seconds': 4560, 'light_sleep_seconds': 15600, 'rem_sleep_seconds': 3120, 'awake_seconds': 1440, 'nap_duration_seconds': 0, 'sleep_score': 74, 'avg_sleep_stress': 18.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 894214)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,898 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736199003000, 'day': datetime.date(2025, 1, 7), 'sleep_start': datetime.datetime(2025, 1, 6, 23, 30, 3), 'sleep_end': datetime.datetime(2025, 1, 7, 10, 0, 20), 'sleep_duration_seconds': 35117, 'deep_sleep_seconds': 6300, 'light_sleep_seconds': 21420, 'rem_sleep_seconds': 7440, 'awake_seconds': 2700, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 18.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 898122)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,899 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736292466000, 'day': datetime.date(2025, 1, 8), 'sleep_start': datetime.datetime(2025, 1, 8, 1, 27, 46), 'sleep_end': datetime.datetime(2025, 1, 8, 9, 47, 3), 'sleep_duration_seconds': 27797, 'deep_sleep_seconds': 5040, 'light_sleep_seconds': 19200, 'rem_sleep_seconds': 3600, 'awake_seconds': 2160, 'nap_duration_seconds': 0, 'sleep_score': 81, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 899131)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,899 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736380346000, 'day': datetime.date(2025, 1, 9), 'sleep_start': datetime.datetime(2025, 1, 9, 1, 52, 26), 'sleep_end': datetime.datetime(2025, 1, 9, 9, 35, 26), 'sleep_duration_seconds': 26760, 'deep_sleep_seconds': 7200, 'light_sleep_seconds': 15060, 'rem_sleep_seconds': 4500, 'awake_seconds': 1020, 'nap_duration_seconds': 0, 'sleep_score': 86, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 899131)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,904 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736461866000, 'day': datetime.date(2025, 1, 10), 'sleep_start': datetime.datetime(2025, 1, 10, 0, 31, 6), 'sleep_end': datetime.datetime(2025, 1, 10, 8, 53, 6), 'sleep_duration_seconds': 28500, 'deep_sleep_seconds': 5400, 'light_sleep_seconds': 18540, 'rem_sleep_seconds': 4560, 'awake_seconds': 1620, 'nap_duration_seconds': 0, 'sleep_score': 87, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 899131)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,905 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736557266000, 'day': datetime.date(2025, 1, 11), 'sleep_start': datetime.datetime(2025, 1, 11, 3, 1, 6), 'sleep_end': datetime.datetime(2025, 1, 11, 9, 57, 6), 'sleep_duration_seconds': 24000, 'deep_sleep_seconds': 7080, 'light_sleep_seconds': 11460, 'rem_sleep_seconds': 5460, 'awake_seconds': 960, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 904904)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,906 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736643708000, 'day': datetime.date(2025, 1, 12), 'sleep_start': datetime.datetime(2025, 1, 12, 3, 1, 48), 'sleep_end': datetime.datetime(2025, 1, 12, 11, 5, 48), 'sleep_duration_seconds': 24660, 'deep_sleep_seconds': 5280, 'light_sleep_seconds': 16320, 'rem_sleep_seconds': 3060, 'awake_seconds': 4380, 'nap_duration_seconds': 0, 'sleep_score': 72, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 906909)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,909 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736733380000, 'day': datetime.date(2025, 1, 13), 'sleep_start': datetime.datetime(2025, 1, 13, 3, 56, 20), 'sleep_end': datetime.datetime(2025, 1, 13, 8, 39, 20), 'sleep_duration_seconds': 15960, 'deep_sleep_seconds': 5040, 'light_sleep_seconds': 10620, 'rem_sleep_seconds': 300, 'awake_seconds': 1020, 'nap_duration_seconds': 0, 'sleep_score': 49, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 908921)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,910 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736813289000, 'day': datetime.date(2025, 1, 14), 'sleep_start': datetime.datetime(2025, 1, 14, 2, 8, 9), 'sleep_end': datetime.datetime(2025, 1, 14, 8, 30, 9), 'sleep_duration_seconds': 22320, 'deep_sleep_seconds': 8820, 'light_sleep_seconds': 8160, 'rem_sleep_seconds': 5340, 'awake_seconds': 600, 'nap_duration_seconds': 2160, 'sleep_score': 78, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 910729)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,912 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736892759000, 'day': datetime.date(2025, 1, 15), 'sleep_start': datetime.datetime(2025, 1, 15, 0, 12, 39), 'sleep_end': datetime.datetime(2025, 1, 15, 8, 48, 39), 'sleep_duration_seconds': 29760, 'deep_sleep_seconds': 6600, 'light_sleep_seconds': 16620, 'rem_sleep_seconds': 6540, 'awake_seconds': 1200, 'nap_duration_seconds': 0, 'sleep_score': 91, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 911729)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,914 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736981813000, 'day': datetime.date(2025, 1, 16), 'sleep_start': datetime.datetime(2025, 1, 16, 0, 56, 53), 'sleep_end': datetime.datetime(2025, 1, 16, 10, 25, 48), 'sleep_duration_seconds': 31855, 'deep_sleep_seconds': 4020, 'light_sleep_seconds': 21960, 'rem_sleep_seconds': 5880, 'awake_seconds': 2280, 'nap_duration_seconds': 0, 'sleep_score': 81, 'avg_sleep_stress': 7.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 913729)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,915 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737086350000, 'day': datetime.date(2025, 1, 17), 'sleep_start': datetime.datetime(2025, 1, 17, 5, 59, 10), 'sleep_end': datetime.datetime(2025, 1, 17, 11, 19, 10), 'sleep_duration_seconds': 16980, 'deep_sleep_seconds': 3840, 'light_sleep_seconds': 13140, 'rem_sleep_seconds': 0, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 49, 'avg_sleep_stress': 18.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 915771)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,918 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737149027000, 'day': datetime.date(2025, 1, 18), 'sleep_start': datetime.datetime(2025, 1, 17, 23, 23, 47), 'sleep_end': datetime.datetime(2025, 1, 18, 3, 30, 16), 'sleep_duration_seconds': 14729, 'deep_sleep_seconds': 4080, 'light_sleep_seconds': 6780, 'rem_sleep_seconds': 3900, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 55, 'avg_sleep_stress': 7.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 916843)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,919 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737238169000, 'day': datetime.date(2025, 1, 19), 'sleep_start': datetime.datetime(2025, 1, 19, 0, 9, 29), 'sleep_end': datetime.datetime(2025, 1, 19, 8, 55, 19), 'sleep_duration_seconds': 31490, 'deep_sleep_seconds': 9480, 'light_sleep_seconds': 12300, 'rem_sleep_seconds': 9720, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 95, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 919352)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,921 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737335139000, 'day': datetime.date(2025, 1, 20), 'sleep_start': datetime.datetime(2025, 1, 20, 3, 5, 39), 'sleep_end': datetime.datetime(2025, 1, 20, 10, 23, 39), 'sleep_duration_seconds': 24780, 'deep_sleep_seconds': 2640, 'light_sleep_seconds': 17880, 'rem_sleep_seconds': 4260, 'awake_seconds': 660, 'nap_duration_seconds': 0, 'sleep_score': 76, 'avg_sleep_stress': 17.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 920991)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,922 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737413110000, 'day': datetime.date(2025, 1, 21), 'sleep_start': datetime.datetime(2025, 1, 21, 0, 45, 10), 'sleep_end': datetime.datetime(2025, 1, 21, 9, 4, 10), 'sleep_duration_seconds': 26460, 'deep_sleep_seconds': 3000, 'light_sleep_seconds': 15300, 'rem_sleep_seconds': 8160, 'awake_seconds': 1440, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 922997)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,925 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737499781000, 'day': datetime.date(2025, 1, 22), 'sleep_start': datetime.datetime(2025, 1, 22, 0, 49, 41), 'sleep_end': datetime.datetime(2025, 1, 22, 8, 30, 41), 'sleep_duration_seconds': 26520, 'deep_sleep_seconds': 6900, 'light_sleep_seconds': 15720, 'rem_sleep_seconds': 3900, 'awake_seconds': 1140, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 925035)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,927 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737587687000, 'day': datetime.date(2025, 1, 23), 'sleep_start': datetime.datetime(2025, 1, 23, 1, 14, 47), 'sleep_end': datetime.datetime(2025, 1, 23, 8, 13, 47), 'sleep_duration_seconds': 24240, 'deep_sleep_seconds': 8760, 'light_sleep_seconds': 9780, 'rem_sleep_seconds': 5700, 'awake_seconds': 900, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 11.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 926131)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,928 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737672157000, 'day': datetime.date(2025, 1, 24), 'sleep_start': datetime.datetime(2025, 1, 24, 0, 42, 37), 'sleep_end': datetime.datetime(2025, 1, 24, 8, 23, 37), 'sleep_duration_seconds': 24000, 'deep_sleep_seconds': 4080, 'light_sleep_seconds': 13980, 'rem_sleep_seconds': 5940, 'awake_seconds': 1620, 'nap_duration_seconds': 0, 'sleep_score': 80, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 928191)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,929 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737760045000, 'day': datetime.date(2025, 1, 25), 'sleep_start': datetime.datetime(2025, 1, 25, 1, 7, 25), 'sleep_end': datetime.datetime(2025, 1, 25, 9, 34, 25), 'sleep_duration_seconds': 30360, 'deep_sleep_seconds': 2640, 'light_sleep_seconds': 21840, 'rem_sleep_seconds': 5880, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 929502)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,931 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737842022000, 'day': datetime.date(2025, 1, 26), 'sleep_start': datetime.datetime(2025, 1, 25, 23, 53, 42), 'sleep_end': datetime.datetime(2025, 1, 26, 9, 0, 42), 'sleep_duration_seconds': 28800, 'deep_sleep_seconds': 4260, 'light_sleep_seconds': 17940, 'rem_sleep_seconds': 6600, 'awake_seconds': 1140, 'nap_duration_seconds': 0, 'sleep_score': 92, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 930508)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,932 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737937578000, 'day': datetime.date(2025, 1, 27), 'sleep_start': datetime.datetime(2025, 1, 27, 2, 26, 18), 'sleep_end': datetime.datetime(2025, 1, 27, 8, 51, 18), 'sleep_duration_seconds': 21060, 'deep_sleep_seconds': 4500, 'light_sleep_seconds': 12960, 'rem_sleep_seconds': 3600, 'awake_seconds': 2040, 'nap_duration_seconds': 0, 'sleep_score': 71, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 932595)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,934 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738018644000, 'day': datetime.date(2025, 1, 28), 'sleep_start': datetime.datetime(2025, 1, 28, 3, 57, 24), 'sleep_end': datetime.datetime(2025, 1, 28, 7, 28, 24), 'sleep_duration_seconds': 9120, 'deep_sleep_seconds': 1920, 'light_sleep_seconds': 7200, 'rem_sleep_seconds': 0, 'awake_seconds': 3540, 'nap_duration_seconds': 0, 'sleep_score': 33, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 934106)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,936 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738089083000, 'day': datetime.date(2025, 1, 29), 'sleep_start': datetime.datetime(2025, 1, 29, 2, 31, 23), 'sleep_end': datetime.datetime(2025, 1, 29, 6, 1, 5), 'sleep_duration_seconds': 10722, 'deep_sleep_seconds': 2760, 'light_sleep_seconds': 6780, 'rem_sleep_seconds': 1200, 'awake_seconds': 1860, 'nap_duration_seconds': 0, 'sleep_score': 34, 'avg_sleep_stress': 25.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 935112)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,936 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738175891000, 'day': datetime.date(2025, 1, 30), 'sleep_start': datetime.datetime(2025, 1, 30, 2, 38, 11), 'sleep_end': datetime.datetime(2025, 1, 30, 6, 11, 41), 'sleep_duration_seconds': 11130, 'deep_sleep_seconds': 420, 'light_sleep_seconds': 6720, 'rem_sleep_seconds': 4020, 'awake_seconds': 1080, 'nap_duration_seconds': 0, 'sleep_score': 39, 'avg_sleep_stress': 22.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 936659)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,939 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-31.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738251586000, 'day': datetime.date(2025, 1, 31), 'sleep_start': datetime.datetime(2025, 1, 30, 23, 39, 46), 'sleep_end': datetime.datetime(2025, 1, 31, 5, 58, 46), 'sleep_duration_seconds': 20220, 'deep_sleep_seconds': 4200, 'light_sleep_seconds': 10980, 'rem_sleep_seconds': 5040, 'awake_seconds': 1560, 'nap_duration_seconds': 0, 'sleep_score': 72, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 939176)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,941 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738340805000, 'day': datetime.date(2025, 2, 1), 'sleep_start': datetime.datetime(2025, 2, 1, 0, 26, 45), 'sleep_end': datetime.datetime(2025, 2, 1, 8, 23, 45), 'sleep_duration_seconds': 27600, 'deep_sleep_seconds': 6660, 'light_sleep_seconds': 15480, 'rem_sleep_seconds': 5460, 'awake_seconds': 1020, 'nap_duration_seconds': 0, 'sleep_score': 82, 'avg_sleep_stress': 22.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 940213)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,942 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738429981000, 'day': datetime.date(2025, 2, 2), 'sleep_start': datetime.datetime(2025, 2, 2, 1, 13, 1), 'sleep_end': datetime.datetime(2025, 2, 2, 7, 40, 1), 'sleep_duration_seconds': 22200, 'deep_sleep_seconds': 4020, 'light_sleep_seconds': 14640, 'rem_sleep_seconds': 3540, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 72, 'avg_sleep_stress': 23.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 942275)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,943 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738513711000, 'day': datetime.date(2025, 2, 3), 'sleep_start': datetime.datetime(2025, 2, 3, 0, 28, 31), 'sleep_end': datetime.datetime(2025, 2, 3, 7, 5, 24), 'sleep_duration_seconds': 23633, 'deep_sleep_seconds': 4380, 'light_sleep_seconds': 15960, 'rem_sleep_seconds': 3300, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 48, 'avg_sleep_stress': 52.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 943277)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,945 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738606259000, 'day': datetime.date(2025, 2, 4), 'sleep_start': datetime.datetime(2025, 2, 4, 2, 10, 59), 'sleep_end': datetime.datetime(2025, 2, 4, 7, 14, 59), 'sleep_duration_seconds': 16920, 'deep_sleep_seconds': 1380, 'light_sleep_seconds': 12720, 'rem_sleep_seconds': 2820, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 57, 'avg_sleep_stress': 25.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 944387)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,947 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738686494000, 'day': datetime.date(2025, 2, 5), 'sleep_start': datetime.datetime(2025, 2, 5, 0, 28, 14), 'sleep_end': datetime.datetime(2025, 2, 5, 7, 54, 14), 'sleep_duration_seconds': 26640, 'deep_sleep_seconds': 3540, 'light_sleep_seconds': 22740, 'rem_sleep_seconds': 360, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 60, 'avg_sleep_stress': 23.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 15.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 946473)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,948 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738770717000, 'day': datetime.date(2025, 2, 6), 'sleep_start': datetime.datetime(2025, 2, 5, 23, 51, 57), 'sleep_end': datetime.datetime(2025, 2, 6, 6, 37, 57), 'sleep_duration_seconds': 22740, 'deep_sleep_seconds': 1020, 'light_sleep_seconds': 15720, 'rem_sleep_seconds': 6000, 'awake_seconds': 900, 'nap_duration_seconds': 0, 'sleep_score': 68, 'avg_sleep_stress': 21.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 948479)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,950 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738863988000, 'day': datetime.date(2025, 2, 7), 'sleep_start': datetime.datetime(2025, 2, 7, 1, 46, 28), 'sleep_end': datetime.datetime(2025, 2, 7, 8, 25, 28), 'sleep_duration_seconds': 23520, 'deep_sleep_seconds': 4440, 'light_sleep_seconds': 14460, 'rem_sleep_seconds': 4620, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 949779)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,952 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738949963000, 'day': datetime.date(2025, 2, 8), 'sleep_start': datetime.datetime(2025, 2, 8, 1, 39, 23), 'sleep_end': datetime.datetime(2025, 2, 8, 2, 21, 23), 'sleep_duration_seconds': 2460, 'deep_sleep_seconds': 0, 'light_sleep_seconds': 2460, 'rem_sleep_seconds': 0, 'awake_seconds': 60, 'nap_duration_seconds': 4200, 'sleep_score': 29, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 951785)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,954 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739027059000, 'day': datetime.date(2025, 2, 9), 'sleep_start': datetime.datetime(2025, 2, 8, 23, 4, 19), 'sleep_end': datetime.datetime(2025, 2, 9, 8, 32, 49), 'sleep_duration_seconds': 33330, 'deep_sleep_seconds': 2280, 'light_sleep_seconds': 26640, 'rem_sleep_seconds': 4440, 'awake_seconds': 780, 'nap_duration_seconds': 0, 'sleep_score': 59, 'avg_sleep_stress': 39.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 954332)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,955 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739116721000, 'day': datetime.date(2025, 2, 10), 'sleep_start': datetime.datetime(2025, 2, 9, 23, 58, 41), 'sleep_end': datetime.datetime(2025, 2, 10, 6, 40, 41), 'sleep_duration_seconds': 21000, 'deep_sleep_seconds': 3960, 'light_sleep_seconds': 12540, 'rem_sleep_seconds': 4500, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 60, 'avg_sleep_stress': 35.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 955837)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,956 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739212791000, 'day': datetime.date(2025, 2, 11), 'sleep_start': datetime.datetime(2025, 2, 11, 2, 39, 51), 'sleep_end': datetime.datetime(2025, 2, 11, 8, 7, 47), 'sleep_duration_seconds': 18776, 'deep_sleep_seconds': 4500, 'light_sleep_seconds': 7080, 'rem_sleep_seconds': 7200, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 68, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 956842)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,959 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739297535000, 'day': datetime.date(2025, 2, 12), 'sleep_start': datetime.datetime(2025, 2, 12, 2, 12, 15), 'sleep_end': datetime.datetime(2025, 2, 12, 8, 2, 15), 'sleep_duration_seconds': 21000, 'deep_sleep_seconds': 6060, 'light_sleep_seconds': 7200, 'rem_sleep_seconds': 7740, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 74, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 959351)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,961 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739379969000, 'day': datetime.date(2025, 2, 13), 'sleep_start': datetime.datetime(2025, 2, 13, 1, 6, 9), 'sleep_end': datetime.datetime(2025, 2, 13, 7, 24, 9), 'sleep_duration_seconds': 20340, 'deep_sleep_seconds': 0, 'light_sleep_seconds': 20340, 'rem_sleep_seconds': 0, 'awake_seconds': 2340, 'nap_duration_seconds': 0, 'sleep_score': 32, 'avg_sleep_stress': 51.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 960418)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,963 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739470402000, 'day': datetime.date(2025, 2, 14), 'sleep_start': datetime.datetime(2025, 2, 14, 2, 13, 22), 'sleep_end': datetime.datetime(2025, 2, 14, 5, 45, 22), 'sleep_duration_seconds': 12300, 'deep_sleep_seconds': 2460, 'light_sleep_seconds': 9000, 'rem_sleep_seconds': 840, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 43, 'avg_sleep_stress': 22.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 16.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 962419)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,964 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739548363000, 'day': datetime.date(2025, 2, 15), 'sleep_start': datetime.datetime(2025, 2, 14, 23, 52, 43), 'sleep_end': datetime.datetime(2025, 2, 15, 7, 40, 43), 'sleep_duration_seconds': 21780, 'deep_sleep_seconds': 7320, 'light_sleep_seconds': 9120, 'rem_sleep_seconds': 5340, 'awake_seconds': 480, 'nap_duration_seconds': 0, 'sleep_score': 77, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 964417)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,966 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739638599000, 'day': datetime.date(2025, 2, 16), 'sleep_start': datetime.datetime(2025, 2, 16, 0, 56, 39), 'sleep_end': datetime.datetime(2025, 2, 16, 7, 38, 28), 'sleep_duration_seconds': 22069, 'deep_sleep_seconds': 2460, 'light_sleep_seconds': 12420, 'rem_sleep_seconds': 7200, 'awake_seconds': 60, 'nap_duration_seconds': 1980, 'sleep_score': 76, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 965920)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,969 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739717369000, 'day': datetime.date(2025, 2, 17), 'sleep_start': datetime.datetime(2025, 2, 16, 22, 49, 29), 'sleep_end': datetime.datetime(2025, 2, 17, 7, 9, 25), 'sleep_duration_seconds': 26576, 'deep_sleep_seconds': 4560, 'light_sleep_seconds': 19140, 'rem_sleep_seconds': 2880, 'awake_seconds': 3420, 'nap_duration_seconds': 0, 'sleep_score': 73, 'avg_sleep_stress': 17.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 968031)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,969 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739804427000, 'day': datetime.date(2025, 2, 18), 'sleep_start': datetime.datetime(2025, 2, 17, 23, 0, 27), 'sleep_end': datetime.datetime(2025, 2, 18, 7, 10, 10), 'sleep_duration_seconds': 27283, 'deep_sleep_seconds': 2640, 'light_sleep_seconds': 18960, 'rem_sleep_seconds': 5700, 'awake_seconds': 720, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 7.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 969838)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,971 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739892511000, 'day': datetime.date(2025, 2, 19), 'sleep_start': datetime.datetime(2025, 2, 18, 23, 28, 31), 'sleep_end': datetime.datetime(2025, 2, 19, 6, 30, 9), 'sleep_duration_seconds': 23798, 'deep_sleep_seconds': 4740, 'light_sleep_seconds': 13440, 'rem_sleep_seconds': 5640, 'awake_seconds': 1500, 'nap_duration_seconds': 1440, 'sleep_score': 80, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 971844)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,973 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739981177000, 'day': datetime.date(2025, 2, 20), 'sleep_start': datetime.datetime(2025, 2, 20, 0, 6, 17), 'sleep_end': datetime.datetime(2025, 2, 20, 6, 25, 17), 'sleep_duration_seconds': 20280, 'deep_sleep_seconds': 2400, 'light_sleep_seconds': 13440, 'rem_sleep_seconds': 4440, 'awake_seconds': 660, 'nap_duration_seconds': 0, 'sleep_score': 63, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 972842)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,974 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740064927000, 'day': datetime.date(2025, 2, 21), 'sleep_start': datetime.datetime(2025, 2, 20, 23, 22, 7), 'sleep_end': datetime.datetime(2025, 2, 21, 5, 50, 7), 'sleep_duration_seconds': 21540, 'deep_sleep_seconds': 4380, 'light_sleep_seconds': 13080, 'rem_sleep_seconds': 4080, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 77, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 974842)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,976 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740149230000, 'day': datetime.date(2025, 2, 22), 'sleep_start': datetime.datetime(2025, 2, 21, 22, 47, 10), 'sleep_end': datetime.datetime(2025, 2, 22, 7, 1, 10), 'sleep_duration_seconds': 24780, 'deep_sleep_seconds': 2940, 'light_sleep_seconds': 17940, 'rem_sleep_seconds': 3900, 'awake_seconds': 3240, 'nap_duration_seconds': 0, 'sleep_score': 69, 'avg_sleep_stress': 17.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 976346)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,978 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740251562000, 'day': datetime.date(2025, 2, 23), 'sleep_start': datetime.datetime(2025, 2, 23, 3, 12, 42), 'sleep_end': datetime.datetime(2025, 2, 23, 8, 38, 42), 'sleep_duration_seconds': 13860, 'deep_sleep_seconds': 1380, 'light_sleep_seconds': 10920, 'rem_sleep_seconds': 1560, 'awake_seconds': 2820, 'nap_duration_seconds': 0, 'sleep_score': 46, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 977351)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,978 - WARNING - No sleep ID found for 2025-02-24
2025-08-05 19:48:48,980 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740409893000, 'day': datetime.date(2025, 2, 25), 'sleep_start': datetime.datetime(2025, 2, 24, 23, 11, 33), 'sleep_end': datetime.datetime(2025, 2, 25, 7, 58, 21), 'sleep_duration_seconds': 28488, 'deep_sleep_seconds': 8640, 'light_sleep_seconds': 13800, 'rem_sleep_seconds': 6060, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 96, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 979371)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,981 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740498605000, 'day': datetime.date(2025, 2, 26), 'sleep_start': datetime.datetime(2025, 2, 25, 23, 50, 5), 'sleep_end': datetime.datetime(2025, 2, 26, 6, 43, 5), 'sleep_duration_seconds': 24780, 'deep_sleep_seconds': 9420, 'light_sleep_seconds': 9900, 'rem_sleep_seconds': 5460, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 11.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 980376)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,982 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740586757000, 'day': datetime.date(2025, 2, 27), 'sleep_start': datetime.datetime(2025, 2, 27, 0, 19, 17), 'sleep_end': datetime.datetime(2025, 2, 27, 6, 21, 17), 'sleep_duration_seconds': 20460, 'deep_sleep_seconds': 2100, 'light_sleep_seconds': 14100, 'rem_sleep_seconds': 4260, 'awake_seconds': 1260, 'nap_duration_seconds': 0, 'sleep_score': 70, 'avg_sleep_stress': 11.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 982375)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,984 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740671293000, 'day': datetime.date(2025, 2, 28), 'sleep_start': datetime.datetime(2025, 2, 27, 23, 48, 13), 'sleep_end': datetime.datetime(2025, 2, 28, 8, 9, 40), 'sleep_duration_seconds': 28287, 'deep_sleep_seconds': 5820, 'light_sleep_seconds': 16020, 'rem_sleep_seconds': 6480, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 97, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 983909)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,986 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740755358000, 'day': datetime.date(2025, 3, 1), 'sleep_start': datetime.datetime(2025, 2, 28, 23, 9, 18), 'sleep_end': datetime.datetime(2025, 3, 1, 7, 8, 47), 'sleep_duration_seconds': 25349, 'deep_sleep_seconds': 3060, 'light_sleep_seconds': 18420, 'rem_sleep_seconds': 3900, 'awake_seconds': 3420, 'nap_duration_seconds': 0, 'sleep_score': 68, 'avg_sleep_stress': 27.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 986412)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,989 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740843135000, 'day': datetime.date(2025, 3, 2), 'sleep_start': datetime.datetime(2025, 3, 1, 23, 32, 15), 'sleep_end': datetime.datetime(2025, 3, 2, 7, 53, 5), 'sleep_duration_seconds': 28790, 'deep_sleep_seconds': 3120, 'light_sleep_seconds': 21000, 'rem_sleep_seconds': 4680, 'awake_seconds': 1260, 'nap_duration_seconds': 0, 'sleep_score': 62, 'avg_sleep_stress': 37.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 988416)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,990 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740935495000, 'day': datetime.date(2025, 3, 3), 'sleep_start': datetime.datetime(2025, 3, 3, 1, 11, 35), 'sleep_end': datetime.datetime(2025, 3, 3, 6, 55, 33), 'sleep_duration_seconds': 20578, 'deep_sleep_seconds': 3600, 'light_sleep_seconds': 13980, 'rem_sleep_seconds': 3000, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 57, 'avg_sleep_stress': 37.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 14.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 989925)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,992 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741020058000, 'day': datetime.date(2025, 3, 4), 'sleep_start': datetime.datetime(2025, 3, 4, 0, 40, 58), 'sleep_end': datetime.datetime(2025, 3, 4, 6, 33, 58), 'sleep_duration_seconds': 21180, 'deep_sleep_seconds': 3540, 'light_sleep_seconds': 14100, 'rem_sleep_seconds': 3540, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 56, 'avg_sleep_stress': 39.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 991988)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,993 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741101046000, 'day': datetime.date(2025, 3, 5), 'sleep_start': datetime.datetime(2025, 3, 4, 23, 10, 46), 'sleep_end': datetime.datetime(2025, 3, 5, 7, 48, 33), 'sleep_duration_seconds': 30827, 'deep_sleep_seconds': 2640, 'light_sleep_seconds': 23940, 'rem_sleep_seconds': 4260, 'awake_seconds': 240, 'nap_duration_seconds': 0, 'sleep_score': 50, 'avg_sleep_stress': 49.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 993986)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,996 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741190173000, 'day': datetime.date(2025, 3, 6), 'sleep_start': datetime.datetime(2025, 3, 5, 23, 56, 13), 'sleep_end': datetime.datetime(2025, 3, 6, 8, 9, 13), 'sleep_duration_seconds': 28680, 'deep_sleep_seconds': 1440, 'light_sleep_seconds': 21720, 'rem_sleep_seconds': 5520, 'awake_seconds': 900, 'nap_duration_seconds': 0, 'sleep_score': 75, 'avg_sleep_stress': 24.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 996537)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:48,999 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741277500000, 'day': datetime.date(2025, 3, 7), 'sleep_start': datetime.datetime(2025, 3, 7, 0, 11, 40), 'sleep_end': datetime.datetime(2025, 3, 7, 7, 45, 14), 'sleep_duration_seconds': 25594, 'deep_sleep_seconds': 5340, 'light_sleep_seconds': 14760, 'rem_sleep_seconds': 5520, 'awake_seconds': 660, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 48, 999136)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,002 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741367697000, 'day': datetime.date(2025, 3, 8), 'sleep_start': datetime.datetime(2025, 3, 8, 1, 14, 57), 'sleep_end': datetime.datetime(2025, 3, 8, 6, 8, 50), 'sleep_duration_seconds': 17573, 'deep_sleep_seconds': 3840, 'light_sleep_seconds': 9000, 'rem_sleep_seconds': 4740, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 64, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 1142)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,004 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741451022000, 'day': datetime.date(2025, 3, 9), 'sleep_start': datetime.datetime(2025, 3, 9, 0, 23, 42), 'sleep_end': datetime.datetime(2025, 3, 9, 7, 0, 9), 'sleep_duration_seconds': 22107, 'deep_sleep_seconds': 4500, 'light_sleep_seconds': 13860, 'rem_sleep_seconds': 3780, 'awake_seconds': 1680, 'nap_duration_seconds': 0, 'sleep_score': 70, 'avg_sleep_stress': 24.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 3140)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,006 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741536145000, 'day': datetime.date(2025, 3, 10), 'sleep_start': datetime.datetime(2025, 3, 10, 0, 2, 25), 'sleep_end': datetime.datetime(2025, 3, 10, 9, 1, 25), 'sleep_duration_seconds': 30060, 'deep_sleep_seconds': 2220, 'light_sleep_seconds': 18960, 'rem_sleep_seconds': 8880, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 25.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 5141)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,008 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741627040000, 'day': datetime.date(2025, 3, 11), 'sleep_start': datetime.datetime(2025, 3, 11, 1, 17, 20), 'sleep_end': datetime.datetime(2025, 3, 11, 7, 22, 54), 'sleep_duration_seconds': 18754, 'deep_sleep_seconds': 3300, 'light_sleep_seconds': 12120, 'rem_sleep_seconds': 3360, 'awake_seconds': 660, 'nap_duration_seconds': 0, 'sleep_score': 67, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 8161)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,010 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741790188000, 'day': datetime.date(2025, 3, 12), 'sleep_start': datetime.datetime(2025, 3, 12, 19, 36, 28), 'sleep_end': datetime.datetime(2025, 3, 12, 21, 59, 28), 'sleep_duration_seconds': 7980, 'deep_sleep_seconds': 3480, 'light_sleep_seconds': 3540, 'rem_sleep_seconds': 960, 'awake_seconds': 600, 'nap_duration_seconds': 0, 'sleep_score': 30, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 9671)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,010 - WARNING - No sleep ID found for 2025-03-13
2025-08-05 19:48:49,013 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741964832000, 'day': datetime.date(2025, 3, 14), 'sleep_start': datetime.datetime(2025, 3, 14, 17, 7, 12), 'sleep_end': datetime.datetime(2025, 3, 14, 21, 3, 12), 'sleep_duration_seconds': 14160, 'deep_sleep_seconds': 7380, 'light_sleep_seconds': 4200, 'rem_sleep_seconds': 2580, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 51, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 420, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 12676)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,015 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742000206000, 'day': datetime.date(2025, 3, 15), 'sleep_start': datetime.datetime(2025, 3, 15, 2, 56, 46), 'sleep_end': datetime.datetime(2025, 3, 15, 7, 13, 7), 'sleep_duration_seconds': 15381, 'deep_sleep_seconds': 4740, 'light_sleep_seconds': 5940, 'rem_sleep_seconds': 4740, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 56, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 15227)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,015 - WARNING - No sleep ID found for 2025-03-16
2025-08-05 19:48:49,018 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742176367000, 'day': datetime.date(2025, 3, 17), 'sleep_start': datetime.datetime(2025, 3, 17, 3, 52, 47), 'sleep_end': datetime.datetime(2025, 3, 17, 9, 45, 47), 'sleep_duration_seconds': 19320, 'deep_sleep_seconds': 7200, 'light_sleep_seconds': 9060, 'rem_sleep_seconds': 3060, 'awake_seconds': 1860, 'nap_duration_seconds': 0, 'sleep_score': 67, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 18308)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,020 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742244024000, 'day': datetime.date(2025, 3, 18), 'sleep_start': datetime.datetime(2025, 3, 17, 22, 40, 24), 'sleep_end': datetime.datetime(2025, 3, 18, 7, 18, 2), 'sleep_duration_seconds': 29978, 'deep_sleep_seconds': 5460, 'light_sleep_seconds': 20640, 'rem_sleep_seconds': 3900, 'awake_seconds': 1080, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 20586)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,023 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742333663000, 'day': datetime.date(2025, 3, 19), 'sleep_start': datetime.datetime(2025, 3, 18, 23, 34, 23), 'sleep_end': datetime.datetime(2025, 3, 19, 6, 47, 23), 'sleep_duration_seconds': 23880, 'deep_sleep_seconds': 6660, 'light_sleep_seconds': 12960, 'rem_sleep_seconds': 4260, 'awake_seconds': 2100, 'nap_duration_seconds': 0, 'sleep_score': 75, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 23094)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,025 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742417244000, 'day': datetime.date(2025, 3, 20), 'sleep_start': datetime.datetime(2025, 3, 19, 22, 47, 24), 'sleep_end': datetime.datetime(2025, 3, 20, 7, 52, 24), 'sleep_duration_seconds': 31200, 'deep_sleep_seconds': 4920, 'light_sleep_seconds': 20880, 'rem_sleep_seconds': 5400, 'awake_seconds': 1500, 'nap_duration_seconds': 0, 'sleep_score': 82, 'avg_sleep_stress': 21.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 25098)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,028 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742509215000, 'day': datetime.date(2025, 3, 21), 'sleep_start': datetime.datetime(2025, 3, 21, 0, 20, 15), 'sleep_end': datetime.datetime(2025, 3, 21, 8, 25, 15), 'sleep_duration_seconds': 28260, 'deep_sleep_seconds': 7740, 'light_sleep_seconds': 12600, 'rem_sleep_seconds': 7920, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 92, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 27350)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,030 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742593324000, 'day': datetime.date(2025, 3, 22), 'sleep_start': datetime.datetime(2025, 3, 21, 23, 42, 4), 'sleep_end': datetime.datetime(2025, 3, 22, 7, 59, 4), 'sleep_duration_seconds': 27780, 'deep_sleep_seconds': 6480, 'light_sleep_seconds': 15360, 'rem_sleep_seconds': 5940, 'awake_seconds': 2040, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 30207)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,033 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742685870000, 'day': datetime.date(2025, 3, 23), 'sleep_start': datetime.datetime(2025, 3, 23, 1, 24, 30), 'sleep_end': datetime.datetime(2025, 3, 23, 7, 59, 6), 'sleep_duration_seconds': 23676, 'deep_sleep_seconds': 6780, 'light_sleep_seconds': 12660, 'rem_sleep_seconds': 4260, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 81, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 33266)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,036 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742766816000, 'day': datetime.date(2025, 3, 24), 'sleep_start': datetime.datetime(2025, 3, 23, 23, 53, 36), 'sleep_end': datetime.datetime(2025, 3, 24, 7, 41, 36), 'sleep_duration_seconds': 27960, 'deep_sleep_seconds': 9960, 'light_sleep_seconds': 11340, 'rem_sleep_seconds': 6660, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 93, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 35289)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,039 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742857109000, 'day': datetime.date(2025, 3, 25), 'sleep_start': datetime.datetime(2025, 3, 25, 0, 58, 29), 'sleep_end': datetime.datetime(2025, 3, 25, 8, 32, 29), 'sleep_duration_seconds': 26640, 'deep_sleep_seconds': 9240, 'light_sleep_seconds': 9420, 'rem_sleep_seconds': 7980, 'awake_seconds': 600, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 20.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 38303)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,041 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742938051000, 'day': datetime.date(2025, 3, 26), 'sleep_start': datetime.datetime(2025, 3, 25, 23, 27, 31), 'sleep_end': datetime.datetime(2025, 3, 26, 7, 20, 31), 'sleep_duration_seconds': 28380, 'deep_sleep_seconds': 5520, 'light_sleep_seconds': 16740, 'rem_sleep_seconds': 6120, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 96, 'avg_sleep_stress': 6.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 40818)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,043 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743025273000, 'day': datetime.date(2025, 3, 27), 'sleep_start': datetime.datetime(2025, 3, 26, 23, 41, 13), 'sleep_end': datetime.datetime(2025, 3, 27, 8, 0, 13), 'sleep_duration_seconds': 29880, 'deep_sleep_seconds': 6900, 'light_sleep_seconds': 15720, 'rem_sleep_seconds': 7260, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 99, 'avg_sleep_stress': 11.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 42887)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,045 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743118928000, 'day': datetime.date(2025, 3, 28), 'sleep_start': datetime.datetime(2025, 3, 28, 1, 42, 8), 'sleep_end': datetime.datetime(2025, 3, 28, 9, 2, 8), 'sleep_duration_seconds': 25980, 'deep_sleep_seconds': 4800, 'light_sleep_seconds': 15840, 'rem_sleep_seconds': 5340, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 86, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 45626)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,048 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743203877000, 'day': datetime.date(2025, 3, 29), 'sleep_start': datetime.datetime(2025, 3, 29, 1, 17, 57), 'sleep_end': datetime.datetime(2025, 3, 29, 6, 0, 57), 'sleep_duration_seconds': 15000, 'deep_sleep_seconds': 2520, 'light_sleep_seconds': 8880, 'rem_sleep_seconds': 3600, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 55, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 46631)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,051 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743296400000, 'day': datetime.date(2025, 3, 30), 'sleep_start': datetime.datetime(2025, 3, 30, 5, 0), 'sleep_end': datetime.datetime(2025, 3, 30, 12, 30), 'sleep_duration_seconds': 26880, 'deep_sleep_seconds': 7440, 'light_sleep_seconds': 16020, 'rem_sleep_seconds': 3420, 'awake_seconds': 120, 'nap_duration_seconds': 7200, 'sleep_score': 87, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 50293)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,053 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-31.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743368293000, 'day': datetime.date(2025, 3, 31), 'sleep_start': datetime.datetime(2025, 3, 31, 0, 58, 13), 'sleep_end': datetime.datetime(2025, 3, 31, 10, 0, 13), 'sleep_duration_seconds': 32460, 'deep_sleep_seconds': 6180, 'light_sleep_seconds': 14700, 'rem_sleep_seconds': 11580, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 93, 'avg_sleep_stress': 11.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 420, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 52293)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,056 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743454302000, 'day': datetime.date(2025, 4, 1), 'sleep_start': datetime.datetime(2025, 4, 1, 0, 51, 42), 'sleep_end': datetime.datetime(2025, 4, 1, 10, 17, 42), 'sleep_duration_seconds': 33780, 'deep_sleep_seconds': 5820, 'light_sleep_seconds': 17880, 'rem_sleep_seconds': 10080, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 93, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 430, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 55294)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,058 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743543731000, 'day': datetime.date(2025, 4, 2), 'sleep_start': datetime.datetime(2025, 4, 2, 1, 42, 11), 'sleep_end': datetime.datetime(2025, 4, 2, 10, 20, 27), 'sleep_duration_seconds': 27376, 'deep_sleep_seconds': 3060, 'light_sleep_seconds': 17280, 'rem_sleep_seconds': 7080, 'awake_seconds': 2280, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 430, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 57293)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,060 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743633998000, 'day': datetime.date(2025, 4, 3), 'sleep_start': datetime.datetime(2025, 4, 3, 2, 46, 38), 'sleep_end': datetime.datetime(2025, 4, 3, 9, 13, 57), 'sleep_duration_seconds': 23239, 'deep_sleep_seconds': 5400, 'light_sleep_seconds': 12300, 'rem_sleep_seconds': 5580, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 60249)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,060 - WARNING - No sleep ID found for 2025-04-04
2025-08-05 19:48:49,062 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743809996000, 'day': datetime.date(2025, 4, 5), 'sleep_start': datetime.datetime(2025, 4, 5, 4, 39, 56), 'sleep_end': datetime.datetime(2025, 4, 5, 11, 3, 56), 'sleep_duration_seconds': 21780, 'deep_sleep_seconds': 2940, 'light_sleep_seconds': 16080, 'rem_sleep_seconds': 2760, 'awake_seconds': 1260, 'nap_duration_seconds': 0, 'sleep_score': 70, 'avg_sleep_stress': 20.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 61793)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,064 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743898366000, 'day': datetime.date(2025, 4, 6), 'sleep_start': datetime.datetime(2025, 4, 6, 5, 12, 46), 'sleep_end': datetime.datetime(2025, 4, 6, 11, 13, 46), 'sleep_duration_seconds': 21660, 'deep_sleep_seconds': 7080, 'light_sleep_seconds': 9720, 'rem_sleep_seconds': 4860, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 75, 'avg_sleep_stress': 17.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 63869)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,066 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743978333000, 'day': datetime.date(2025, 4, 7), 'sleep_start': datetime.datetime(2025, 4, 7, 3, 25, 33), 'sleep_end': datetime.datetime(2025, 4, 7, 9, 0, 9), 'sleep_duration_seconds': 19956, 'deep_sleep_seconds': 7020, 'light_sleep_seconds': 9600, 'rem_sleep_seconds': 3360, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 70, 'avg_sleep_stress': 18.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 65869)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,068 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744058303000, 'day': datetime.date(2025, 4, 8), 'sleep_start': datetime.datetime(2025, 4, 8, 0, 38, 23), 'sleep_end': datetime.datetime(2025, 4, 8, 10, 30, 23), 'sleep_duration_seconds': 34380, 'deep_sleep_seconds': 6000, 'light_sleep_seconds': 17820, 'rem_sleep_seconds': 10560, 'awake_seconds': 600, 'nap_duration_seconds': 0, 'sleep_score': 93, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 68964)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,072 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744149467000, 'day': datetime.date(2025, 4, 9), 'sleep_start': datetime.datetime(2025, 4, 9, 1, 57, 47), 'sleep_end': datetime.datetime(2025, 4, 9, 8, 52, 47), 'sleep_duration_seconds': 22380, 'deep_sleep_seconds': 3360, 'light_sleep_seconds': 13680, 'rem_sleep_seconds': 5340, 'awake_seconds': 1320, 'nap_duration_seconds': 0, 'sleep_score': 76, 'avg_sleep_stress': 7.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 71018)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,074 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744235021000, 'day': datetime.date(2025, 4, 10), 'sleep_start': datetime.datetime(2025, 4, 10, 1, 43, 41), 'sleep_end': datetime.datetime(2025, 4, 10, 9, 0, 41), 'sleep_duration_seconds': 25320, 'deep_sleep_seconds': 8880, 'light_sleep_seconds': 9060, 'rem_sleep_seconds': 7380, 'awake_seconds': 900, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 73018)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,076 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744339469000, 'day': datetime.date(2025, 4, 11), 'sleep_start': datetime.datetime(2025, 4, 11, 6, 44, 29), 'sleep_end': datetime.datetime(2025, 4, 11, 10, 47, 29), 'sleep_duration_seconds': 14400, 'deep_sleep_seconds': 5100, 'light_sleep_seconds': 7080, 'rem_sleep_seconds': 2220, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 48, 'avg_sleep_stress': 30.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 76017)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,079 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744412006000, 'day': datetime.date(2025, 4, 12), 'sleep_start': datetime.datetime(2025, 4, 12, 2, 53, 26), 'sleep_end': datetime.datetime(2025, 4, 12, 10, 7, 26), 'sleep_duration_seconds': 26040, 'deep_sleep_seconds': 4080, 'light_sleep_seconds': 15600, 'rem_sleep_seconds': 6360, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 5.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 78575)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,081 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744494448000, 'day': datetime.date(2025, 4, 13), 'sleep_start': datetime.datetime(2025, 4, 13, 1, 47, 28), 'sleep_end': datetime.datetime(2025, 4, 13, 10, 46, 50), 'sleep_duration_seconds': 30262, 'deep_sleep_seconds': 4920, 'light_sleep_seconds': 14280, 'rem_sleep_seconds': 11100, 'awake_seconds': 300, 'nap_duration_seconds': 0, 'sleep_score': 91, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 80864)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,083 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744579800000, 'day': datetime.date(2025, 4, 14), 'sleep_start': datetime.datetime(2025, 4, 14, 1, 30), 'sleep_end': datetime.datetime(2025, 4, 14, 10, 37), 'sleep_duration_seconds': 29100, 'deep_sleep_seconds': 3360, 'light_sleep_seconds': 19860, 'rem_sleep_seconds': 5880, 'awake_seconds': 1800, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 83864)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,085 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744666099000, 'day': datetime.date(2025, 4, 15), 'sleep_start': datetime.datetime(2025, 4, 15, 1, 28, 19), 'sleep_end': datetime.datetime(2025, 4, 15, 8, 32, 19), 'sleep_duration_seconds': 25320, 'deep_sleep_seconds': 3240, 'light_sleep_seconds': 14460, 'rem_sleep_seconds': 7620, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 81, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 85864)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,088 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744754464000, 'day': datetime.date(2025, 4, 16), 'sleep_start': datetime.datetime(2025, 4, 16, 2, 1, 4), 'sleep_end': datetime.datetime(2025, 4, 16, 8, 4, 4), 'sleep_duration_seconds': 19440, 'deep_sleep_seconds': 3420, 'light_sleep_seconds': 9960, 'rem_sleep_seconds': 6060, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 71, 'avg_sleep_stress': 7.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 88370)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,092 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744838706000, 'day': datetime.date(2025, 4, 17), 'sleep_start': datetime.datetime(2025, 4, 17, 1, 25, 6), 'sleep_end': datetime.datetime(2025, 4, 17, 10, 1, 6), 'sleep_duration_seconds': 29280, 'deep_sleep_seconds': 8580, 'light_sleep_seconds': 17520, 'rem_sleep_seconds': 3180, 'awake_seconds': 1680, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 18.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 91471)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,094 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744925456000, 'day': datetime.date(2025, 4, 18), 'sleep_start': datetime.datetime(2025, 4, 18, 1, 30, 56), 'sleep_end': datetime.datetime(2025, 4, 18, 8, 44, 56), 'sleep_duration_seconds': 24360, 'deep_sleep_seconds': 4800, 'light_sleep_seconds': 12780, 'rem_sleep_seconds': 6780, 'awake_seconds': 1680, 'nap_duration_seconds': 0, 'sleep_score': 78, 'avg_sleep_stress': 21.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 94018)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,094 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745012736000, 'day': datetime.date(2025, 4, 19), 'sleep_start': datetime.datetime(2025, 4, 19, 1, 45, 36), 'sleep_end': datetime.datetime(2025, 4, 19, 10, 18, 36), 'sleep_duration_seconds': 28620, 'deep_sleep_seconds': 3540, 'light_sleep_seconds': 17640, 'rem_sleep_seconds': 7440, 'awake_seconds': 960, 'nap_duration_seconds': 0, 'sleep_score': 91, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 94018)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,099 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745086741000, 'day': datetime.date(2025, 4, 20), 'sleep_start': datetime.datetime(2025, 4, 19, 22, 19, 1), 'sleep_end': datetime.datetime(2025, 4, 20, 9, 11, 1), 'sleep_duration_seconds': 34620, 'deep_sleep_seconds': 5640, 'light_sleep_seconds': 21600, 'rem_sleep_seconds': 7380, 'awake_seconds': 3420, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 7.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 98992)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,099 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745188694000, 'day': datetime.date(2025, 4, 21), 'sleep_start': datetime.datetime(2025, 4, 21, 2, 38, 14), 'sleep_end': datetime.datetime(2025, 4, 21, 10, 44, 14), 'sleep_duration_seconds': 26580, 'deep_sleep_seconds': 6960, 'light_sleep_seconds': 16500, 'rem_sleep_seconds': 3120, 'awake_seconds': 2580, 'nap_duration_seconds': 0, 'sleep_score': 66, 'avg_sleep_stress': 18.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 4, 'sleep_need_baseline': 480, 'sleep_need_actual': 440, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 99334)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,099 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745261846000, 'day': datetime.date(2025, 4, 22), 'sleep_start': datetime.datetime(2025, 4, 21, 22, 57, 26), 'sleep_end': datetime.datetime(2025, 4, 22, 10, 53, 26), 'sleep_duration_seconds': 41040, 'deep_sleep_seconds': 8100, 'light_sleep_seconds': 21720, 'rem_sleep_seconds': 11220, 'awake_seconds': 1920, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 99334)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,099 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745357799000, 'day': datetime.date(2025, 4, 23), 'sleep_start': datetime.datetime(2025, 4, 23, 1, 36, 39), 'sleep_end': datetime.datetime(2025, 4, 23, 7, 42, 28), 'sleep_duration_seconds': 21889, 'deep_sleep_seconds': 7260, 'light_sleep_seconds': 11040, 'rem_sleep_seconds': 3600, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 77, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 430, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 99334)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,109 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745448434000, 'day': datetime.date(2025, 4, 24), 'sleep_start': datetime.datetime(2025, 4, 24, 2, 47, 14), 'sleep_end': datetime.datetime(2025, 4, 24, 9, 11, 2), 'sleep_duration_seconds': 22848, 'deep_sleep_seconds': 7020, 'light_sleep_seconds': 9540, 'rem_sleep_seconds': 6300, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 81, 'avg_sleep_stress': 10.0, 'avg_spo2': 95.0, 'lowest_spo2': 89, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 109146)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,112 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745530818000, 'day': datetime.date(2025, 4, 25), 'sleep_start': datetime.datetime(2025, 4, 25, 1, 40, 18), 'sleep_end': datetime.datetime(2025, 4, 25, 9, 16, 18), 'sleep_duration_seconds': 23700, 'deep_sleep_seconds': 3840, 'light_sleep_seconds': 13620, 'rem_sleep_seconds': 6240, 'awake_seconds': 1440, 'nap_duration_seconds': 0, 'sleep_score': 80, 'avg_sleep_stress': 8.0, 'avg_spo2': 95.0, 'lowest_spo2': 89, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 111151)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,115 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745614440000, 'day': datetime.date(2025, 4, 26), 'sleep_start': datetime.datetime(2025, 4, 26, 0, 54), 'sleep_end': datetime.datetime(2025, 4, 26, 8, 51), 'sleep_duration_seconds': 28140, 'deep_sleep_seconds': 6780, 'light_sleep_seconds': 16080, 'rem_sleep_seconds': 5280, 'awake_seconds': 480, 'nap_duration_seconds': 0, 'sleep_score': 94, 'avg_sleep_stress': 8.0, 'avg_spo2': 97.0, 'lowest_spo2': 90, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 115152)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,118 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745712068000, 'day': datetime.date(2025, 4, 27), 'sleep_start': datetime.datetime(2025, 4, 27, 4, 1, 8), 'sleep_end': datetime.datetime(2025, 4, 27, 9, 52, 8), 'sleep_duration_seconds': 20280, 'deep_sleep_seconds': 2640, 'light_sleep_seconds': 11160, 'rem_sleep_seconds': 6480, 'awake_seconds': 780, 'nap_duration_seconds': 0, 'sleep_score': 71, 'avg_sleep_stress': 7.0, 'avg_spo2': 98.0, 'lowest_spo2': 96, 'highest_spo2': 99, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 117220)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,121 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745789400000, 'day': datetime.date(2025, 4, 28), 'sleep_start': datetime.datetime(2025, 4, 28, 1, 30), 'sleep_end': datetime.datetime(2025, 4, 28, 10, 0), 'sleep_duration_seconds': 24420, 'deep_sleep_seconds': 4260, 'light_sleep_seconds': 16500, 'rem_sleep_seconds': 3660, 'awake_seconds': 1920, 'nap_duration_seconds': 0, 'sleep_score': 75, 'avg_sleep_stress': 13.0, 'avg_spo2': 98.0, 'lowest_spo2': 93, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 119643)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,122 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745877568000, 'day': datetime.date(2025, 4, 29), 'sleep_start': datetime.datetime(2025, 4, 29, 1, 59, 28), 'sleep_end': datetime.datetime(2025, 4, 29, 9, 2, 28), 'sleep_duration_seconds': 25020, 'deep_sleep_seconds': 3840, 'light_sleep_seconds': 15600, 'rem_sleep_seconds': 5580, 'awake_seconds': 360, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 20.0, 'avg_spo2': 96.0, 'lowest_spo2': 89, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 122656)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,127 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745962749000, 'day': datetime.date(2025, 4, 30), 'sleep_start': datetime.datetime(2025, 4, 30, 1, 39, 9), 'sleep_end': datetime.datetime(2025, 4, 30, 8, 14, 9), 'sleep_duration_seconds': 20940, 'deep_sleep_seconds': 4140, 'light_sleep_seconds': 12840, 'rem_sleep_seconds': 3960, 'awake_seconds': 1800, 'nap_duration_seconds': 0, 'sleep_score': 72, 'avg_sleep_stress': 13.0, 'avg_spo2': 96.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 126545)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,129 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746065542000, 'day': datetime.date(2025, 5, 1), 'sleep_start': datetime.datetime(2025, 5, 1, 6, 12, 22), 'sleep_end': datetime.datetime(2025, 5, 1, 9, 51, 22), 'sleep_duration_seconds': 13020, 'deep_sleep_seconds': 3900, 'light_sleep_seconds': 9120, 'rem_sleep_seconds': 0, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 38, 'avg_sleep_stress': 31.0, 'avg_spo2': 95.0, 'lowest_spo2': 93, 'highest_spo2': 96, 'avg_respiration': 13.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 128065)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,131 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746145611000, 'day': datetime.date(2025, 5, 2), 'sleep_start': datetime.datetime(2025, 5, 2, 4, 26, 51), 'sleep_end': datetime.datetime(2025, 5, 2, 12, 19, 16), 'sleep_duration_seconds': 27805, 'deep_sleep_seconds': 11460, 'light_sleep_seconds': 10500, 'rem_sleep_seconds': 5880, 'awake_seconds': 540, 'nap_duration_seconds': 0, 'sleep_score': 92, 'avg_sleep_stress': 10.0, 'avg_spo2': 98.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 130645)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,134 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746245954000, 'day': datetime.date(2025, 5, 3), 'sleep_start': datetime.datetime(2025, 5, 3, 8, 19, 14), 'sleep_end': datetime.datetime(2025, 5, 3, 11, 25, 14), 'sleep_duration_seconds': 8640, 'deep_sleep_seconds': 2580, 'light_sleep_seconds': 6060, 'rem_sleep_seconds': 0, 'awake_seconds': 2520, 'nap_duration_seconds': 0, 'sleep_score': 30, 'avg_sleep_stress': 15.0, 'avg_spo2': 98.0, 'lowest_spo2': 97, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 133156)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,136 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746315310000, 'day': datetime.date(2025, 5, 4), 'sleep_start': datetime.datetime(2025, 5, 4, 3, 35, 10), 'sleep_end': datetime.datetime(2025, 5, 4, 9, 18, 10), 'sleep_duration_seconds': 19860, 'deep_sleep_seconds': 3780, 'light_sleep_seconds': 15480, 'rem_sleep_seconds': 600, 'awake_seconds': 720, 'nap_duration_seconds': 1020, 'sleep_score': 57, 'avg_sleep_stress': 20.0, 'avg_spo2': 96.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 13.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 136205)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,138 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746393807000, 'day': datetime.date(2025, 5, 5), 'sleep_start': datetime.datetime(2025, 5, 5, 1, 23, 27), 'sleep_end': datetime.datetime(2025, 5, 5, 10, 0, 11), 'sleep_duration_seconds': 25784, 'deep_sleep_seconds': 7260, 'light_sleep_seconds': 14400, 'rem_sleep_seconds': 4140, 'awake_seconds': 960, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 8.0, 'avg_spo2': 96.0, 'lowest_spo2': 88, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 138947)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,142 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746484955000, 'day': datetime.date(2025, 5, 6), 'sleep_start': datetime.datetime(2025, 5, 6, 2, 42, 35), 'sleep_end': datetime.datetime(2025, 5, 6, 10, 47, 35), 'sleep_duration_seconds': 27720, 'deep_sleep_seconds': 3960, 'light_sleep_seconds': 18060, 'rem_sleep_seconds': 5700, 'awake_seconds': 1380, 'nap_duration_seconds': 0, 'sleep_score': 87, 'avg_sleep_stress': 7.0, 'avg_spo2': 94.0, 'lowest_spo2': 82, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 141957)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,146 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746570026000, 'day': datetime.date(2025, 5, 7), 'sleep_start': datetime.datetime(2025, 5, 7, 2, 20, 26), 'sleep_end': datetime.datetime(2025, 5, 7, 9, 30, 26), 'sleep_duration_seconds': 25800, 'deep_sleep_seconds': 7440, 'light_sleep_seconds': 14340, 'rem_sleep_seconds': 4020, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 6.0, 'avg_spo2': 96.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 145017)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,148 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746657306000, 'day': datetime.date(2025, 5, 8), 'sleep_start': datetime.datetime(2025, 5, 8, 2, 35, 6), 'sleep_end': datetime.datetime(2025, 5, 8, 9, 20, 6), 'sleep_duration_seconds': 19500, 'deep_sleep_seconds': 3900, 'light_sleep_seconds': 9960, 'rem_sleep_seconds': 5640, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 71, 'avg_sleep_stress': 9.0, 'avg_spo2': 95.0, 'lowest_spo2': 87, 'highest_spo2': 98, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 148016)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,151 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746734697000, 'day': datetime.date(2025, 5, 9), 'sleep_start': datetime.datetime(2025, 5, 9, 0, 4, 57), 'sleep_end': datetime.datetime(2025, 5, 9, 8, 25, 57), 'sleep_duration_seconds': 28620, 'deep_sleep_seconds': 7620, 'light_sleep_seconds': 15420, 'rem_sleep_seconds': 5580, 'awake_seconds': 1440, 'nap_duration_seconds': 0, 'sleep_score': 89, 'avg_sleep_stress': 11.0, 'avg_spo2': 97.0, 'lowest_spo2': 91, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 150543)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,155 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746822600000, 'day': datetime.date(2025, 5, 10), 'sleep_start': datetime.datetime(2025, 5, 10, 0, 30), 'sleep_end': datetime.datetime(2025, 5, 10, 9, 45), 'sleep_duration_seconds': 31860, 'deep_sleep_seconds': 3600, 'light_sleep_seconds': 24540, 'rem_sleep_seconds': 3720, 'awake_seconds': 1440, 'nap_duration_seconds': 0, 'sleep_score': 80, 'avg_sleep_stress': 10.0, 'avg_spo2': 96.0, 'lowest_spo2': 85, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 154548)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,158 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746910500000, 'day': datetime.date(2025, 5, 11), 'sleep_start': datetime.datetime(2025, 5, 11, 0, 55), 'sleep_end': datetime.datetime(2025, 5, 11, 7, 15), 'sleep_duration_seconds': 21060, 'deep_sleep_seconds': 5220, 'light_sleep_seconds': 13860, 'rem_sleep_seconds': 1980, 'awake_seconds': 1740, 'nap_duration_seconds': 4260, 'sleep_score': 69, 'avg_sleep_stress': 7.0, 'avg_spo2': 96.0, 'lowest_spo2': 93, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 158103)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,161 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747002660000, 'day': datetime.date(2025, 5, 12), 'sleep_start': datetime.datetime(2025, 5, 12, 2, 31), 'sleep_end': datetime.datetime(2025, 5, 12, 10, 0), 'sleep_duration_seconds': 26460, 'deep_sleep_seconds': 4380, 'light_sleep_seconds': 19200, 'rem_sleep_seconds': 2880, 'awake_seconds': 480, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 10.0, 'avg_spo2': 96.0, 'lowest_spo2': 91, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 430, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 161172)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,165 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747080000000, 'day': datetime.date(2025, 5, 13), 'sleep_start': datetime.datetime(2025, 5, 13, 0, 0), 'sleep_end': datetime.datetime(2025, 5, 13, 9, 59), 'sleep_duration_seconds': 32280, 'deep_sleep_seconds': 5040, 'light_sleep_seconds': 18600, 'rem_sleep_seconds': 8640, 'awake_seconds': 3660, 'nap_duration_seconds': 0, 'sleep_score': 61, 'avg_sleep_stress': 17.0, 'avg_spo2': 96.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 5, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 164174)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,168 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747169104000, 'day': datetime.date(2025, 5, 14), 'sleep_start': datetime.datetime(2025, 5, 14, 0, 45, 4), 'sleep_end': datetime.datetime(2025, 5, 14, 10, 6, 4), 'sleep_duration_seconds': 29340, 'deep_sleep_seconds': 6180, 'light_sleep_seconds': 19080, 'rem_sleep_seconds': 4080, 'awake_seconds': 2940, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 14.0, 'avg_spo2': 97.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 167395)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,170 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747281135000, 'day': datetime.date(2025, 5, 15), 'sleep_start': datetime.datetime(2025, 5, 15, 7, 52, 15), 'sleep_end': datetime.datetime(2025, 5, 15, 14, 57, 15), 'sleep_duration_seconds': 21840, 'deep_sleep_seconds': 6480, 'light_sleep_seconds': 12060, 'rem_sleep_seconds': 3300, 'awake_seconds': 2640, 'nap_duration_seconds': 0, 'sleep_score': 68, 'avg_sleep_stress': 21.0, 'avg_spo2': 96.0, 'lowest_spo2': 95, 'highest_spo2': 97, 'avg_respiration': 12.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 169428)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,174 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747341497000, 'day': datetime.date(2025, 5, 16), 'sleep_start': datetime.datetime(2025, 5, 16, 0, 38, 17), 'sleep_end': datetime.datetime(2025, 5, 16, 10, 44, 17), 'sleep_duration_seconds': 31920, 'deep_sleep_seconds': 4980, 'light_sleep_seconds': 15480, 'rem_sleep_seconds': 11460, 'awake_seconds': 540, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 9.0, 'avg_spo2': 96.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 173954)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,176 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747452967000, 'day': datetime.date(2025, 5, 17), 'sleep_start': datetime.datetime(2025, 5, 17, 7, 36, 7), 'sleep_end': datetime.datetime(2025, 5, 17, 12, 11, 7), 'sleep_duration_seconds': 16500, 'deep_sleep_seconds': 5520, 'light_sleep_seconds': 9840, 'rem_sleep_seconds': 1140, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 53, 'avg_sleep_stress': 27.0, 'avg_spo2': 96.0, 'lowest_spo2': 94, 'highest_spo2': 100, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 450, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 175958)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,176 - WARNING - No sleep ID found for 2025-05-18
2025-08-05 19:48:49,181 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747581533000, 'day': datetime.date(2025, 5, 19), 'sleep_start': datetime.datetime(2025, 5, 18, 19, 18, 53), 'sleep_end': datetime.datetime(2025, 5, 19, 10, 58, 53), 'sleep_duration_seconds': 47760, 'deep_sleep_seconds': 7020, 'light_sleep_seconds': 26520, 'rem_sleep_seconds': 14220, 'awake_seconds': 5760, 'nap_duration_seconds': 0, 'sleep_score': 73, 'avg_sleep_stress': 8.0, 'avg_spo2': 97.0, 'lowest_spo2': 93, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 179743)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,184 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747689773000, 'day': datetime.date(2025, 5, 20), 'sleep_start': datetime.datetime(2025, 5, 20, 1, 22, 53), 'sleep_end': datetime.datetime(2025, 5, 20, 10, 38, 53), 'sleep_duration_seconds': 32040, 'deep_sleep_seconds': 5700, 'light_sleep_seconds': 18120, 'rem_sleep_seconds': 8220, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 92, 'avg_sleep_stress': 15.0, 'avg_spo2': 98.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 183255)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,187 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747774049000, 'day': datetime.date(2025, 5, 21), 'sleep_start': datetime.datetime(2025, 5, 21, 0, 47, 29), 'sleep_end': datetime.datetime(2025, 5, 21, 9, 14, 29), 'sleep_duration_seconds': 30420, 'deep_sleep_seconds': 10260, 'light_sleep_seconds': 13860, 'rem_sleep_seconds': 6300, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 95, 'avg_sleep_stress': 7.0, 'avg_spo2': 95.0, 'lowest_spo2': 88, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 186255)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,189 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747864719000, 'day': datetime.date(2025, 5, 22), 'sleep_start': datetime.datetime(2025, 5, 22, 1, 58, 39), 'sleep_end': datetime.datetime(2025, 5, 22, 9, 44, 8), 'sleep_duration_seconds': 27569, 'deep_sleep_seconds': 9840, 'light_sleep_seconds': 12420, 'rem_sleep_seconds': 5340, 'awake_seconds': 360, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 13.0, 'avg_spo2': 96.0, 'lowest_spo2': 88, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 450, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 189833)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,192 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747951291000, 'day': datetime.date(2025, 5, 23), 'sleep_start': datetime.datetime(2025, 5, 23, 2, 1, 31), 'sleep_end': datetime.datetime(2025, 5, 23, 7, 20, 31), 'sleep_duration_seconds': 17400, 'deep_sleep_seconds': 4200, 'light_sleep_seconds': 9180, 'rem_sleep_seconds': 4020, 'awake_seconds': 540, 'nap_duration_seconds': 0, 'sleep_score': 66, 'avg_sleep_stress': 20.0, 'avg_spo2': 97.0, 'lowest_spo2': 91, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 192417)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,193 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748053245000, 'day': datetime.date(2025, 5, 24), 'sleep_start': datetime.datetime(2025, 5, 24, 6, 20, 45), 'sleep_end': datetime.datetime(2025, 5, 24, 10, 32, 45), 'sleep_duration_seconds': 15120, 'deep_sleep_seconds': 3060, 'light_sleep_seconds': 12060, 'rem_sleep_seconds': 0, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 34, 'avg_sleep_stress': 82.0, 'avg_spo2': 94.0, 'lowest_spo2': 92, 'highest_spo2': 96, 'avg_respiration': 15.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 193417)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,193 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748141753000, 'day': datetime.date(2025, 5, 25), 'sleep_start': datetime.datetime(2025, 5, 25, 6, 55, 53), 'sleep_end': datetime.datetime(2025, 5, 25, 11, 0, 53), 'sleep_duration_seconds': 14700, 'deep_sleep_seconds': 5100, 'light_sleep_seconds': 8940, 'rem_sleep_seconds': 660, 'awake_seconds': 0, 'nap_duration_seconds': 1260, 'sleep_score': 35, 'avg_sleep_stress': 47.0, 'avg_spo2': 94.0, 'lowest_spo2': 91, 'highest_spo2': 97, 'avg_respiration': 13.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 193417)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,199 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748199732000, 'day': datetime.date(2025, 5, 26), 'sleep_start': datetime.datetime(2025, 5, 25, 23, 2, 12), 'sleep_end': datetime.datetime(2025, 5, 26, 10, 38, 12), 'sleep_duration_seconds': 30780, 'deep_sleep_seconds': 3900, 'light_sleep_seconds': 18840, 'rem_sleep_seconds': 8040, 'awake_seconds': 10980, 'nap_duration_seconds': 2280, 'sleep_score': 54, 'avg_sleep_stress': 39.0, 'avg_spo2': 95.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 15.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 199835)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,203 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748291666000, 'day': datetime.date(2025, 5, 27), 'sleep_start': datetime.datetime(2025, 5, 27, 0, 34, 26), 'sleep_end': datetime.datetime(2025, 5, 27, 10, 8, 26), 'sleep_duration_seconds': 34140, 'deep_sleep_seconds': 4440, 'light_sleep_seconds': 21480, 'rem_sleep_seconds': 8220, 'awake_seconds': 300, 'nap_duration_seconds': 0, 'sleep_score': 91, 'avg_sleep_stress': 8.0, 'avg_spo2': 94.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 203913)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,207 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748379443000, 'day': datetime.date(2025, 5, 28), 'sleep_start': datetime.datetime(2025, 5, 28, 0, 57, 23), 'sleep_end': datetime.datetime(2025, 5, 28, 9, 22, 23), 'sleep_duration_seconds': 30240, 'deep_sleep_seconds': 5880, 'light_sleep_seconds': 16620, 'rem_sleep_seconds': 7740, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 96, 'avg_sleep_stress': 8.0, 'avg_spo2': 98.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 206981)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,210 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748464163000, 'day': datetime.date(2025, 5, 29), 'sleep_start': datetime.datetime(2025, 5, 29, 0, 29, 23), 'sleep_end': datetime.datetime(2025, 5, 29, 10, 21, 23), 'sleep_duration_seconds': 34140, 'deep_sleep_seconds': 7560, 'light_sleep_seconds': 17400, 'rem_sleep_seconds': 9180, 'awake_seconds': 1380, 'nap_duration_seconds': 0, 'sleep_score': 94, 'avg_sleep_stress': 11.0, 'avg_spo2': 96.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 210596)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,214 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748552368000, 'day': datetime.date(2025, 5, 30), 'sleep_start': datetime.datetime(2025, 5, 30, 0, 59, 28), 'sleep_end': datetime.datetime(2025, 5, 30, 8, 51, 28), 'sleep_duration_seconds': 27540, 'deep_sleep_seconds': 6780, 'light_sleep_seconds': 16560, 'rem_sleep_seconds': 4200, 'awake_seconds': 780, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 12.0, 'avg_spo2': 97.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 213103)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,217 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-31.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748638395000, 'day': datetime.date(2025, 5, 31), 'sleep_start': datetime.datetime(2025, 5, 31, 0, 53, 15), 'sleep_end': datetime.datetime(2025, 5, 31, 10, 14, 15), 'sleep_duration_seconds': 30840, 'deep_sleep_seconds': 2700, 'light_sleep_seconds': 21840, 'rem_sleep_seconds': 6300, 'awake_seconds': 2820, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 9.0, 'avg_spo2': 95.0, 'lowest_spo2': 83, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 217165)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,219 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748728865000, 'day': datetime.date(2025, 6, 1), 'sleep_start': datetime.datetime(2025, 6, 1, 2, 1, 5), 'sleep_end': datetime.datetime(2025, 6, 1, 8, 23, 5), 'sleep_duration_seconds': 22140, 'deep_sleep_seconds': 4860, 'light_sleep_seconds': 15000, 'rem_sleep_seconds': 2280, 'awake_seconds': 780, 'nap_duration_seconds': 0, 'sleep_score': 74, 'avg_sleep_stress': 15.0, 'avg_spo2': 96.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 219190)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,223 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748818253000, 'day': datetime.date(2025, 6, 2), 'sleep_start': datetime.datetime(2025, 6, 2, 2, 50, 53), 'sleep_end': datetime.datetime(2025, 6, 2, 9, 36, 53), 'sleep_duration_seconds': 21840, 'deep_sleep_seconds': 7860, 'light_sleep_seconds': 11220, 'rem_sleep_seconds': 2760, 'awake_seconds': 2520, 'nap_duration_seconds': 0, 'sleep_score': 67, 'avg_sleep_stress': 22.0, 'avg_spo2': 97.0, 'lowest_spo2': 94, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 222821)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,226 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748896866000, 'day': datetime.date(2025, 6, 3), 'sleep_start': datetime.datetime(2025, 6, 3, 0, 41, 6), 'sleep_end': datetime.datetime(2025, 6, 3, 8, 38, 6), 'sleep_duration_seconds': 28380, 'deep_sleep_seconds': 3600, 'light_sleep_seconds': 18480, 'rem_sleep_seconds': 6300, 'awake_seconds': 240, 'nap_duration_seconds': 0, 'sleep_score': 92, 'avg_sleep_stress': 10.0, 'avg_spo2': 97.0, 'lowest_spo2': 91, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 226328)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,229 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748985359000, 'day': datetime.date(2025, 6, 4), 'sleep_start': datetime.datetime(2025, 6, 4, 1, 15, 59), 'sleep_end': datetime.datetime(2025, 6, 4, 8, 42, 59), 'sleep_duration_seconds': 26580, 'deep_sleep_seconds': 4500, 'light_sleep_seconds': 15600, 'rem_sleep_seconds': 6480, 'awake_seconds': 240, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 11.0, 'avg_spo2': 96.0, 'lowest_spo2': 90, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 229665)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,233 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749070242000, 'day': datetime.date(2025, 6, 5), 'sleep_start': datetime.datetime(2025, 6, 5, 0, 50, 42), 'sleep_end': datetime.datetime(2025, 6, 5, 9, 45, 42), 'sleep_duration_seconds': 31680, 'deep_sleep_seconds': 7860, 'light_sleep_seconds': 16560, 'rem_sleep_seconds': 7260, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 89, 'avg_sleep_stress': 19.0, 'avg_spo2': 94.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 232264)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,235 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749161528000, 'day': datetime.date(2025, 6, 6), 'sleep_start': datetime.datetime(2025, 6, 6, 2, 12, 8), 'sleep_end': datetime.datetime(2025, 6, 6, 9, 11, 8), 'sleep_duration_seconds': 24840, 'deep_sleep_seconds': 3840, 'light_sleep_seconds': 15660, 'rem_sleep_seconds': 5340, 'awake_seconds': 300, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 10.0, 'avg_spo2': 96.0, 'lowest_spo2': 88, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 234270)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,239 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749246703000, 'day': datetime.date(2025, 6, 7), 'sleep_start': datetime.datetime(2025, 6, 7, 1, 51, 43), 'sleep_end': datetime.datetime(2025, 6, 7, 9, 46, 43), 'sleep_duration_seconds': 28380, 'deep_sleep_seconds': 2940, 'light_sleep_seconds': 22500, 'rem_sleep_seconds': 2940, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 7.0, 'avg_spo2': 95.0, 'lowest_spo2': 89, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 238701)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,241 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749337276000, 'day': datetime.date(2025, 6, 8), 'sleep_start': datetime.datetime(2025, 6, 8, 3, 1, 16), 'sleep_end': datetime.datetime(2025, 6, 8, 9, 46, 16), 'sleep_duration_seconds': 23880, 'deep_sleep_seconds': 4740, 'light_sleep_seconds': 14760, 'rem_sleep_seconds': 4380, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 82, 'avg_sleep_stress': 7.0, 'avg_spo2': 92.0, 'lowest_spo2': 83, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 241289)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,244 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749423995000, 'day': datetime.date(2025, 6, 9), 'sleep_start': datetime.datetime(2025, 6, 9, 3, 6, 35), 'sleep_end': datetime.datetime(2025, 6, 9, 9, 43, 58), 'sleep_duration_seconds': 20243, 'deep_sleep_seconds': 1260, 'light_sleep_seconds': 15300, 'rem_sleep_seconds': 3720, 'awake_seconds': 2220, 'nap_duration_seconds': 0, 'sleep_score': 67, 'avg_sleep_stress': 5.0, 'avg_spo2': 96.0, 'lowest_spo2': 90, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 243798)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,248 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749503773000, 'day': datetime.date(2025, 6, 10), 'sleep_start': datetime.datetime(2025, 6, 10, 1, 16, 13), 'sleep_end': datetime.datetime(2025, 6, 10, 8, 37, 45), 'sleep_duration_seconds': 20912, 'deep_sleep_seconds': 2880, 'light_sleep_seconds': 14220, 'rem_sleep_seconds': 3840, 'awake_seconds': 4740, 'nap_duration_seconds': 0, 'sleep_score': 57, 'avg_sleep_stress': 23.0, 'avg_spo2': 96.0, 'lowest_spo2': 88, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 4, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 247383)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,251 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749590518000, 'day': datetime.date(2025, 6, 11), 'sleep_start': datetime.datetime(2025, 6, 11, 1, 21, 58), 'sleep_end': datetime.datetime(2025, 6, 11, 9, 55, 57), 'sleep_duration_seconds': 28979, 'deep_sleep_seconds': 7320, 'light_sleep_seconds': 15000, 'rem_sleep_seconds': 6660, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 98, 'avg_sleep_stress': 7.0, 'avg_spo2': 96.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 250897)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,254 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749674446000, 'day': datetime.date(2025, 6, 12), 'sleep_start': datetime.datetime(2025, 6, 12, 0, 40, 46), 'sleep_end': datetime.datetime(2025, 6, 12, 8, 43, 46), 'sleep_duration_seconds': 27420, 'deep_sleep_seconds': 3960, 'light_sleep_seconds': 15600, 'rem_sleep_seconds': 7860, 'awake_seconds': 1560, 'nap_duration_seconds': 0, 'sleep_score': 87, 'avg_sleep_stress': 11.0, 'avg_spo2': 98.0, 'lowest_spo2': 89, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 253935)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,256 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749760856000, 'day': datetime.date(2025, 6, 13), 'sleep_start': datetime.datetime(2025, 6, 13, 0, 40, 56), 'sleep_end': datetime.datetime(2025, 6, 13, 9, 51, 32), 'sleep_duration_seconds': 32676, 'deep_sleep_seconds': 7620, 'light_sleep_seconds': 18480, 'rem_sleep_seconds': 6600, 'awake_seconds': 360, 'nap_duration_seconds': 0, 'sleep_score': 93, 'avg_sleep_stress': 6.0, 'avg_spo2': 96.0, 'lowest_spo2': 89, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 256939)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,261 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749852092000, 'day': datetime.date(2025, 6, 14), 'sleep_start': datetime.datetime(2025, 6, 14, 2, 1, 32), 'sleep_end': datetime.datetime(2025, 6, 14, 9, 1, 32), 'sleep_duration_seconds': 25020, 'deep_sleep_seconds': 7680, 'light_sleep_seconds': 13200, 'rem_sleep_seconds': 4140, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 9.0, 'avg_spo2': 96.0, 'lowest_spo2': 85, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 260689)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,264 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749940119000, 'day': datetime.date(2025, 6, 15), 'sleep_start': datetime.datetime(2025, 6, 15, 2, 28, 39), 'sleep_end': datetime.datetime(2025, 6, 15, 9, 42, 39), 'sleep_duration_seconds': 24060, 'deep_sleep_seconds': 3540, 'light_sleep_seconds': 16080, 'rem_sleep_seconds': 4440, 'awake_seconds': 1980, 'nap_duration_seconds': 0, 'sleep_score': 73, 'avg_sleep_stress': 19.0, 'avg_spo2': 98.0, 'lowest_spo2': 91, 'highest_spo2': 100, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 263796)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,267 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750025663000, 'day': datetime.date(2025, 6, 16), 'sleep_start': datetime.datetime(2025, 6, 16, 2, 14, 23), 'sleep_end': datetime.datetime(2025, 6, 16, 9, 21, 3), 'sleep_duration_seconds': 25540, 'deep_sleep_seconds': 8280, 'light_sleep_seconds': 12420, 'rem_sleep_seconds': 4860, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 10.0, 'avg_spo2': 97.0, 'lowest_spo2': 91, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 266964)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,271 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750108902000, 'day': datetime.date(2025, 6, 17), 'sleep_start': datetime.datetime(2025, 6, 17, 1, 21, 42), 'sleep_end': datetime.datetime(2025, 6, 17, 9, 24, 42), 'sleep_duration_seconds': 27660, 'deep_sleep_seconds': 7020, 'light_sleep_seconds': 14700, 'rem_sleep_seconds': 5940, 'awake_seconds': 1320, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 9.0, 'avg_spo2': 97.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 270630)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,274 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750198018000, 'day': datetime.date(2025, 6, 18), 'sleep_start': datetime.datetime(2025, 6, 18, 2, 6, 58), 'sleep_end': datetime.datetime(2025, 6, 18, 9, 28, 58), 'sleep_duration_seconds': 26160, 'deep_sleep_seconds': 9180, 'light_sleep_seconds': 10560, 'rem_sleep_seconds': 6420, 'awake_seconds': 360, 'nap_duration_seconds': 0, 'sleep_score': 89, 'avg_sleep_stress': 8.0, 'avg_spo2': 96.0, 'lowest_spo2': 90, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 273650)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,278 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750276813000, 'day': datetime.date(2025, 6, 19), 'sleep_start': datetime.datetime(2025, 6, 19, 0, 0, 13), 'sleep_end': datetime.datetime(2025, 6, 19, 9, 35, 5), 'sleep_duration_seconds': 32092, 'deep_sleep_seconds': 7080, 'light_sleep_seconds': 18660, 'rem_sleep_seconds': 6360, 'awake_seconds': 2400, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 14.0, 'avg_spo2': 93.0, 'lowest_spo2': 82, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 276653)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,280 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750366937000, 'day': datetime.date(2025, 6, 20), 'sleep_start': datetime.datetime(2025, 6, 20, 1, 2, 17), 'sleep_end': datetime.datetime(2025, 6, 20, 6, 45, 17), 'sleep_duration_seconds': 17700, 'deep_sleep_seconds': 3420, 'light_sleep_seconds': 9660, 'rem_sleep_seconds': 4620, 'awake_seconds': 1980, 'nap_duration_seconds': 0, 'sleep_score': 63, 'avg_sleep_stress': 10.0, 'avg_spo2': 96.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 280669)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,284 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750450438000, 'day': datetime.date(2025, 6, 21), 'sleep_start': datetime.datetime(2025, 6, 21, 0, 13, 58), 'sleep_end': datetime.datetime(2025, 6, 21, 9, 26, 58), 'sleep_duration_seconds': 30960, 'deep_sleep_seconds': 8340, 'light_sleep_seconds': 20280, 'rem_sleep_seconds': 2340, 'awake_seconds': 2220, 'nap_duration_seconds': 0, 'sleep_score': 72, 'avg_sleep_stress': 20.0, 'avg_spo2': 97.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 284173)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,284 - WARNING - No sleep ID found for 2025-06-22
2025-08-05 19:48:49,288 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750624404000, 'day': datetime.date(2025, 6, 23), 'sleep_start': datetime.datetime(2025, 6, 23, 0, 33, 24), 'sleep_end': datetime.datetime(2025, 6, 23, 9, 38, 39), 'sleep_duration_seconds': 30195, 'deep_sleep_seconds': 7200, 'light_sleep_seconds': 18180, 'rem_sleep_seconds': 4860, 'awake_seconds': 2520, 'nap_duration_seconds': 0, 'sleep_score': 77, 'avg_sleep_stress': 22.0, 'avg_spo2': 95.0, 'lowest_spo2': 88, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 286713)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,290 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750712650000, 'day': datetime.date(2025, 6, 24), 'sleep_start': datetime.datetime(2025, 6, 24, 1, 4, 10), 'sleep_end': datetime.datetime(2025, 6, 24, 10, 30, 10), 'sleep_duration_seconds': 32340, 'deep_sleep_seconds': 4080, 'light_sleep_seconds': 22320, 'rem_sleep_seconds': 5940, 'awake_seconds': 1620, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 12.0, 'avg_spo2': 97.0, 'lowest_spo2': 90, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 290728)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,294 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750803056000, 'day': datetime.date(2025, 6, 25), 'sleep_start': datetime.datetime(2025, 6, 25, 2, 10, 56), 'sleep_end': datetime.datetime(2025, 6, 25, 10, 9, 56), 'sleep_duration_seconds': 28500, 'deep_sleep_seconds': 3540, 'light_sleep_seconds': 19200, 'rem_sleep_seconds': 5760, 'awake_seconds': 240, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 8.0, 'avg_spo2': 97.0, 'lowest_spo2': 88, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 293004)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,294 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750884382000, 'day': datetime.date(2025, 6, 26), 'sleep_start': datetime.datetime(2025, 6, 26, 0, 46, 22), 'sleep_end': datetime.datetime(2025, 6, 26, 9, 42, 22), 'sleep_duration_seconds': 30600, 'deep_sleep_seconds': 7260, 'light_sleep_seconds': 16260, 'rem_sleep_seconds': 7080, 'awake_seconds': 1560, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 22.0, 'avg_spo2': 98.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 294508)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,299 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750983023000, 'day': datetime.date(2025, 6, 27), 'sleep_start': datetime.datetime(2025, 6, 27, 4, 10, 23), 'sleep_end': datetime.datetime(2025, 6, 27, 8, 42, 23), 'sleep_duration_seconds': 15900, 'deep_sleep_seconds': 7620, 'light_sleep_seconds': 6000, 'rem_sleep_seconds': 2280, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 56, 'avg_sleep_stress': 18.0, 'avg_spo2': 95.0, 'lowest_spo2': 89, 'highest_spo2': 99, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 299276)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,299 - WARNING - No sleep ID found for 2025-06-28
2025-08-05 19:48:49,299 - WARNING - No sleep ID found for 2025-06-29
2025-08-05 19:48:49,299 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751246322000, 'day': datetime.date(2025, 6, 30), 'sleep_start': datetime.datetime(2025, 6, 30, 5, 18, 42), 'sleep_end': datetime.datetime(2025, 6, 30, 9, 1, 42), 'sleep_duration_seconds': 13380, 'deep_sleep_seconds': 5580, 'light_sleep_seconds': 6360, 'rem_sleep_seconds': 1440, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 49, 'avg_sleep_stress': 11.0, 'avg_spo2': 95.0, 'lowest_spo2': 88, 'highest_spo2': 99, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 299276)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,306 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751318502000, 'day': datetime.date(2025, 7, 1), 'sleep_start': datetime.datetime(2025, 7, 1, 1, 21, 42), 'sleep_end': datetime.datetime(2025, 7, 1, 11, 46), 'sleep_duration_seconds': 37038, 'deep_sleep_seconds': 6060, 'light_sleep_seconds': 20100, 'rem_sleep_seconds': 10920, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 92, 'avg_sleep_stress': 12.0, 'avg_spo2': 97.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 306538)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,310 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751404059000, 'day': datetime.date(2025, 7, 2), 'sleep_start': datetime.datetime(2025, 7, 2, 1, 7, 39), 'sleep_end': datetime.datetime(2025, 7, 2, 11, 18, 39), 'sleep_duration_seconds': 36540, 'deep_sleep_seconds': 8100, 'light_sleep_seconds': 18900, 'rem_sleep_seconds': 9540, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 97, 'avg_sleep_stress': 12.0, 'avg_spo2': 96.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 309547)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,313 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751493270000, 'day': datetime.date(2025, 7, 3), 'sleep_start': datetime.datetime(2025, 7, 3, 1, 54, 30), 'sleep_end': datetime.datetime(2025, 7, 3, 4, 54, 30), 'sleep_duration_seconds': 10800, 'deep_sleep_seconds': 6120, 'light_sleep_seconds': 3900, 'rem_sleep_seconds': 780, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 40, 'avg_sleep_stress': 16.0, 'avg_spo2': 96.0, 'lowest_spo2': 92, 'highest_spo2': 99, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 430, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 312550)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,317 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751573120000, 'day': datetime.date(2025, 7, 4), 'sleep_start': datetime.datetime(2025, 7, 4, 0, 5, 20), 'sleep_end': datetime.datetime(2025, 7, 4, 10, 38, 20), 'sleep_duration_seconds': 37140, 'deep_sleep_seconds': 6840, 'light_sleep_seconds': 18600, 'rem_sleep_seconds': 11700, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 13.0, 'avg_spo2': 95.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 316120)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,320 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751679987000, 'day': datetime.date(2025, 7, 5), 'sleep_start': datetime.datetime(2025, 7, 5, 5, 46, 27), 'sleep_end': datetime.datetime(2025, 7, 5, 11, 5, 27), 'sleep_duration_seconds': 18480, 'deep_sleep_seconds': 3660, 'light_sleep_seconds': 11760, 'rem_sleep_seconds': 3060, 'awake_seconds': 660, 'nap_duration_seconds': 4560, 'sleep_score': 50, 'avg_sleep_stress': 41.0, 'avg_spo2': 94.0, 'lowest_spo2': 91, 'highest_spo2': 96, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 319127)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,323 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751754972000, 'day': datetime.date(2025, 7, 6), 'sleep_start': datetime.datetime(2025, 7, 6, 2, 36, 12), 'sleep_end': datetime.datetime(2025, 7, 6, 10, 11, 12), 'sleep_duration_seconds': 27060, 'deep_sleep_seconds': 7680, 'light_sleep_seconds': 10740, 'rem_sleep_seconds': 8640, 'awake_seconds': 240, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 14.0, 'avg_spo2': 95.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 323289)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,325 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751833584000, 'day': datetime.date(2025, 7, 7), 'sleep_start': datetime.datetime(2025, 7, 7, 0, 26, 24), 'sleep_end': datetime.datetime(2025, 7, 7, 9, 0, 18), 'sleep_duration_seconds': 30234, 'deep_sleep_seconds': 5700, 'light_sleep_seconds': 16740, 'rem_sleep_seconds': 7800, 'awake_seconds': 600, 'nap_duration_seconds': 0, 'sleep_score': 96, 'avg_sleep_stress': 9.0, 'avg_spo2': 96.0, 'lowest_spo2': 94, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 325796)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,330 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751922151000, 'day': datetime.date(2025, 7, 8), 'sleep_start': datetime.datetime(2025, 7, 8, 1, 2, 31), 'sleep_end': datetime.datetime(2025, 7, 8, 8, 32, 7), 'sleep_duration_seconds': 26976, 'deep_sleep_seconds': 3540, 'light_sleep_seconds': 16200, 'rem_sleep_seconds': 7260, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 7.0, 'avg_spo2': 94.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 450, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 329337)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,333 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752008673000, 'day': datetime.date(2025, 7, 9), 'sleep_start': datetime.datetime(2025, 7, 9, 1, 4, 33), 'sleep_end': datetime.datetime(2025, 7, 9, 9, 18, 33), 'sleep_duration_seconds': 28080, 'deep_sleep_seconds': 6120, 'light_sleep_seconds': 19380, 'rem_sleep_seconds': 2580, 'awake_seconds': 1560, 'nap_duration_seconds': 0, 'sleep_score': 80, 'avg_sleep_stress': 5.0, 'avg_spo2': 94.0, 'lowest_spo2': 83, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 332180)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,336 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752092668000, 'day': datetime.date(2025, 7, 10), 'sleep_start': datetime.datetime(2025, 7, 10, 0, 24, 28), 'sleep_end': datetime.datetime(2025, 7, 10, 8, 22, 27), 'sleep_duration_seconds': 28079, 'deep_sleep_seconds': 5160, 'light_sleep_seconds': 14640, 'rem_sleep_seconds': 8280, 'awake_seconds': 600, 'nap_duration_seconds': 0, 'sleep_score': 95, 'avg_sleep_stress': 11.0, 'avg_spo2': 94.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 335690)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,339 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752182343000, 'day': datetime.date(2025, 7, 11), 'sleep_start': datetime.datetime(2025, 7, 11, 1, 19, 3), 'sleep_end': datetime.datetime(2025, 7, 11, 9, 40, 3), 'sleep_duration_seconds': 29580, 'deep_sleep_seconds': 5880, 'light_sleep_seconds': 17340, 'rem_sleep_seconds': 6360, 'awake_seconds': 480, 'nap_duration_seconds': 0, 'sleep_score': 96, 'avg_sleep_stress': 6.0, 'avg_spo2': 94.0, 'lowest_spo2': 85, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 339261)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,342 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752273639000, 'day': datetime.date(2025, 7, 12), 'sleep_start': datetime.datetime(2025, 7, 12, 2, 40, 39), 'sleep_end': datetime.datetime(2025, 7, 12, 10, 59, 39), 'sleep_duration_seconds': 24960, 'deep_sleep_seconds': 3060, 'light_sleep_seconds': 15480, 'rem_sleep_seconds': 6420, 'awake_seconds': 4980, 'nap_duration_seconds': 0, 'sleep_score': 61, 'avg_sleep_stress': 19.0, 'avg_spo2': 96.0, 'lowest_spo2': 91, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 4, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 342384)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,343 - WARNING - No sleep ID found for 2025-07-13
2025-08-05 19:48:49,346 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752441300000, 'day': datetime.date(2025, 7, 14), 'sleep_start': datetime.datetime(2025, 7, 14, 1, 15), 'sleep_end': datetime.datetime(2025, 7, 14, 10, 40), 'sleep_duration_seconds': 32280, 'deep_sleep_seconds': 3240, 'light_sleep_seconds': 25860, 'rem_sleep_seconds': 3180, 'awake_seconds': 300, 'nap_duration_seconds': 0, 'sleep_score': 61, 'avg_sleep_stress': 37.0, 'avg_spo2': 96.0, 'lowest_spo2': 85, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 345940)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,349 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752529731000, 'day': datetime.date(2025, 7, 15), 'sleep_start': datetime.datetime(2025, 7, 15, 1, 48, 51), 'sleep_end': datetime.datetime(2025, 7, 15, 9, 58, 51), 'sleep_duration_seconds': 27120, 'deep_sleep_seconds': 6240, 'light_sleep_seconds': 15120, 'rem_sleep_seconds': 5760, 'awake_seconds': 300, 'nap_duration_seconds': 0, 'sleep_score': 91, 'avg_sleep_stress': 10.0, 'avg_spo2': 94.0, 'lowest_spo2': 86, 'highest_spo2': 99, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 349749)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,353 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752617408000, 'day': datetime.date(2025, 7, 16), 'sleep_start': datetime.datetime(2025, 7, 16, 2, 10, 8), 'sleep_end': datetime.datetime(2025, 7, 16, 10, 1, 8), 'sleep_duration_seconds': 27300, 'deep_sleep_seconds': 9180, 'light_sleep_seconds': 11220, 'rem_sleep_seconds': 6900, 'awake_seconds': 960, 'nap_duration_seconds': 0, 'sleep_score': 89, 'avg_sleep_stress': 8.0, 'avg_spo2': 94.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 352281)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,356 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752698817000, 'day': datetime.date(2025, 7, 17), 'sleep_start': datetime.datetime(2025, 7, 17, 0, 46, 57), 'sleep_end': datetime.datetime(2025, 7, 17, 9, 53, 10), 'sleep_duration_seconds': 32233, 'deep_sleep_seconds': 9660, 'light_sleep_seconds': 13320, 'rem_sleep_seconds': 9300, 'awake_seconds': 540, 'nap_duration_seconds': 0, 'sleep_score': 99, 'avg_sleep_stress': 9.0, 'avg_spo2': 94.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 355284)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,358 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752786480000, 'day': datetime.date(2025, 7, 18), 'sleep_start': datetime.datetime(2025, 7, 18, 1, 8), 'sleep_end': datetime.datetime(2025, 7, 18, 9, 13, 58), 'sleep_duration_seconds': 28378, 'deep_sleep_seconds': 5460, 'light_sleep_seconds': 14580, 'rem_sleep_seconds': 8340, 'awake_seconds': 780, 'nap_duration_seconds': 0, 'sleep_score': 94, 'avg_sleep_stress': 7.0, 'avg_spo2': 94.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 450, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 358989)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,361 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752877518000, 'day': datetime.date(2025, 7, 19), 'sleep_start': datetime.datetime(2025, 7, 19, 2, 25, 18), 'sleep_end': datetime.datetime(2025, 7, 19, 9, 43, 18), 'sleep_duration_seconds': 24960, 'deep_sleep_seconds': 3660, 'light_sleep_seconds': 18360, 'rem_sleep_seconds': 2940, 'awake_seconds': 1320, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 6.0, 'avg_spo2': 95.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 361993)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,364 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752962019000, 'day': datetime.date(2025, 7, 20), 'sleep_start': datetime.datetime(2025, 7, 20, 1, 53, 39), 'sleep_end': datetime.datetime(2025, 7, 20, 8, 51, 39), 'sleep_duration_seconds': 24840, 'deep_sleep_seconds': 3900, 'light_sleep_seconds': 16020, 'rem_sleep_seconds': 4920, 'awake_seconds': 240, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 7.0, 'avg_spo2': 97.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 363995)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,369 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753044933000, 'day': datetime.date(2025, 7, 21), 'sleep_start': datetime.datetime(2025, 7, 21, 0, 55, 33), 'sleep_end': datetime.datetime(2025, 7, 21, 9, 30, 31), 'sleep_duration_seconds': 28378, 'deep_sleep_seconds': 7080, 'light_sleep_seconds': 13320, 'rem_sleep_seconds': 7980, 'awake_seconds': 1020, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 15.0, 'avg_spo2': 95.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 368075)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,372 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753134216000, 'day': datetime.date(2025, 7, 22), 'sleep_start': datetime.datetime(2025, 7, 22, 1, 43, 36), 'sleep_end': datetime.datetime(2025, 7, 22, 9, 2, 18), 'sleep_duration_seconds': 25902, 'deep_sleep_seconds': 4740, 'light_sleep_seconds': 17580, 'rem_sleep_seconds': 3600, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 7.0, 'avg_spo2': 94.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 371155)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,375 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753218356000, 'day': datetime.date(2025, 7, 23), 'sleep_start': datetime.datetime(2025, 7, 23, 1, 5, 56), 'sleep_end': datetime.datetime(2025, 7, 23, 9, 26, 56), 'sleep_duration_seconds': 28380, 'deep_sleep_seconds': 6960, 'light_sleep_seconds': 16800, 'rem_sleep_seconds': 4620, 'awake_seconds': 1680, 'nap_duration_seconds': 0, 'sleep_score': 87, 'avg_sleep_stress': 14.0, 'avg_spo2': 95.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 375155)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,378 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753305962000, 'day': datetime.date(2025, 7, 24), 'sleep_start': datetime.datetime(2025, 7, 24, 1, 26, 2), 'sleep_end': datetime.datetime(2025, 7, 24, 9, 0, 2), 'sleep_duration_seconds': 26700, 'deep_sleep_seconds': 5160, 'light_sleep_seconds': 15900, 'rem_sleep_seconds': 5640, 'awake_seconds': 540, 'nap_duration_seconds': 0, 'sleep_score': 89, 'avg_sleep_stress': 7.0, 'avg_spo2': 95.0, 'lowest_spo2': 93, 'highest_spo2': 99, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 378168)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,381 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753387447000, 'day': datetime.date(2025, 7, 25), 'sleep_start': datetime.datetime(2025, 7, 25, 0, 4, 7), 'sleep_end': datetime.datetime(2025, 7, 25, 9, 35, 7), 'sleep_duration_seconds': 33300, 'deep_sleep_seconds': 6240, 'light_sleep_seconds': 21540, 'rem_sleep_seconds': 5520, 'awake_seconds': 960, 'nap_duration_seconds': 0, 'sleep_score': 89, 'avg_sleep_stress': 13.0, 'avg_spo2': 95.0, 'lowest_spo2': 88, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 380966)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,385 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753491417000, 'day': datetime.date(2025, 7, 26), 'sleep_start': datetime.datetime(2025, 7, 26, 4, 56, 57), 'sleep_end': datetime.datetime(2025, 7, 26, 11, 33, 57), 'sleep_duration_seconds': 23820, 'deep_sleep_seconds': 7140, 'light_sleep_seconds': 10200, 'rem_sleep_seconds': 6480, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 82, 'avg_sleep_stress': 14.0, 'avg_spo2': 96.0, 'lowest_spo2': 91, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 384514)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,389 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753576283000, 'day': datetime.date(2025, 7, 27), 'sleep_start': datetime.datetime(2025, 7, 27, 4, 31, 23), 'sleep_end': datetime.datetime(2025, 7, 27, 11, 34, 15), 'sleep_duration_seconds': 25252, 'deep_sleep_seconds': 6060, 'light_sleep_seconds': 10440, 'rem_sleep_seconds': 8760, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 11.0, 'avg_spo2': 95.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 388522)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,392 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753654408000, 'day': datetime.date(2025, 7, 28), 'sleep_start': datetime.datetime(2025, 7, 28, 2, 13, 28), 'sleep_end': datetime.datetime(2025, 7, 28, 11, 4, 28), 'sleep_duration_seconds': 30000, 'deep_sleep_seconds': 6060, 'light_sleep_seconds': 15240, 'rem_sleep_seconds': 8700, 'awake_seconds': 300, 'nap_duration_seconds': 0, 'sleep_score': 98, 'avg_sleep_stress': 10.0, 'avg_spo2': 94.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 391033)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,394 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753738619000, 'day': datetime.date(2025, 7, 29), 'sleep_start': datetime.datetime(2025, 7, 29, 1, 36, 59), 'sleep_end': datetime.datetime(2025, 7, 29, 8, 42, 40), 'sleep_duration_seconds': 23921, 'deep_sleep_seconds': 1920, 'light_sleep_seconds': 14640, 'rem_sleep_seconds': 7380, 'awake_seconds': 720, 'nap_duration_seconds': 0, 'sleep_score': 76, 'avg_sleep_stress': 16.0, 'avg_spo2': 94.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 394105)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,398 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753824233000, 'day': datetime.date(2025, 7, 30), 'sleep_start': datetime.datetime(2025, 7, 30, 1, 23, 53), 'sleep_end': datetime.datetime(2025, 7, 30, 9, 11, 14), 'sleep_duration_seconds': 24621, 'deep_sleep_seconds': 3840, 'light_sleep_seconds': 16560, 'rem_sleep_seconds': 4260, 'awake_seconds': 1320, 'nap_duration_seconds': 0, 'sleep_score': 75, 'avg_sleep_stress': 20.0, 'avg_spo2': 96.0, 'lowest_spo2': 83, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 397167)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,401 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-31.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753913996000, 'day': datetime.date(2025, 7, 31), 'sleep_start': datetime.datetime(2025, 7, 31, 2, 19, 56), 'sleep_end': datetime.datetime(2025, 7, 31, 10, 30, 56), 'sleep_duration_seconds': 29460, 'deep_sleep_seconds': 5760, 'light_sleep_seconds': 13980, 'rem_sleep_seconds': 9720, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 16.0, 'avg_spo2': 97.0, 'lowest_spo2': 85, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 400632)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,403 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-08-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753997429000, 'day': datetime.date(2025, 8, 1), 'sleep_start': datetime.datetime(2025, 8, 1, 1, 30, 29), 'sleep_end': datetime.datetime(2025, 8, 1, 5, 31, 29), 'sleep_duration_seconds': 14400, 'deep_sleep_seconds': 3060, 'light_sleep_seconds': 6120, 'rem_sleep_seconds': 5220, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 53, 'avg_sleep_stress': 9.0, 'avg_spo2': 95.0, 'lowest_spo2': 89, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 403631)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,406 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-08-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1754096942000, 'day': datetime.date(2025, 8, 2), 'sleep_start': datetime.datetime(2025, 8, 2, 5, 9, 2), 'sleep_end': datetime.datetime(2025, 8, 2, 10, 29, 2), 'sleep_duration_seconds': 19200, 'deep_sleep_seconds': 10980, 'light_sleep_seconds': 7140, 'rem_sleep_seconds': 1080, 'awake_seconds': 0, 'nap_duration_seconds': 7080, 'sleep_score': 61, 'avg_sleep_stress': 17.0, 'avg_spo2': 96.0, 'lowest_spo2': 93, 'highest_spo2': 98, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 405631)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,409 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-08-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1754176833000, 'day': datetime.date(2025, 8, 3), 'sleep_start': datetime.datetime(2025, 8, 3, 3, 20, 33), 'sleep_end': datetime.datetime(2025, 8, 3, 9, 54, 9), 'sleep_duration_seconds': 20616, 'deep_sleep_seconds': 5640, 'light_sleep_seconds': 13620, 'rem_sleep_seconds': 1380, 'awake_seconds': 3000, 'nap_duration_seconds': 0, 'sleep_score': 61, 'avg_sleep_stress': 17.0, 'avg_spo2': 96.0, 'lowest_spo2': 90, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 440, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 408135)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,412 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-08-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1754254377000, 'day': datetime.date(2025, 8, 4), 'sleep_start': datetime.datetime(2025, 8, 4, 0, 52, 57), 'sleep_end': datetime.datetime(2025, 8, 4, 8, 56, 57), 'sleep_duration_seconds': 26340, 'deep_sleep_seconds': 2340, 'light_sleep_seconds': 18960, 'rem_sleep_seconds': 5040, 'awake_seconds': 2700, 'nap_duration_seconds': 2460, 'sleep_score': 70, 'avg_sleep_stress': 24.0, 'avg_spo2': 95.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 48, 49, 412244)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:48:49,413 - INFO - Migrated 0 sleep records (267 errors)
2025-08-05 19:48:49,414 - INFO - Migrated 0 steps records
2025-08-05 19:48:49,543 - INFO - Migrated 98 weight records
2025-08-05 19:48:49,743 - INFO - Created 0 new journal entries
2025-08-05 19:48:49,744 - INFO - Migration completed successfully!
2025-08-05 19:48:49,751 - ERROR - Migration failed: (psycopg2.errors.UndefinedColumn) column garmin_sleep_sessions.avg_sleep_stress does not exist
LINE 2: ...p_quality AS garmin_sleep_sessions_sleep_quality, garmin_sle...
                                                             ^

[SQL: SELECT count(*) AS count_1 
FROM (SELECT garmin_sleep_sessions.sleep_id AS garmin_sleep_sessions_sleep_id, garmin_sleep_sessions.day AS garmin_sleep_sessions_day, garmin_sleep_sessions.sleep_start AS garmin_sleep_sessions_sleep_start, garmin_sleep_sessions.sleep_end AS garmin_sleep_sessions_sleep_end, garmin_sleep_sessions.sleep_duration_seconds AS garmin_sleep_sessions_sleep_duration_seconds, garmin_sleep_sessions.deep_sleep_seconds AS garmin_sleep_sessions_deep_sleep_seconds, garmin_sleep_sessions.light_sleep_seconds AS garmin_sleep_sessions_light_sleep_seconds, garmin_sleep_sessions.rem_sleep_seconds AS garmin_sleep_sessions_rem_sleep_seconds, garmin_sleep_sessions.awake_seconds AS garmin_sleep_sessions_awake_seconds, garmin_sleep_sessions.nap_duration_seconds AS garmin_sleep_sessions_nap_duration_seconds, garmin_sleep_sessions.sleep_score AS garmin_sleep_sessions_sleep_score, garmin_sleep_sessions.sleep_quality AS garmin_sleep_sessions_sleep_quality, garmin_sleep_sessions.avg_sleep_stress AS garmin_sleep_sessions_avg_sleep_stress, garmin_sleep_sessions.avg_spo2 AS garmin_sleep_sessions_avg_spo2, garmin_sleep_sessions.lowest_spo2 AS garmin_sleep_sessions_lowest_spo2, garmin_sleep_sessions.highest_spo2 AS garmin_sleep_sessions_highest_spo2, garmin_sleep_sessions.avg_respiration AS garmin_sleep_sessions_avg_respiration, garmin_sleep_sessions.awake_count AS garmin_sleep_sessions_awake_count, garmin_sleep_sessions.sleep_need_baseline AS garmin_sleep_sessions_sleep_need_baseline, garmin_sleep_sessions.sleep_need_actual AS garmin_sleep_sessions_sleep_need_actual, garmin_sleep_sessions.created_at AS garmin_sleep_sessions_created_at 
FROM garmin_sleep_sessions) AS anon_1]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-05 19:50:51,684 - INFO - Database tables created/verified
2025-08-05 19:50:51,684 - INFO - Starting enhanced Garmin data migration...
2025-08-05 19:50:51,973 - INFO - Migrated 277 RHR records (0 errors)
2025-08-05 19:50:51,977 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-01.json: (psycopg2.errors.UndefinedColumn) column "avg_sleep_stress" of relation "garmin_sleep_sessions" does not exist
LINE 1: ...awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_...
                                                             ^

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1730419180000, 'day': datetime.date(2024, 11, 1), 'sleep_start': datetime.datetime(2024, 11, 1, 1, 59, 40), 'sleep_end': datetime.datetime(2024, 11, 1, 8, 8, 40), 'sleep_duration_seconds': 21120, 'deep_sleep_seconds': 6420, 'light_sleep_seconds': 11640, 'rem_sleep_seconds': 3060, 'awake_seconds': 1020, 'nap_duration_seconds': 0, 'sleep_score': 69, 'avg_sleep_stress': 20.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 14.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 51, 976076)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-05 19:50:51,979 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1730497155000, 'day': datetime.date(2024, 11, 2), 'sleep_start': datetime.datetime(2024, 11, 1, 23, 39, 15), 'sleep_end': datetime.datetime(2024, 11, 2, 9, 17, 3), 'sleep_duration_seconds': 29508, 'deep_sleep_seconds': 4680, 'light_sleep_seconds': 22140, 'rem_sleep_seconds': 2700, 'awake_seconds': 5160, 'nap_duration_seconds': 0, 'sleep_score': 52, 'avg_sleep_stress': 21.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 8, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 51, 978838)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:51,981 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1730581786000, 'day': datetime.date(2024, 11, 3), 'sleep_start': datetime.datetime(2024, 11, 2, 23, 9, 46), 'sleep_end': datetime.datetime(2024, 11, 3, 8, 16, 46), 'sleep_duration_seconds': 29880, 'deep_sleep_seconds': 5160, 'light_sleep_seconds': 22560, 'rem_sleep_seconds': 2160, 'awake_seconds': 2040, 'nap_duration_seconds': 0, 'sleep_score': 75, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 51, 980904)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:51,982 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1730670757000, 'day': datetime.date(2024, 11, 4), 'sleep_start': datetime.datetime(2024, 11, 3, 23, 52, 37), 'sleep_end': datetime.datetime(2024, 11, 4, 7, 32, 37), 'sleep_duration_seconds': 26040, 'deep_sleep_seconds': 7440, 'light_sleep_seconds': 14580, 'rem_sleep_seconds': 4020, 'awake_seconds': 1560, 'nap_duration_seconds': 2100, 'sleep_score': 79, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 51, 982447)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:51,984 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1730762636000, 'day': datetime.date(2024, 11, 5), 'sleep_start': datetime.datetime(2024, 11, 5, 1, 23, 56), 'sleep_end': datetime.datetime(2024, 11, 5, 7, 44, 46), 'sleep_duration_seconds': 21590, 'deep_sleep_seconds': 5460, 'light_sleep_seconds': 13200, 'rem_sleep_seconds': 2940, 'awake_seconds': 1260, 'nap_duration_seconds': 0, 'sleep_score': 73, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 51, 983801)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:51,985 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1730849001000, 'day': datetime.date(2024, 11, 6), 'sleep_start': datetime.datetime(2024, 11, 6, 1, 23, 21), 'sleep_end': datetime.datetime(2024, 11, 6, 8, 9, 21), 'sleep_duration_seconds': 20640, 'deep_sleep_seconds': 6420, 'light_sleep_seconds': 11220, 'rem_sleep_seconds': 3000, 'awake_seconds': 3720, 'nap_duration_seconds': 0, 'sleep_score': 65, 'avg_sleep_stress': 19.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 14.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 51, 985346)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:51,987 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1730936932000, 'day': datetime.date(2024, 11, 7), 'sleep_start': datetime.datetime(2024, 11, 7, 1, 48, 52), 'sleep_end': datetime.datetime(2024, 11, 7, 8, 10, 52), 'sleep_duration_seconds': 21780, 'deep_sleep_seconds': 7260, 'light_sleep_seconds': 10620, 'rem_sleep_seconds': 3900, 'awake_seconds': 1140, 'nap_duration_seconds': 0, 'sleep_score': 74, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 51, 986927)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:51,989 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731075527464, 'day': datetime.date(2024, 11, 8), 'sleep_start': datetime.datetime(2024, 11, 8, 16, 18, 47, 464000), 'sleep_end': datetime.datetime(2024, 11, 8, 22, 8, 47, 464000), 'sleep_duration_seconds': 21000, 'deep_sleep_seconds': None, 'light_sleep_seconds': None, 'rem_sleep_seconds': None, 'awake_seconds': None, 'nap_duration_seconds': 1260, 'sleep_score': None, 'avg_sleep_stress': None, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': None, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 51, 988961)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:51,990 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731113685000, 'day': datetime.date(2024, 11, 9), 'sleep_start': datetime.datetime(2024, 11, 9, 2, 54, 45), 'sleep_end': datetime.datetime(2024, 11, 9, 8, 20, 45), 'sleep_duration_seconds': 17160, 'deep_sleep_seconds': 4500, 'light_sleep_seconds': 10740, 'rem_sleep_seconds': 1920, 'awake_seconds': 2400, 'nap_duration_seconds': 0, 'sleep_score': 57, 'avg_sleep_stress': 21.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 51, 990377)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:51,991 - WARNING - No sleep ID found for 2024-11-10
2025-08-05 19:50:51,992 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731280736000, 'day': datetime.date(2024, 11, 11), 'sleep_start': datetime.datetime(2024, 11, 11, 1, 18, 56), 'sleep_end': datetime.datetime(2024, 11, 11, 4, 46, 56), 'sleep_duration_seconds': 8520, 'deep_sleep_seconds': 3060, 'light_sleep_seconds': 4620, 'rem_sleep_seconds': 840, 'awake_seconds': 3960, 'nap_duration_seconds': 0, 'sleep_score': 30, 'avg_sleep_stress': 23.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 14.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 51, 992285)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:51,994 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731356883000, 'day': datetime.date(2024, 11, 12), 'sleep_start': datetime.datetime(2024, 11, 11, 22, 28, 3), 'sleep_end': datetime.datetime(2024, 11, 12, 8, 31, 57), 'sleep_duration_seconds': 32394, 'deep_sleep_seconds': 5820, 'light_sleep_seconds': 18900, 'rem_sleep_seconds': 7680, 'awake_seconds': 3840, 'nap_duration_seconds': 1560, 'sleep_score': 77, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 51, 993683)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:51,995 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731452090000, 'day': datetime.date(2024, 11, 13), 'sleep_start': datetime.datetime(2024, 11, 13, 0, 54, 50), 'sleep_end': datetime.datetime(2024, 11, 13, 9, 25, 50), 'sleep_duration_seconds': 29820, 'deep_sleep_seconds': 4140, 'light_sleep_seconds': 20580, 'rem_sleep_seconds': 5100, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 51, 995336)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:51,997 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731547447000, 'day': datetime.date(2024, 11, 14), 'sleep_start': datetime.datetime(2024, 11, 14, 3, 24, 7), 'sleep_end': datetime.datetime(2024, 11, 14, 8, 40, 54), 'sleep_duration_seconds': 18947, 'deep_sleep_seconds': 2580, 'light_sleep_seconds': 11160, 'rem_sleep_seconds': 5220, 'awake_seconds': 60, 'nap_duration_seconds': 2820, 'sleep_score': 68, 'avg_sleep_stress': 5.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 17.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 51, 996940)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:51,999 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731643703000, 'day': datetime.date(2024, 11, 15), 'sleep_start': datetime.datetime(2024, 11, 15, 6, 8, 23), 'sleep_end': datetime.datetime(2024, 11, 15, 12, 13, 23), 'sleep_duration_seconds': 21780, 'deep_sleep_seconds': 5520, 'light_sleep_seconds': 15900, 'rem_sleep_seconds': 360, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 50, 'avg_sleep_stress': 37.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 51, 998732)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,000 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731731213000, 'day': datetime.date(2024, 11, 16), 'sleep_start': datetime.datetime(2024, 11, 16, 6, 26, 53), 'sleep_end': datetime.datetime(2024, 11, 16, 12, 32, 53), 'sleep_duration_seconds': 20220, 'deep_sleep_seconds': 3780, 'light_sleep_seconds': 13860, 'rem_sleep_seconds': 2580, 'awake_seconds': 960, 'nap_duration_seconds': 0, 'sleep_score': 68, 'avg_sleep_stress': 19.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 298)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,002 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731798536000, 'day': datetime.date(2024, 11, 17), 'sleep_start': datetime.datetime(2024, 11, 17, 1, 8, 56), 'sleep_end': datetime.datetime(2024, 11, 17, 8, 50, 56), 'sleep_duration_seconds': 27660, 'deep_sleep_seconds': 11700, 'light_sleep_seconds': 8340, 'rem_sleep_seconds': 7620, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 19.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 1817)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,004 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731890937000, 'day': datetime.date(2024, 11, 18), 'sleep_start': datetime.datetime(2024, 11, 18, 2, 48, 57), 'sleep_end': datetime.datetime(2024, 11, 18, 9, 4, 57), 'sleep_duration_seconds': 22260, 'deep_sleep_seconds': 9000, 'light_sleep_seconds': 8580, 'rem_sleep_seconds': 4680, 'awake_seconds': 300, 'nap_duration_seconds': 0, 'sleep_score': 73, 'avg_sleep_stress': 22.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 16.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 3447)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,005 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1731976584000, 'day': datetime.date(2024, 11, 19), 'sleep_start': datetime.datetime(2024, 11, 19, 2, 36, 24), 'sleep_end': datetime.datetime(2024, 11, 19, 10, 30, 24), 'sleep_duration_seconds': 26940, 'deep_sleep_seconds': 7740, 'light_sleep_seconds': 11940, 'rem_sleep_seconds': 7260, 'awake_seconds': 1500, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 20.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 5039)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,007 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732060956000, 'day': datetime.date(2024, 11, 20), 'sleep_start': datetime.datetime(2024, 11, 20, 2, 2, 36), 'sleep_end': datetime.datetime(2024, 11, 20, 9, 7, 36), 'sleep_duration_seconds': 25080, 'deep_sleep_seconds': 5700, 'light_sleep_seconds': 15000, 'rem_sleep_seconds': 4380, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 19.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 6494)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,008 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732146689000, 'day': datetime.date(2024, 11, 21), 'sleep_start': datetime.datetime(2024, 11, 21, 1, 51, 29), 'sleep_end': datetime.datetime(2024, 11, 21, 9, 14, 29), 'sleep_duration_seconds': 24900, 'deep_sleep_seconds': 3540, 'light_sleep_seconds': 17040, 'rem_sleep_seconds': 4320, 'awake_seconds': 1680, 'nap_duration_seconds': 0, 'sleep_score': 76, 'avg_sleep_stress': 17.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 8191)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,010 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732243351000, 'day': datetime.date(2024, 11, 22), 'sleep_start': datetime.datetime(2024, 11, 22, 4, 42, 31), 'sleep_end': datetime.datetime(2024, 11, 22, 7, 43, 31), 'sleep_duration_seconds': 10320, 'deep_sleep_seconds': 3540, 'light_sleep_seconds': 6000, 'rem_sleep_seconds': 780, 'awake_seconds': 540, 'nap_duration_seconds': 0, 'sleep_score': None, 'avg_sleep_stress': 20.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 15.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 9519)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,011 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732311339000, 'day': datetime.date(2024, 11, 23), 'sleep_start': datetime.datetime(2024, 11, 22, 23, 35, 39), 'sleep_end': datetime.datetime(2024, 11, 23, 7, 48, 39), 'sleep_duration_seconds': 28920, 'deep_sleep_seconds': 6540, 'light_sleep_seconds': 18000, 'rem_sleep_seconds': 4380, 'awake_seconds': 660, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 11076)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,013 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732410834000, 'day': datetime.date(2024, 11, 24), 'sleep_start': datetime.datetime(2024, 11, 24, 3, 13, 54), 'sleep_end': datetime.datetime(2024, 11, 24, 10, 45, 54), 'sleep_duration_seconds': 26100, 'deep_sleep_seconds': 8220, 'light_sleep_seconds': 12240, 'rem_sleep_seconds': 5640, 'awake_seconds': 1020, 'nap_duration_seconds': 0, 'sleep_score': 80, 'avg_sleep_stress': 18.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 12558)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,014 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732491772000, 'day': datetime.date(2024, 11, 25), 'sleep_start': datetime.datetime(2024, 11, 25, 1, 42, 52), 'sleep_end': datetime.datetime(2024, 11, 25, 9, 11, 52), 'sleep_duration_seconds': 26940, 'deep_sleep_seconds': 7980, 'light_sleep_seconds': 12600, 'rem_sleep_seconds': 6360, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 92, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 14067)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,016 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732574165000, 'day': datetime.date(2024, 11, 26), 'sleep_start': datetime.datetime(2024, 11, 26, 0, 36, 5), 'sleep_end': datetime.datetime(2024, 11, 26, 8, 46, 5), 'sleep_duration_seconds': 27000, 'deep_sleep_seconds': 3840, 'light_sleep_seconds': 14880, 'rem_sleep_seconds': 8280, 'awake_seconds': 2400, 'nap_duration_seconds': 1860, 'sleep_score': 77, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 21.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 15655)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,017 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732666440000, 'day': datetime.date(2024, 11, 27), 'sleep_start': datetime.datetime(2024, 11, 27, 2, 14), 'sleep_end': datetime.datetime(2024, 11, 27, 8, 27), 'sleep_duration_seconds': 22140, 'deep_sleep_seconds': 7140, 'light_sleep_seconds': 10920, 'rem_sleep_seconds': 4080, 'awake_seconds': 240, 'nap_duration_seconds': 0, 'sleep_score': 76, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 17244)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,019 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732751501000, 'day': datetime.date(2024, 11, 28), 'sleep_start': datetime.datetime(2024, 11, 28, 1, 51, 41), 'sleep_end': datetime.datetime(2024, 11, 28, 9, 14, 41), 'sleep_duration_seconds': 24360, 'deep_sleep_seconds': 4980, 'light_sleep_seconds': 15300, 'rem_sleep_seconds': 4080, 'awake_seconds': 2220, 'nap_duration_seconds': 0, 'sleep_score': 80, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 16.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 19089)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,021 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732836786000, 'day': datetime.date(2024, 11, 29), 'sleep_start': datetime.datetime(2024, 11, 29, 1, 33, 6), 'sleep_end': datetime.datetime(2024, 11, 29, 8, 30, 6), 'sleep_duration_seconds': 24900, 'deep_sleep_seconds': 5580, 'light_sleep_seconds': 11100, 'rem_sleep_seconds': 8220, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 20735)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,022 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-11-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1732938498000, 'day': datetime.date(2024, 11, 30), 'sleep_start': datetime.datetime(2024, 11, 30, 5, 48, 18), 'sleep_end': datetime.datetime(2024, 11, 30, 11, 9, 18), 'sleep_duration_seconds': 17940, 'deep_sleep_seconds': 7620, 'light_sleep_seconds': 7860, 'rem_sleep_seconds': 2460, 'awake_seconds': 1320, 'nap_duration_seconds': 0, 'sleep_score': 64, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 22258)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,024 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733006727000, 'day': datetime.date(2024, 12, 1), 'sleep_start': datetime.datetime(2024, 12, 1, 0, 45, 27), 'sleep_end': datetime.datetime(2024, 12, 1, 9, 25, 27), 'sleep_duration_seconds': 30360, 'deep_sleep_seconds': 12780, 'light_sleep_seconds': 14340, 'rem_sleep_seconds': 3240, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 23841)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,025 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733095877000, 'day': datetime.date(2024, 12, 2), 'sleep_start': datetime.datetime(2024, 12, 2, 1, 31, 17), 'sleep_end': datetime.datetime(2024, 12, 2, 8, 30, 14), 'sleep_duration_seconds': 24297, 'deep_sleep_seconds': 7980, 'light_sleep_seconds': 12540, 'rem_sleep_seconds': 3780, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 76, 'avg_sleep_stress': 20.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 25267)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,027 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733180955000, 'day': datetime.date(2024, 12, 3), 'sleep_start': datetime.datetime(2024, 12, 3, 1, 9, 15), 'sleep_end': datetime.datetime(2024, 12, 3, 8, 45, 15), 'sleep_duration_seconds': 23820, 'deep_sleep_seconds': 6960, 'light_sleep_seconds': 13140, 'rem_sleep_seconds': 3720, 'awake_seconds': 3540, 'nap_duration_seconds': 0, 'sleep_score': 74, 'avg_sleep_stress': 11.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 26833)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,029 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733266707000, 'day': datetime.date(2024, 12, 4), 'sleep_start': datetime.datetime(2024, 12, 4, 0, 58, 27), 'sleep_end': datetime.datetime(2024, 12, 4, 8, 18, 27), 'sleep_duration_seconds': 24720, 'deep_sleep_seconds': 7620, 'light_sleep_seconds': 11760, 'rem_sleep_seconds': 5340, 'awake_seconds': 1680, 'nap_duration_seconds': 0, 'sleep_score': 80, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 28812)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,030 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733364903000, 'day': datetime.date(2024, 12, 5), 'sleep_start': datetime.datetime(2024, 12, 5, 4, 15, 3), 'sleep_end': datetime.datetime(2024, 12, 5, 9, 30, 3), 'sleep_duration_seconds': 18720, 'deep_sleep_seconds': 2760, 'light_sleep_seconds': 11160, 'rem_sleep_seconds': 3660, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 66, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 30295)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,032 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733454000000, 'day': datetime.date(2024, 12, 6), 'sleep_start': datetime.datetime(2024, 12, 6, 5, 0), 'sleep_end': datetime.datetime(2024, 12, 6, 12, 0), 'sleep_duration_seconds': 25200, 'deep_sleep_seconds': None, 'light_sleep_seconds': None, 'rem_sleep_seconds': None, 'awake_seconds': None, 'nap_duration_seconds': 0, 'sleep_score': None, 'avg_sleep_stress': None, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': None, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 31816)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,033 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733523338000, 'day': datetime.date(2024, 12, 7), 'sleep_start': datetime.datetime(2024, 12, 7, 0, 15, 38), 'sleep_end': datetime.datetime(2024, 12, 7, 6, 31, 32), 'sleep_duration_seconds': 22074, 'deep_sleep_seconds': 6480, 'light_sleep_seconds': 10980, 'rem_sleep_seconds': 4620, 'awake_seconds': 480, 'nap_duration_seconds': 3120, 'sleep_score': 78, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 33249)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,035 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733616991000, 'day': datetime.date(2024, 12, 8), 'sleep_start': datetime.datetime(2024, 12, 8, 2, 16, 31), 'sleep_end': datetime.datetime(2024, 12, 8, 10, 6, 31), 'sleep_duration_seconds': 25260, 'deep_sleep_seconds': 2880, 'light_sleep_seconds': 14460, 'rem_sleep_seconds': 7920, 'awake_seconds': 1860, 'nap_duration_seconds': 0, 'sleep_score': 76, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 17.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 440, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 34570)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,036 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733699294000, 'day': datetime.date(2024, 12, 9), 'sleep_start': datetime.datetime(2024, 12, 9, 1, 8, 14), 'sleep_end': datetime.datetime(2024, 12, 9, 9, 9, 14), 'sleep_duration_seconds': 28380, 'deep_sleep_seconds': 6660, 'light_sleep_seconds': 16560, 'rem_sleep_seconds': 5160, 'awake_seconds': 480, 'nap_duration_seconds': 0, 'sleep_score': 93, 'avg_sleep_stress': 7.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 35890)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,038 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733789808000, 'day': datetime.date(2024, 12, 10), 'sleep_start': datetime.datetime(2024, 12, 10, 2, 16, 48), 'sleep_end': datetime.datetime(2024, 12, 10, 9, 48, 48), 'sleep_duration_seconds': 21840, 'deep_sleep_seconds': 5940, 'light_sleep_seconds': 13260, 'rem_sleep_seconds': 2640, 'awake_seconds': 5280, 'nap_duration_seconds': 0, 'sleep_score': 63, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 14.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 37538)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,039 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733876067000, 'day': datetime.date(2024, 12, 11), 'sleep_start': datetime.datetime(2024, 12, 11, 2, 14, 27), 'sleep_end': datetime.datetime(2024, 12, 11, 8, 58, 23), 'sleep_duration_seconds': 21416, 'deep_sleep_seconds': 3840, 'light_sleep_seconds': 14640, 'rem_sleep_seconds': 2940, 'awake_seconds': 2820, 'nap_duration_seconds': 0, 'sleep_score': 62, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 18.0, 'awake_count': 4, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 38970)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,041 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1733966368000, 'day': datetime.date(2024, 12, 12), 'sleep_start': datetime.datetime(2024, 12, 12, 3, 19, 28), 'sleep_end': datetime.datetime(2024, 12, 12, 9, 21, 28), 'sleep_duration_seconds': 20280, 'deep_sleep_seconds': 5520, 'light_sleep_seconds': 12360, 'rem_sleep_seconds': 2400, 'awake_seconds': 1440, 'nap_duration_seconds': 4200, 'sleep_score': 67, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 40528)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,042 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734062732000, 'day': datetime.date(2024, 12, 13), 'sleep_start': datetime.datetime(2024, 12, 13, 6, 5, 32), 'sleep_end': datetime.datetime(2024, 12, 13, 11, 21, 32), 'sleep_duration_seconds': 17700, 'deep_sleep_seconds': 5400, 'light_sleep_seconds': 11340, 'rem_sleep_seconds': 960, 'awake_seconds': 1260, 'nap_duration_seconds': 7920, 'sleep_score': 56, 'avg_sleep_stress': 20.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 16.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 41915)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,043 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734145184000, 'day': datetime.date(2024, 12, 14), 'sleep_start': datetime.datetime(2024, 12, 14, 4, 59, 44), 'sleep_end': datetime.datetime(2024, 12, 14, 12, 8, 43), 'sleep_duration_seconds': 24059, 'deep_sleep_seconds': 8880, 'light_sleep_seconds': 9120, 'rem_sleep_seconds': 6060, 'awake_seconds': 1680, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 43324)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,045 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734223783000, 'day': datetime.date(2024, 12, 15), 'sleep_start': datetime.datetime(2024, 12, 15, 2, 49, 43), 'sleep_end': datetime.datetime(2024, 12, 15, 10, 37, 38), 'sleep_duration_seconds': 26155, 'deep_sleep_seconds': 5160, 'light_sleep_seconds': 16860, 'rem_sleep_seconds': 4140, 'awake_seconds': 1020, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 44992)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,047 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734302240000, 'day': datetime.date(2024, 12, 16), 'sleep_start': datetime.datetime(2024, 12, 16, 0, 37, 20), 'sleep_end': datetime.datetime(2024, 12, 16, 8, 22, 20), 'sleep_duration_seconds': 27060, 'deep_sleep_seconds': 5160, 'light_sleep_seconds': 19020, 'rem_sleep_seconds': 2880, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 46896)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,049 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734388679000, 'day': datetime.date(2024, 12, 17), 'sleep_start': datetime.datetime(2024, 12, 17, 0, 37, 59), 'sleep_end': datetime.datetime(2024, 12, 17, 8, 41, 59), 'sleep_duration_seconds': 28620, 'deep_sleep_seconds': 4200, 'light_sleep_seconds': 19020, 'rem_sleep_seconds': 5400, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 11.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 48464)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,050 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734478200000, 'day': datetime.date(2024, 12, 18), 'sleep_start': datetime.datetime(2024, 12, 18, 1, 30), 'sleep_end': datetime.datetime(2024, 12, 18, 8, 21), 'sleep_duration_seconds': 22620, 'deep_sleep_seconds': 3300, 'light_sleep_seconds': 16020, 'rem_sleep_seconds': 3300, 'awake_seconds': 2040, 'nap_duration_seconds': 0, 'sleep_score': 74, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 49909)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,051 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734560951000, 'day': datetime.date(2024, 12, 19), 'sleep_start': datetime.datetime(2024, 12, 19, 0, 29, 11), 'sleep_end': datetime.datetime(2024, 12, 19, 8, 20, 11), 'sleep_duration_seconds': 23220, 'deep_sleep_seconds': 4740, 'light_sleep_seconds': 18480, 'rem_sleep_seconds': 0, 'awake_seconds': 5040, 'nap_duration_seconds': 0, 'sleep_score': 44, 'avg_sleep_stress': 20.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 14.0, 'awake_count': 6, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 51276)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,053 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734655498000, 'day': datetime.date(2024, 12, 20), 'sleep_start': datetime.datetime(2024, 12, 20, 2, 44, 58), 'sleep_end': datetime.datetime(2024, 12, 20, 9, 57, 58), 'sleep_duration_seconds': 22620, 'deep_sleep_seconds': 3660, 'light_sleep_seconds': 16080, 'rem_sleep_seconds': 2880, 'awake_seconds': 3360, 'nap_duration_seconds': 0, 'sleep_score': 61, 'avg_sleep_stress': 22.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 4, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 52704)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,054 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734734905000, 'day': datetime.date(2024, 12, 21), 'sleep_start': datetime.datetime(2024, 12, 21, 0, 48, 25), 'sleep_end': datetime.datetime(2024, 12, 21, 9, 48, 25), 'sleep_duration_seconds': 28920, 'deep_sleep_seconds': 5520, 'light_sleep_seconds': 18540, 'rem_sleep_seconds': 4860, 'awake_seconds': 3480, 'nap_duration_seconds': 0, 'sleep_score': 61, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 5, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 54357)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,057 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734826548000, 'day': datetime.date(2024, 12, 22), 'sleep_start': datetime.datetime(2024, 12, 22, 2, 15, 48), 'sleep_end': datetime.datetime(2024, 12, 22, 9, 13, 48), 'sleep_duration_seconds': 22260, 'deep_sleep_seconds': 6780, 'light_sleep_seconds': 12660, 'rem_sleep_seconds': 2820, 'awake_seconds': 2820, 'nap_duration_seconds': 0, 'sleep_score': 68, 'avg_sleep_stress': 19.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 56625)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,058 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734901126000, 'day': datetime.date(2024, 12, 23), 'sleep_start': datetime.datetime(2024, 12, 22, 22, 58, 46), 'sleep_end': datetime.datetime(2024, 12, 23, 9, 49, 46), 'sleep_duration_seconds': 35160, 'deep_sleep_seconds': 5340, 'light_sleep_seconds': 22080, 'rem_sleep_seconds': 7740, 'awake_seconds': 3900, 'nap_duration_seconds': 0, 'sleep_score': 73, 'avg_sleep_stress': 17.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 58086)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,060 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1734995263000, 'day': datetime.date(2024, 12, 24), 'sleep_start': datetime.datetime(2024, 12, 24, 1, 7, 43), 'sleep_end': datetime.datetime(2024, 12, 24, 9, 39, 43), 'sleep_duration_seconds': 26760, 'deep_sleep_seconds': 3780, 'light_sleep_seconds': 18060, 'rem_sleep_seconds': 4920, 'awake_seconds': 3960, 'nap_duration_seconds': 0, 'sleep_score': 58, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 5, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 59483)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,061 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735087768000, 'day': datetime.date(2024, 12, 25), 'sleep_start': datetime.datetime(2024, 12, 25, 2, 49, 28), 'sleep_end': datetime.datetime(2024, 12, 25, 9, 31, 28), 'sleep_duration_seconds': 22860, 'deep_sleep_seconds': 6840, 'light_sleep_seconds': 13620, 'rem_sleep_seconds': 2400, 'awake_seconds': 1260, 'nap_duration_seconds': 0, 'sleep_score': 75, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 60843)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,062 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735159367000, 'day': datetime.date(2024, 12, 26), 'sleep_start': datetime.datetime(2024, 12, 25, 22, 42, 47), 'sleep_end': datetime.datetime(2024, 12, 26, 7, 31, 47), 'sleep_duration_seconds': 30600, 'deep_sleep_seconds': 4980, 'light_sleep_seconds': 21120, 'rem_sleep_seconds': 4500, 'awake_seconds': 1140, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 11.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 62278)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,064 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735252953000, 'day': datetime.date(2024, 12, 27), 'sleep_start': datetime.datetime(2024, 12, 27, 0, 42, 33), 'sleep_end': datetime.datetime(2024, 12, 27, 8, 3, 33), 'sleep_duration_seconds': 23580, 'deep_sleep_seconds': 5400, 'light_sleep_seconds': 16620, 'rem_sleep_seconds': 1560, 'awake_seconds': 2880, 'nap_duration_seconds': 0, 'sleep_score': 64, 'avg_sleep_stress': 19.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 63663)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,066 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735341838000, 'day': datetime.date(2024, 12, 28), 'sleep_start': datetime.datetime(2024, 12, 28, 1, 23, 58), 'sleep_end': datetime.datetime(2024, 12, 28, 9, 26, 58), 'sleep_duration_seconds': 27180, 'deep_sleep_seconds': 5100, 'light_sleep_seconds': 18660, 'rem_sleep_seconds': 3420, 'awake_seconds': 1800, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 65547)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,067 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735425118000, 'day': datetime.date(2024, 12, 29), 'sleep_start': datetime.datetime(2024, 12, 29, 0, 31, 58), 'sleep_end': datetime.datetime(2024, 12, 29, 7, 15, 58), 'sleep_duration_seconds': 22440, 'deep_sleep_seconds': 6060, 'light_sleep_seconds': 12540, 'rem_sleep_seconds': 3840, 'awake_seconds': 1800, 'nap_duration_seconds': 0, 'sleep_score': 69, 'avg_sleep_stress': 22.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 66973)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,069 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735512162000, 'day': datetime.date(2024, 12, 30), 'sleep_start': datetime.datetime(2024, 12, 30, 0, 42, 42), 'sleep_end': datetime.datetime(2024, 12, 30, 7, 30, 42), 'sleep_duration_seconds': 22980, 'deep_sleep_seconds': 6120, 'light_sleep_seconds': 11640, 'rem_sleep_seconds': 5220, 'awake_seconds': 1500, 'nap_duration_seconds': 3060, 'sleep_score': 75, 'avg_sleep_stress': 21.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 68351)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,070 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2024-12-31.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735596602000, 'day': datetime.date(2024, 12, 31), 'sleep_start': datetime.datetime(2024, 12, 31, 0, 10, 2), 'sleep_end': datetime.datetime(2024, 12, 31, 7, 30, 2), 'sleep_duration_seconds': 24420, 'deep_sleep_seconds': 3360, 'light_sleep_seconds': 20220, 'rem_sleep_seconds': 840, 'awake_seconds': 1980, 'nap_duration_seconds': 0, 'sleep_score': 63, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 69915)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,072 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735703507000, 'day': datetime.date(2025, 1, 1), 'sleep_start': datetime.datetime(2025, 1, 1, 5, 51, 47), 'sleep_end': datetime.datetime(2025, 1, 1, 12, 34, 47), 'sleep_duration_seconds': 16440, 'deep_sleep_seconds': 3900, 'light_sleep_seconds': 12540, 'rem_sleep_seconds': 0, 'awake_seconds': 7740, 'nap_duration_seconds': 0, 'sleep_score': 29, 'avg_sleep_stress': 44.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 14.0, 'awake_count': 7, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 71563)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,073 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735766673000, 'day': datetime.date(2025, 1, 2), 'sleep_start': datetime.datetime(2025, 1, 1, 23, 24, 33), 'sleep_end': datetime.datetime(2025, 1, 2, 7, 43, 33), 'sleep_duration_seconds': 28500, 'deep_sleep_seconds': 7020, 'light_sleep_seconds': 16200, 'rem_sleep_seconds': 5280, 'awake_seconds': 1440, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 17.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 72956)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,075 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735864366000, 'day': datetime.date(2025, 1, 3), 'sleep_start': datetime.datetime(2025, 1, 3, 2, 32, 46), 'sleep_end': datetime.datetime(2025, 1, 3, 9, 16, 25), 'sleep_duration_seconds': 23859, 'deep_sleep_seconds': 4380, 'light_sleep_seconds': 15240, 'rem_sleep_seconds': 4260, 'awake_seconds': 360, 'nap_duration_seconds': 0, 'sleep_score': 81, 'avg_sleep_stress': 6.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 74652)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,076 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1735946588000, 'day': datetime.date(2025, 1, 4), 'sleep_start': datetime.datetime(2025, 1, 4, 1, 23, 8), 'sleep_end': datetime.datetime(2025, 1, 4, 8, 30, 8), 'sleep_duration_seconds': 25440, 'deep_sleep_seconds': 6360, 'light_sleep_seconds': 14820, 'rem_sleep_seconds': 4260, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 6.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 75968)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,078 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736033918000, 'day': datetime.date(2025, 1, 5), 'sleep_start': datetime.datetime(2025, 1, 5, 1, 38, 38), 'sleep_end': datetime.datetime(2025, 1, 5, 9, 19, 38), 'sleep_duration_seconds': 25860, 'deep_sleep_seconds': 5640, 'light_sleep_seconds': 16680, 'rem_sleep_seconds': 3540, 'awake_seconds': 1800, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 77632)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,079 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736120556000, 'day': datetime.date(2025, 1, 6), 'sleep_start': datetime.datetime(2025, 1, 6, 1, 42, 36), 'sleep_end': datetime.datetime(2025, 1, 6, 8, 34, 36), 'sleep_duration_seconds': 23280, 'deep_sleep_seconds': 4560, 'light_sleep_seconds': 15600, 'rem_sleep_seconds': 3120, 'awake_seconds': 1440, 'nap_duration_seconds': 0, 'sleep_score': 74, 'avg_sleep_stress': 18.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 79071)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,081 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736199003000, 'day': datetime.date(2025, 1, 7), 'sleep_start': datetime.datetime(2025, 1, 6, 23, 30, 3), 'sleep_end': datetime.datetime(2025, 1, 7, 10, 0, 20), 'sleep_duration_seconds': 35117, 'deep_sleep_seconds': 6300, 'light_sleep_seconds': 21420, 'rem_sleep_seconds': 7440, 'awake_seconds': 2700, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 18.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 80566)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,082 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736292466000, 'day': datetime.date(2025, 1, 8), 'sleep_start': datetime.datetime(2025, 1, 8, 1, 27, 46), 'sleep_end': datetime.datetime(2025, 1, 8, 9, 47, 3), 'sleep_duration_seconds': 27797, 'deep_sleep_seconds': 5040, 'light_sleep_seconds': 19200, 'rem_sleep_seconds': 3600, 'awake_seconds': 2160, 'nap_duration_seconds': 0, 'sleep_score': 81, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 81917)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,083 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736380346000, 'day': datetime.date(2025, 1, 9), 'sleep_start': datetime.datetime(2025, 1, 9, 1, 52, 26), 'sleep_end': datetime.datetime(2025, 1, 9, 9, 35, 26), 'sleep_duration_seconds': 26760, 'deep_sleep_seconds': 7200, 'light_sleep_seconds': 15060, 'rem_sleep_seconds': 4500, 'awake_seconds': 1020, 'nap_duration_seconds': 0, 'sleep_score': 86, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 83253)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,085 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736461866000, 'day': datetime.date(2025, 1, 10), 'sleep_start': datetime.datetime(2025, 1, 10, 0, 31, 6), 'sleep_end': datetime.datetime(2025, 1, 10, 8, 53, 6), 'sleep_duration_seconds': 28500, 'deep_sleep_seconds': 5400, 'light_sleep_seconds': 18540, 'rem_sleep_seconds': 4560, 'awake_seconds': 1620, 'nap_duration_seconds': 0, 'sleep_score': 87, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 84840)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,086 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736557266000, 'day': datetime.date(2025, 1, 11), 'sleep_start': datetime.datetime(2025, 1, 11, 3, 1, 6), 'sleep_end': datetime.datetime(2025, 1, 11, 9, 57, 6), 'sleep_duration_seconds': 24000, 'deep_sleep_seconds': 7080, 'light_sleep_seconds': 11460, 'rem_sleep_seconds': 5460, 'awake_seconds': 960, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 86434)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,088 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736643708000, 'day': datetime.date(2025, 1, 12), 'sleep_start': datetime.datetime(2025, 1, 12, 3, 1, 48), 'sleep_end': datetime.datetime(2025, 1, 12, 11, 5, 48), 'sleep_duration_seconds': 24660, 'deep_sleep_seconds': 5280, 'light_sleep_seconds': 16320, 'rem_sleep_seconds': 3060, 'awake_seconds': 4380, 'nap_duration_seconds': 0, 'sleep_score': 72, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 87937)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,089 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736733380000, 'day': datetime.date(2025, 1, 13), 'sleep_start': datetime.datetime(2025, 1, 13, 3, 56, 20), 'sleep_end': datetime.datetime(2025, 1, 13, 8, 39, 20), 'sleep_duration_seconds': 15960, 'deep_sleep_seconds': 5040, 'light_sleep_seconds': 10620, 'rem_sleep_seconds': 300, 'awake_seconds': 1020, 'nap_duration_seconds': 0, 'sleep_score': 49, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 89274)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,091 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736813289000, 'day': datetime.date(2025, 1, 14), 'sleep_start': datetime.datetime(2025, 1, 14, 2, 8, 9), 'sleep_end': datetime.datetime(2025, 1, 14, 8, 30, 9), 'sleep_duration_seconds': 22320, 'deep_sleep_seconds': 8820, 'light_sleep_seconds': 8160, 'rem_sleep_seconds': 5340, 'awake_seconds': 600, 'nap_duration_seconds': 2160, 'sleep_score': 78, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 90851)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,093 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736892759000, 'day': datetime.date(2025, 1, 15), 'sleep_start': datetime.datetime(2025, 1, 15, 0, 12, 39), 'sleep_end': datetime.datetime(2025, 1, 15, 8, 48, 39), 'sleep_duration_seconds': 29760, 'deep_sleep_seconds': 6600, 'light_sleep_seconds': 16620, 'rem_sleep_seconds': 6540, 'awake_seconds': 1200, 'nap_duration_seconds': 0, 'sleep_score': 91, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 92479)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,094 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1736981813000, 'day': datetime.date(2025, 1, 16), 'sleep_start': datetime.datetime(2025, 1, 16, 0, 56, 53), 'sleep_end': datetime.datetime(2025, 1, 16, 10, 25, 48), 'sleep_duration_seconds': 31855, 'deep_sleep_seconds': 4020, 'light_sleep_seconds': 21960, 'rem_sleep_seconds': 5880, 'awake_seconds': 2280, 'nap_duration_seconds': 0, 'sleep_score': 81, 'avg_sleep_stress': 7.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 94230)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,096 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737086350000, 'day': datetime.date(2025, 1, 17), 'sleep_start': datetime.datetime(2025, 1, 17, 5, 59, 10), 'sleep_end': datetime.datetime(2025, 1, 17, 11, 19, 10), 'sleep_duration_seconds': 16980, 'deep_sleep_seconds': 3840, 'light_sleep_seconds': 13140, 'rem_sleep_seconds': 0, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 49, 'avg_sleep_stress': 18.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 95787)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,097 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737149027000, 'day': datetime.date(2025, 1, 18), 'sleep_start': datetime.datetime(2025, 1, 17, 23, 23, 47), 'sleep_end': datetime.datetime(2025, 1, 18, 3, 30, 16), 'sleep_duration_seconds': 14729, 'deep_sleep_seconds': 4080, 'light_sleep_seconds': 6780, 'rem_sleep_seconds': 3900, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 55, 'avg_sleep_stress': 7.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 97104)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,099 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737238169000, 'day': datetime.date(2025, 1, 19), 'sleep_start': datetime.datetime(2025, 1, 19, 0, 9, 29), 'sleep_end': datetime.datetime(2025, 1, 19, 8, 55, 19), 'sleep_duration_seconds': 31490, 'deep_sleep_seconds': 9480, 'light_sleep_seconds': 12300, 'rem_sleep_seconds': 9720, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 95, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 98487)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,100 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737335139000, 'day': datetime.date(2025, 1, 20), 'sleep_start': datetime.datetime(2025, 1, 20, 3, 5, 39), 'sleep_end': datetime.datetime(2025, 1, 20, 10, 23, 39), 'sleep_duration_seconds': 24780, 'deep_sleep_seconds': 2640, 'light_sleep_seconds': 17880, 'rem_sleep_seconds': 4260, 'awake_seconds': 660, 'nap_duration_seconds': 0, 'sleep_score': 76, 'avg_sleep_stress': 17.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 99811)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,101 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737413110000, 'day': datetime.date(2025, 1, 21), 'sleep_start': datetime.datetime(2025, 1, 21, 0, 45, 10), 'sleep_end': datetime.datetime(2025, 1, 21, 9, 4, 10), 'sleep_duration_seconds': 26460, 'deep_sleep_seconds': 3000, 'light_sleep_seconds': 15300, 'rem_sleep_seconds': 8160, 'awake_seconds': 1440, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 101197)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,103 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737499781000, 'day': datetime.date(2025, 1, 22), 'sleep_start': datetime.datetime(2025, 1, 22, 0, 49, 41), 'sleep_end': datetime.datetime(2025, 1, 22, 8, 30, 41), 'sleep_duration_seconds': 26520, 'deep_sleep_seconds': 6900, 'light_sleep_seconds': 15720, 'rem_sleep_seconds': 3900, 'awake_seconds': 1140, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 102786)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,104 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737587687000, 'day': datetime.date(2025, 1, 23), 'sleep_start': datetime.datetime(2025, 1, 23, 1, 14, 47), 'sleep_end': datetime.datetime(2025, 1, 23, 8, 13, 47), 'sleep_duration_seconds': 24240, 'deep_sleep_seconds': 8760, 'light_sleep_seconds': 9780, 'rem_sleep_seconds': 5700, 'awake_seconds': 900, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 11.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 104115)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,106 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737672157000, 'day': datetime.date(2025, 1, 24), 'sleep_start': datetime.datetime(2025, 1, 24, 0, 42, 37), 'sleep_end': datetime.datetime(2025, 1, 24, 8, 23, 37), 'sleep_duration_seconds': 24000, 'deep_sleep_seconds': 4080, 'light_sleep_seconds': 13980, 'rem_sleep_seconds': 5940, 'awake_seconds': 1620, 'nap_duration_seconds': 0, 'sleep_score': 80, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 105478)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,107 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737760045000, 'day': datetime.date(2025, 1, 25), 'sleep_start': datetime.datetime(2025, 1, 25, 1, 7, 25), 'sleep_end': datetime.datetime(2025, 1, 25, 9, 34, 25), 'sleep_duration_seconds': 30360, 'deep_sleep_seconds': 2640, 'light_sleep_seconds': 21840, 'rem_sleep_seconds': 5880, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 106847)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,108 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737842022000, 'day': datetime.date(2025, 1, 26), 'sleep_start': datetime.datetime(2025, 1, 25, 23, 53, 42), 'sleep_end': datetime.datetime(2025, 1, 26, 9, 0, 42), 'sleep_duration_seconds': 28800, 'deep_sleep_seconds': 4260, 'light_sleep_seconds': 17940, 'rem_sleep_seconds': 6600, 'awake_seconds': 1140, 'nap_duration_seconds': 0, 'sleep_score': 92, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 108227)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,110 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1737937578000, 'day': datetime.date(2025, 1, 27), 'sleep_start': datetime.datetime(2025, 1, 27, 2, 26, 18), 'sleep_end': datetime.datetime(2025, 1, 27, 8, 51, 18), 'sleep_duration_seconds': 21060, 'deep_sleep_seconds': 4500, 'light_sleep_seconds': 12960, 'rem_sleep_seconds': 3600, 'awake_seconds': 2040, 'nap_duration_seconds': 0, 'sleep_score': 71, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 109605)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,112 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738018644000, 'day': datetime.date(2025, 1, 28), 'sleep_start': datetime.datetime(2025, 1, 28, 3, 57, 24), 'sleep_end': datetime.datetime(2025, 1, 28, 7, 28, 24), 'sleep_duration_seconds': 9120, 'deep_sleep_seconds': 1920, 'light_sleep_seconds': 7200, 'rem_sleep_seconds': 0, 'awake_seconds': 3540, 'nap_duration_seconds': 0, 'sleep_score': 33, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 111481)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,113 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738089083000, 'day': datetime.date(2025, 1, 29), 'sleep_start': datetime.datetime(2025, 1, 29, 2, 31, 23), 'sleep_end': datetime.datetime(2025, 1, 29, 6, 1, 5), 'sleep_duration_seconds': 10722, 'deep_sleep_seconds': 2760, 'light_sleep_seconds': 6780, 'rem_sleep_seconds': 1200, 'awake_seconds': 1860, 'nap_duration_seconds': 0, 'sleep_score': 34, 'avg_sleep_stress': 25.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 112816)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,114 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738175891000, 'day': datetime.date(2025, 1, 30), 'sleep_start': datetime.datetime(2025, 1, 30, 2, 38, 11), 'sleep_end': datetime.datetime(2025, 1, 30, 6, 11, 41), 'sleep_duration_seconds': 11130, 'deep_sleep_seconds': 420, 'light_sleep_seconds': 6720, 'rem_sleep_seconds': 4020, 'awake_seconds': 1080, 'nap_duration_seconds': 0, 'sleep_score': 39, 'avg_sleep_stress': 22.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 114211)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,116 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-01-31.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738251586000, 'day': datetime.date(2025, 1, 31), 'sleep_start': datetime.datetime(2025, 1, 30, 23, 39, 46), 'sleep_end': datetime.datetime(2025, 1, 31, 5, 58, 46), 'sleep_duration_seconds': 20220, 'deep_sleep_seconds': 4200, 'light_sleep_seconds': 10980, 'rem_sleep_seconds': 5040, 'awake_seconds': 1560, 'nap_duration_seconds': 0, 'sleep_score': 72, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 115622)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,117 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738340805000, 'day': datetime.date(2025, 2, 1), 'sleep_start': datetime.datetime(2025, 2, 1, 0, 26, 45), 'sleep_end': datetime.datetime(2025, 2, 1, 8, 23, 45), 'sleep_duration_seconds': 27600, 'deep_sleep_seconds': 6660, 'light_sleep_seconds': 15480, 'rem_sleep_seconds': 5460, 'awake_seconds': 1020, 'nap_duration_seconds': 0, 'sleep_score': 82, 'avg_sleep_stress': 22.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 116992)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,119 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738429981000, 'day': datetime.date(2025, 2, 2), 'sleep_start': datetime.datetime(2025, 2, 2, 1, 13, 1), 'sleep_end': datetime.datetime(2025, 2, 2, 7, 40, 1), 'sleep_duration_seconds': 22200, 'deep_sleep_seconds': 4020, 'light_sleep_seconds': 14640, 'rem_sleep_seconds': 3540, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 72, 'avg_sleep_stress': 23.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 118514)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,121 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738513711000, 'day': datetime.date(2025, 2, 3), 'sleep_start': datetime.datetime(2025, 2, 3, 0, 28, 31), 'sleep_end': datetime.datetime(2025, 2, 3, 7, 5, 24), 'sleep_duration_seconds': 23633, 'deep_sleep_seconds': 4380, 'light_sleep_seconds': 15960, 'rem_sleep_seconds': 3300, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 48, 'avg_sleep_stress': 52.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 120462)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,122 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738606259000, 'day': datetime.date(2025, 2, 4), 'sleep_start': datetime.datetime(2025, 2, 4, 2, 10, 59), 'sleep_end': datetime.datetime(2025, 2, 4, 7, 14, 59), 'sleep_duration_seconds': 16920, 'deep_sleep_seconds': 1380, 'light_sleep_seconds': 12720, 'rem_sleep_seconds': 2820, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 57, 'avg_sleep_stress': 25.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 122109)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,124 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738686494000, 'day': datetime.date(2025, 2, 5), 'sleep_start': datetime.datetime(2025, 2, 5, 0, 28, 14), 'sleep_end': datetime.datetime(2025, 2, 5, 7, 54, 14), 'sleep_duration_seconds': 26640, 'deep_sleep_seconds': 3540, 'light_sleep_seconds': 22740, 'rem_sleep_seconds': 360, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 60, 'avg_sleep_stress': 23.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 15.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 123686)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,125 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738770717000, 'day': datetime.date(2025, 2, 6), 'sleep_start': datetime.datetime(2025, 2, 5, 23, 51, 57), 'sleep_end': datetime.datetime(2025, 2, 6, 6, 37, 57), 'sleep_duration_seconds': 22740, 'deep_sleep_seconds': 1020, 'light_sleep_seconds': 15720, 'rem_sleep_seconds': 6000, 'awake_seconds': 900, 'nap_duration_seconds': 0, 'sleep_score': 68, 'avg_sleep_stress': 21.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 125265)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,127 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738863988000, 'day': datetime.date(2025, 2, 7), 'sleep_start': datetime.datetime(2025, 2, 7, 1, 46, 28), 'sleep_end': datetime.datetime(2025, 2, 7, 8, 25, 28), 'sleep_duration_seconds': 23520, 'deep_sleep_seconds': 4440, 'light_sleep_seconds': 14460, 'rem_sleep_seconds': 4620, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 126890)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,128 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1738949963000, 'day': datetime.date(2025, 2, 8), 'sleep_start': datetime.datetime(2025, 2, 8, 1, 39, 23), 'sleep_end': datetime.datetime(2025, 2, 8, 2, 21, 23), 'sleep_duration_seconds': 2460, 'deep_sleep_seconds': 0, 'light_sleep_seconds': 2460, 'rem_sleep_seconds': 0, 'awake_seconds': 60, 'nap_duration_seconds': 4200, 'sleep_score': 29, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 128397)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,130 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739027059000, 'day': datetime.date(2025, 2, 9), 'sleep_start': datetime.datetime(2025, 2, 8, 23, 4, 19), 'sleep_end': datetime.datetime(2025, 2, 9, 8, 32, 49), 'sleep_duration_seconds': 33330, 'deep_sleep_seconds': 2280, 'light_sleep_seconds': 26640, 'rem_sleep_seconds': 4440, 'awake_seconds': 780, 'nap_duration_seconds': 0, 'sleep_score': 59, 'avg_sleep_stress': 39.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 129957)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,132 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739116721000, 'day': datetime.date(2025, 2, 10), 'sleep_start': datetime.datetime(2025, 2, 9, 23, 58, 41), 'sleep_end': datetime.datetime(2025, 2, 10, 6, 40, 41), 'sleep_duration_seconds': 21000, 'deep_sleep_seconds': 3960, 'light_sleep_seconds': 12540, 'rem_sleep_seconds': 4500, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 60, 'avg_sleep_stress': 35.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 131645)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,133 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739212791000, 'day': datetime.date(2025, 2, 11), 'sleep_start': datetime.datetime(2025, 2, 11, 2, 39, 51), 'sleep_end': datetime.datetime(2025, 2, 11, 8, 7, 47), 'sleep_duration_seconds': 18776, 'deep_sleep_seconds': 4500, 'light_sleep_seconds': 7080, 'rem_sleep_seconds': 7200, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 68, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 133170)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,135 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739297535000, 'day': datetime.date(2025, 2, 12), 'sleep_start': datetime.datetime(2025, 2, 12, 2, 12, 15), 'sleep_end': datetime.datetime(2025, 2, 12, 8, 2, 15), 'sleep_duration_seconds': 21000, 'deep_sleep_seconds': 6060, 'light_sleep_seconds': 7200, 'rem_sleep_seconds': 7740, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 74, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 134741)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,136 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739379969000, 'day': datetime.date(2025, 2, 13), 'sleep_start': datetime.datetime(2025, 2, 13, 1, 6, 9), 'sleep_end': datetime.datetime(2025, 2, 13, 7, 24, 9), 'sleep_duration_seconds': 20340, 'deep_sleep_seconds': 0, 'light_sleep_seconds': 20340, 'rem_sleep_seconds': 0, 'awake_seconds': 2340, 'nap_duration_seconds': 0, 'sleep_score': 32, 'avg_sleep_stress': 51.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 136177)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,138 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739470402000, 'day': datetime.date(2025, 2, 14), 'sleep_start': datetime.datetime(2025, 2, 14, 2, 13, 22), 'sleep_end': datetime.datetime(2025, 2, 14, 5, 45, 22), 'sleep_duration_seconds': 12300, 'deep_sleep_seconds': 2460, 'light_sleep_seconds': 9000, 'rem_sleep_seconds': 840, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 43, 'avg_sleep_stress': 22.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 16.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 137532)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,139 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739548363000, 'day': datetime.date(2025, 2, 15), 'sleep_start': datetime.datetime(2025, 2, 14, 23, 52, 43), 'sleep_end': datetime.datetime(2025, 2, 15, 7, 40, 43), 'sleep_duration_seconds': 21780, 'deep_sleep_seconds': 7320, 'light_sleep_seconds': 9120, 'rem_sleep_seconds': 5340, 'awake_seconds': 480, 'nap_duration_seconds': 0, 'sleep_score': 77, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 138910)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,141 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739638599000, 'day': datetime.date(2025, 2, 16), 'sleep_start': datetime.datetime(2025, 2, 16, 0, 56, 39), 'sleep_end': datetime.datetime(2025, 2, 16, 7, 38, 28), 'sleep_duration_seconds': 22069, 'deep_sleep_seconds': 2460, 'light_sleep_seconds': 12420, 'rem_sleep_seconds': 7200, 'awake_seconds': 60, 'nap_duration_seconds': 1980, 'sleep_score': 76, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 140785)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,142 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739717369000, 'day': datetime.date(2025, 2, 17), 'sleep_start': datetime.datetime(2025, 2, 16, 22, 49, 29), 'sleep_end': datetime.datetime(2025, 2, 17, 7, 9, 25), 'sleep_duration_seconds': 26576, 'deep_sleep_seconds': 4560, 'light_sleep_seconds': 19140, 'rem_sleep_seconds': 2880, 'awake_seconds': 3420, 'nap_duration_seconds': 0, 'sleep_score': 73, 'avg_sleep_stress': 17.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 142267)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,144 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739804427000, 'day': datetime.date(2025, 2, 18), 'sleep_start': datetime.datetime(2025, 2, 17, 23, 0, 27), 'sleep_end': datetime.datetime(2025, 2, 18, 7, 10, 10), 'sleep_duration_seconds': 27283, 'deep_sleep_seconds': 2640, 'light_sleep_seconds': 18960, 'rem_sleep_seconds': 5700, 'awake_seconds': 720, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 7.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 143935)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,146 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739892511000, 'day': datetime.date(2025, 2, 19), 'sleep_start': datetime.datetime(2025, 2, 18, 23, 28, 31), 'sleep_end': datetime.datetime(2025, 2, 19, 6, 30, 9), 'sleep_duration_seconds': 23798, 'deep_sleep_seconds': 4740, 'light_sleep_seconds': 13440, 'rem_sleep_seconds': 5640, 'awake_seconds': 1500, 'nap_duration_seconds': 1440, 'sleep_score': 80, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 145533)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,147 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1739981177000, 'day': datetime.date(2025, 2, 20), 'sleep_start': datetime.datetime(2025, 2, 20, 0, 6, 17), 'sleep_end': datetime.datetime(2025, 2, 20, 6, 25, 17), 'sleep_duration_seconds': 20280, 'deep_sleep_seconds': 2400, 'light_sleep_seconds': 13440, 'rem_sleep_seconds': 4440, 'awake_seconds': 660, 'nap_duration_seconds': 0, 'sleep_score': 63, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 147193)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,149 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740064927000, 'day': datetime.date(2025, 2, 21), 'sleep_start': datetime.datetime(2025, 2, 20, 23, 22, 7), 'sleep_end': datetime.datetime(2025, 2, 21, 5, 50, 7), 'sleep_duration_seconds': 21540, 'deep_sleep_seconds': 4380, 'light_sleep_seconds': 13080, 'rem_sleep_seconds': 4080, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 77, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 148558)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,150 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740149230000, 'day': datetime.date(2025, 2, 22), 'sleep_start': datetime.datetime(2025, 2, 21, 22, 47, 10), 'sleep_end': datetime.datetime(2025, 2, 22, 7, 1, 10), 'sleep_duration_seconds': 24780, 'deep_sleep_seconds': 2940, 'light_sleep_seconds': 17940, 'rem_sleep_seconds': 3900, 'awake_seconds': 3240, 'nap_duration_seconds': 0, 'sleep_score': 69, 'avg_sleep_stress': 17.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 150403)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,152 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740251562000, 'day': datetime.date(2025, 2, 23), 'sleep_start': datetime.datetime(2025, 2, 23, 3, 12, 42), 'sleep_end': datetime.datetime(2025, 2, 23, 8, 38, 42), 'sleep_duration_seconds': 13860, 'deep_sleep_seconds': 1380, 'light_sleep_seconds': 10920, 'rem_sleep_seconds': 1560, 'awake_seconds': 2820, 'nap_duration_seconds': 0, 'sleep_score': 46, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 151954)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,152 - WARNING - No sleep ID found for 2025-02-24
2025-08-05 19:50:52,154 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740409893000, 'day': datetime.date(2025, 2, 25), 'sleep_start': datetime.datetime(2025, 2, 24, 23, 11, 33), 'sleep_end': datetime.datetime(2025, 2, 25, 7, 58, 21), 'sleep_duration_seconds': 28488, 'deep_sleep_seconds': 8640, 'light_sleep_seconds': 13800, 'rem_sleep_seconds': 6060, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 96, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 153865)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,155 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740498605000, 'day': datetime.date(2025, 2, 26), 'sleep_start': datetime.datetime(2025, 2, 25, 23, 50, 5), 'sleep_end': datetime.datetime(2025, 2, 26, 6, 43, 5), 'sleep_duration_seconds': 24780, 'deep_sleep_seconds': 9420, 'light_sleep_seconds': 9900, 'rem_sleep_seconds': 5460, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 11.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 155254)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,157 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740586757000, 'day': datetime.date(2025, 2, 27), 'sleep_start': datetime.datetime(2025, 2, 27, 0, 19, 17), 'sleep_end': datetime.datetime(2025, 2, 27, 6, 21, 17), 'sleep_duration_seconds': 20460, 'deep_sleep_seconds': 2100, 'light_sleep_seconds': 14100, 'rem_sleep_seconds': 4260, 'awake_seconds': 1260, 'nap_duration_seconds': 0, 'sleep_score': 70, 'avg_sleep_stress': 11.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 156638)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,158 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-02-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740671293000, 'day': datetime.date(2025, 2, 28), 'sleep_start': datetime.datetime(2025, 2, 27, 23, 48, 13), 'sleep_end': datetime.datetime(2025, 2, 28, 8, 9, 40), 'sleep_duration_seconds': 28287, 'deep_sleep_seconds': 5820, 'light_sleep_seconds': 16020, 'rem_sleep_seconds': 6480, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 97, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 158061)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,160 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740755358000, 'day': datetime.date(2025, 3, 1), 'sleep_start': datetime.datetime(2025, 2, 28, 23, 9, 18), 'sleep_end': datetime.datetime(2025, 3, 1, 7, 8, 47), 'sleep_duration_seconds': 25349, 'deep_sleep_seconds': 3060, 'light_sleep_seconds': 18420, 'rem_sleep_seconds': 3900, 'awake_seconds': 3420, 'nap_duration_seconds': 0, 'sleep_score': 68, 'avg_sleep_stress': 27.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 160108)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,162 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740843135000, 'day': datetime.date(2025, 3, 2), 'sleep_start': datetime.datetime(2025, 3, 1, 23, 32, 15), 'sleep_end': datetime.datetime(2025, 3, 2, 7, 53, 5), 'sleep_duration_seconds': 28790, 'deep_sleep_seconds': 3120, 'light_sleep_seconds': 21000, 'rem_sleep_seconds': 4680, 'awake_seconds': 1260, 'nap_duration_seconds': 0, 'sleep_score': 62, 'avg_sleep_stress': 37.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 162085)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,164 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1740935495000, 'day': datetime.date(2025, 3, 3), 'sleep_start': datetime.datetime(2025, 3, 3, 1, 11, 35), 'sleep_end': datetime.datetime(2025, 3, 3, 6, 55, 33), 'sleep_duration_seconds': 20578, 'deep_sleep_seconds': 3600, 'light_sleep_seconds': 13980, 'rem_sleep_seconds': 3000, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 57, 'avg_sleep_stress': 37.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 14.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 164225)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,166 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741020058000, 'day': datetime.date(2025, 3, 4), 'sleep_start': datetime.datetime(2025, 3, 4, 0, 40, 58), 'sleep_end': datetime.datetime(2025, 3, 4, 6, 33, 58), 'sleep_duration_seconds': 21180, 'deep_sleep_seconds': 3540, 'light_sleep_seconds': 14100, 'rem_sleep_seconds': 3540, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 56, 'avg_sleep_stress': 39.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 166015)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,168 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741101046000, 'day': datetime.date(2025, 3, 5), 'sleep_start': datetime.datetime(2025, 3, 4, 23, 10, 46), 'sleep_end': datetime.datetime(2025, 3, 5, 7, 48, 33), 'sleep_duration_seconds': 30827, 'deep_sleep_seconds': 2640, 'light_sleep_seconds': 23940, 'rem_sleep_seconds': 4260, 'awake_seconds': 240, 'nap_duration_seconds': 0, 'sleep_score': 50, 'avg_sleep_stress': 49.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 168027)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,170 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741190173000, 'day': datetime.date(2025, 3, 6), 'sleep_start': datetime.datetime(2025, 3, 5, 23, 56, 13), 'sleep_end': datetime.datetime(2025, 3, 6, 8, 9, 13), 'sleep_duration_seconds': 28680, 'deep_sleep_seconds': 1440, 'light_sleep_seconds': 21720, 'rem_sleep_seconds': 5520, 'awake_seconds': 900, 'nap_duration_seconds': 0, 'sleep_score': 75, 'avg_sleep_stress': 24.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 169897)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,172 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741277500000, 'day': datetime.date(2025, 3, 7), 'sleep_start': datetime.datetime(2025, 3, 7, 0, 11, 40), 'sleep_end': datetime.datetime(2025, 3, 7, 7, 45, 14), 'sleep_duration_seconds': 25594, 'deep_sleep_seconds': 5340, 'light_sleep_seconds': 14760, 'rem_sleep_seconds': 5520, 'awake_seconds': 660, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 171788)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,174 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741367697000, 'day': datetime.date(2025, 3, 8), 'sleep_start': datetime.datetime(2025, 3, 8, 1, 14, 57), 'sleep_end': datetime.datetime(2025, 3, 8, 6, 8, 50), 'sleep_duration_seconds': 17573, 'deep_sleep_seconds': 3840, 'light_sleep_seconds': 9000, 'rem_sleep_seconds': 4740, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 64, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 173558)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,176 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741451022000, 'day': datetime.date(2025, 3, 9), 'sleep_start': datetime.datetime(2025, 3, 9, 0, 23, 42), 'sleep_end': datetime.datetime(2025, 3, 9, 7, 0, 9), 'sleep_duration_seconds': 22107, 'deep_sleep_seconds': 4500, 'light_sleep_seconds': 13860, 'rem_sleep_seconds': 3780, 'awake_seconds': 1680, 'nap_duration_seconds': 0, 'sleep_score': 70, 'avg_sleep_stress': 24.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 175755)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,178 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741536145000, 'day': datetime.date(2025, 3, 10), 'sleep_start': datetime.datetime(2025, 3, 10, 0, 2, 25), 'sleep_end': datetime.datetime(2025, 3, 10, 9, 1, 25), 'sleep_duration_seconds': 30060, 'deep_sleep_seconds': 2220, 'light_sleep_seconds': 18960, 'rem_sleep_seconds': 8880, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 25.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 177896)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,180 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741627040000, 'day': datetime.date(2025, 3, 11), 'sleep_start': datetime.datetime(2025, 3, 11, 1, 17, 20), 'sleep_end': datetime.datetime(2025, 3, 11, 7, 22, 54), 'sleep_duration_seconds': 18754, 'deep_sleep_seconds': 3300, 'light_sleep_seconds': 12120, 'rem_sleep_seconds': 3360, 'awake_seconds': 660, 'nap_duration_seconds': 0, 'sleep_score': 67, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 179695)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,181 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741790188000, 'day': datetime.date(2025, 3, 12), 'sleep_start': datetime.datetime(2025, 3, 12, 19, 36, 28), 'sleep_end': datetime.datetime(2025, 3, 12, 21, 59, 28), 'sleep_duration_seconds': 7980, 'deep_sleep_seconds': 3480, 'light_sleep_seconds': 3540, 'rem_sleep_seconds': 960, 'awake_seconds': 600, 'nap_duration_seconds': 0, 'sleep_score': 30, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 181369)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,182 - WARNING - No sleep ID found for 2025-03-13
2025-08-05 19:50:52,183 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1741964832000, 'day': datetime.date(2025, 3, 14), 'sleep_start': datetime.datetime(2025, 3, 14, 17, 7, 12), 'sleep_end': datetime.datetime(2025, 3, 14, 21, 3, 12), 'sleep_duration_seconds': 14160, 'deep_sleep_seconds': 7380, 'light_sleep_seconds': 4200, 'rem_sleep_seconds': 2580, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 51, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 420, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 183314)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,185 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742000206000, 'day': datetime.date(2025, 3, 15), 'sleep_start': datetime.datetime(2025, 3, 15, 2, 56, 46), 'sleep_end': datetime.datetime(2025, 3, 15, 7, 13, 7), 'sleep_duration_seconds': 15381, 'deep_sleep_seconds': 4740, 'light_sleep_seconds': 5940, 'rem_sleep_seconds': 4740, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 56, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 185210)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,186 - WARNING - No sleep ID found for 2025-03-16
2025-08-05 19:50:52,188 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742176367000, 'day': datetime.date(2025, 3, 17), 'sleep_start': datetime.datetime(2025, 3, 17, 3, 52, 47), 'sleep_end': datetime.datetime(2025, 3, 17, 9, 45, 47), 'sleep_duration_seconds': 19320, 'deep_sleep_seconds': 7200, 'light_sleep_seconds': 9060, 'rem_sleep_seconds': 3060, 'awake_seconds': 1860, 'nap_duration_seconds': 0, 'sleep_score': 67, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 187732)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,190 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742244024000, 'day': datetime.date(2025, 3, 18), 'sleep_start': datetime.datetime(2025, 3, 17, 22, 40, 24), 'sleep_end': datetime.datetime(2025, 3, 18, 7, 18, 2), 'sleep_duration_seconds': 29978, 'deep_sleep_seconds': 5460, 'light_sleep_seconds': 20640, 'rem_sleep_seconds': 3900, 'awake_seconds': 1080, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 190049)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,192 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742333663000, 'day': datetime.date(2025, 3, 19), 'sleep_start': datetime.datetime(2025, 3, 18, 23, 34, 23), 'sleep_end': datetime.datetime(2025, 3, 19, 6, 47, 23), 'sleep_duration_seconds': 23880, 'deep_sleep_seconds': 6660, 'light_sleep_seconds': 12960, 'rem_sleep_seconds': 4260, 'awake_seconds': 2100, 'nap_duration_seconds': 0, 'sleep_score': 75, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 192135)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,194 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742417244000, 'day': datetime.date(2025, 3, 20), 'sleep_start': datetime.datetime(2025, 3, 19, 22, 47, 24), 'sleep_end': datetime.datetime(2025, 3, 20, 7, 52, 24), 'sleep_duration_seconds': 31200, 'deep_sleep_seconds': 4920, 'light_sleep_seconds': 20880, 'rem_sleep_seconds': 5400, 'awake_seconds': 1500, 'nap_duration_seconds': 0, 'sleep_score': 82, 'avg_sleep_stress': 21.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 194349)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,196 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742509215000, 'day': datetime.date(2025, 3, 21), 'sleep_start': datetime.datetime(2025, 3, 21, 0, 20, 15), 'sleep_end': datetime.datetime(2025, 3, 21, 8, 25, 15), 'sleep_duration_seconds': 28260, 'deep_sleep_seconds': 7740, 'light_sleep_seconds': 12600, 'rem_sleep_seconds': 7920, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 92, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 196263)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,199 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742593324000, 'day': datetime.date(2025, 3, 22), 'sleep_start': datetime.datetime(2025, 3, 21, 23, 42, 4), 'sleep_end': datetime.datetime(2025, 3, 22, 7, 59, 4), 'sleep_duration_seconds': 27780, 'deep_sleep_seconds': 6480, 'light_sleep_seconds': 15360, 'rem_sleep_seconds': 5940, 'awake_seconds': 2040, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 198719)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,201 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742685870000, 'day': datetime.date(2025, 3, 23), 'sleep_start': datetime.datetime(2025, 3, 23, 1, 24, 30), 'sleep_end': datetime.datetime(2025, 3, 23, 7, 59, 6), 'sleep_duration_seconds': 23676, 'deep_sleep_seconds': 6780, 'light_sleep_seconds': 12660, 'rem_sleep_seconds': 4260, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 81, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 200902)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,203 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742766816000, 'day': datetime.date(2025, 3, 24), 'sleep_start': datetime.datetime(2025, 3, 23, 23, 53, 36), 'sleep_end': datetime.datetime(2025, 3, 24, 7, 41, 36), 'sleep_duration_seconds': 27960, 'deep_sleep_seconds': 9960, 'light_sleep_seconds': 11340, 'rem_sleep_seconds': 6660, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 93, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 203096)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,205 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742857109000, 'day': datetime.date(2025, 3, 25), 'sleep_start': datetime.datetime(2025, 3, 25, 0, 58, 29), 'sleep_end': datetime.datetime(2025, 3, 25, 8, 32, 29), 'sleep_duration_seconds': 26640, 'deep_sleep_seconds': 9240, 'light_sleep_seconds': 9420, 'rem_sleep_seconds': 7980, 'awake_seconds': 600, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 20.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 205234)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,207 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1742938051000, 'day': datetime.date(2025, 3, 26), 'sleep_start': datetime.datetime(2025, 3, 25, 23, 27, 31), 'sleep_end': datetime.datetime(2025, 3, 26, 7, 20, 31), 'sleep_duration_seconds': 28380, 'deep_sleep_seconds': 5520, 'light_sleep_seconds': 16740, 'rem_sleep_seconds': 6120, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 96, 'avg_sleep_stress': 6.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 207160)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,209 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743025273000, 'day': datetime.date(2025, 3, 27), 'sleep_start': datetime.datetime(2025, 3, 26, 23, 41, 13), 'sleep_end': datetime.datetime(2025, 3, 27, 8, 0, 13), 'sleep_duration_seconds': 29880, 'deep_sleep_seconds': 6900, 'light_sleep_seconds': 15720, 'rem_sleep_seconds': 7260, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 99, 'avg_sleep_stress': 11.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 209206)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,212 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743118928000, 'day': datetime.date(2025, 3, 28), 'sleep_start': datetime.datetime(2025, 3, 28, 1, 42, 8), 'sleep_end': datetime.datetime(2025, 3, 28, 9, 2, 8), 'sleep_duration_seconds': 25980, 'deep_sleep_seconds': 4800, 'light_sleep_seconds': 15840, 'rem_sleep_seconds': 5340, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 86, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 211688)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,214 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743203877000, 'day': datetime.date(2025, 3, 29), 'sleep_start': datetime.datetime(2025, 3, 29, 1, 17, 57), 'sleep_end': datetime.datetime(2025, 3, 29, 6, 0, 57), 'sleep_duration_seconds': 15000, 'deep_sleep_seconds': 2520, 'light_sleep_seconds': 8880, 'rem_sleep_seconds': 3600, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 55, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 213703)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,216 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743296400000, 'day': datetime.date(2025, 3, 30), 'sleep_start': datetime.datetime(2025, 3, 30, 5, 0), 'sleep_end': datetime.datetime(2025, 3, 30, 12, 30), 'sleep_duration_seconds': 26880, 'deep_sleep_seconds': 7440, 'light_sleep_seconds': 16020, 'rem_sleep_seconds': 3420, 'awake_seconds': 120, 'nap_duration_seconds': 7200, 'sleep_score': 87, 'avg_sleep_stress': 12.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 215901)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,218 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-03-31.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743368293000, 'day': datetime.date(2025, 3, 31), 'sleep_start': datetime.datetime(2025, 3, 31, 0, 58, 13), 'sleep_end': datetime.datetime(2025, 3, 31, 10, 0, 13), 'sleep_duration_seconds': 32460, 'deep_sleep_seconds': 6180, 'light_sleep_seconds': 14700, 'rem_sleep_seconds': 11580, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 93, 'avg_sleep_stress': 11.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 420, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 218402)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,221 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743454302000, 'day': datetime.date(2025, 4, 1), 'sleep_start': datetime.datetime(2025, 4, 1, 0, 51, 42), 'sleep_end': datetime.datetime(2025, 4, 1, 10, 17, 42), 'sleep_duration_seconds': 33780, 'deep_sleep_seconds': 5820, 'light_sleep_seconds': 17880, 'rem_sleep_seconds': 10080, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 93, 'avg_sleep_stress': 14.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 430, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 220511)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,223 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743543731000, 'day': datetime.date(2025, 4, 2), 'sleep_start': datetime.datetime(2025, 4, 2, 1, 42, 11), 'sleep_end': datetime.datetime(2025, 4, 2, 10, 20, 27), 'sleep_duration_seconds': 27376, 'deep_sleep_seconds': 3060, 'light_sleep_seconds': 17280, 'rem_sleep_seconds': 7080, 'awake_seconds': 2280, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 430, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 222866)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,225 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743633998000, 'day': datetime.date(2025, 4, 3), 'sleep_start': datetime.datetime(2025, 4, 3, 2, 46, 38), 'sleep_end': datetime.datetime(2025, 4, 3, 9, 13, 57), 'sleep_duration_seconds': 23239, 'deep_sleep_seconds': 5400, 'light_sleep_seconds': 12300, 'rem_sleep_seconds': 5580, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 224881)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,225 - WARNING - No sleep ID found for 2025-04-04
2025-08-05 19:50:52,227 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743809996000, 'day': datetime.date(2025, 4, 5), 'sleep_start': datetime.datetime(2025, 4, 5, 4, 39, 56), 'sleep_end': datetime.datetime(2025, 4, 5, 11, 3, 56), 'sleep_duration_seconds': 21780, 'deep_sleep_seconds': 2940, 'light_sleep_seconds': 16080, 'rem_sleep_seconds': 2760, 'awake_seconds': 1260, 'nap_duration_seconds': 0, 'sleep_score': 70, 'avg_sleep_stress': 20.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 226967)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,230 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743898366000, 'day': datetime.date(2025, 4, 6), 'sleep_start': datetime.datetime(2025, 4, 6, 5, 12, 46), 'sleep_end': datetime.datetime(2025, 4, 6, 11, 13, 46), 'sleep_duration_seconds': 21660, 'deep_sleep_seconds': 7080, 'light_sleep_seconds': 9720, 'rem_sleep_seconds': 4860, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 75, 'avg_sleep_stress': 17.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 229421)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,232 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1743978333000, 'day': datetime.date(2025, 4, 7), 'sleep_start': datetime.datetime(2025, 4, 7, 3, 25, 33), 'sleep_end': datetime.datetime(2025, 4, 7, 9, 0, 9), 'sleep_duration_seconds': 19956, 'deep_sleep_seconds': 7020, 'light_sleep_seconds': 9600, 'rem_sleep_seconds': 3360, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 70, 'avg_sleep_stress': 18.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 231529)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,234 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744058303000, 'day': datetime.date(2025, 4, 8), 'sleep_start': datetime.datetime(2025, 4, 8, 0, 38, 23), 'sleep_end': datetime.datetime(2025, 4, 8, 10, 30, 23), 'sleep_duration_seconds': 34380, 'deep_sleep_seconds': 6000, 'light_sleep_seconds': 17820, 'rem_sleep_seconds': 10560, 'awake_seconds': 600, 'nap_duration_seconds': 0, 'sleep_score': 93, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 234092)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,236 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744149467000, 'day': datetime.date(2025, 4, 9), 'sleep_start': datetime.datetime(2025, 4, 9, 1, 57, 47), 'sleep_end': datetime.datetime(2025, 4, 9, 8, 52, 47), 'sleep_duration_seconds': 22380, 'deep_sleep_seconds': 3360, 'light_sleep_seconds': 13680, 'rem_sleep_seconds': 5340, 'awake_seconds': 1320, 'nap_duration_seconds': 0, 'sleep_score': 76, 'avg_sleep_stress': 7.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 236043)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,238 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744235021000, 'day': datetime.date(2025, 4, 10), 'sleep_start': datetime.datetime(2025, 4, 10, 1, 43, 41), 'sleep_end': datetime.datetime(2025, 4, 10, 9, 0, 41), 'sleep_duration_seconds': 25320, 'deep_sleep_seconds': 8880, 'light_sleep_seconds': 9060, 'rem_sleep_seconds': 7380, 'awake_seconds': 900, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 13.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 237988)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,240 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744339469000, 'day': datetime.date(2025, 4, 11), 'sleep_start': datetime.datetime(2025, 4, 11, 6, 44, 29), 'sleep_end': datetime.datetime(2025, 4, 11, 10, 47, 29), 'sleep_duration_seconds': 14400, 'deep_sleep_seconds': 5100, 'light_sleep_seconds': 7080, 'rem_sleep_seconds': 2220, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 48, 'avg_sleep_stress': 30.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 13.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 239945)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,242 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744412006000, 'day': datetime.date(2025, 4, 12), 'sleep_start': datetime.datetime(2025, 4, 12, 2, 53, 26), 'sleep_end': datetime.datetime(2025, 4, 12, 10, 7, 26), 'sleep_duration_seconds': 26040, 'deep_sleep_seconds': 4080, 'light_sleep_seconds': 15600, 'rem_sleep_seconds': 6360, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 5.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 241882)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,244 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744494448000, 'day': datetime.date(2025, 4, 13), 'sleep_start': datetime.datetime(2025, 4, 13, 1, 47, 28), 'sleep_end': datetime.datetime(2025, 4, 13, 10, 46, 50), 'sleep_duration_seconds': 30262, 'deep_sleep_seconds': 4920, 'light_sleep_seconds': 14280, 'rem_sleep_seconds': 11100, 'awake_seconds': 300, 'nap_duration_seconds': 0, 'sleep_score': 91, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 244198)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,247 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744579800000, 'day': datetime.date(2025, 4, 14), 'sleep_start': datetime.datetime(2025, 4, 14, 1, 30), 'sleep_end': datetime.datetime(2025, 4, 14, 10, 37), 'sleep_duration_seconds': 29100, 'deep_sleep_seconds': 3360, 'light_sleep_seconds': 19860, 'rem_sleep_seconds': 5880, 'awake_seconds': 1800, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 16.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 246534)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,249 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744666099000, 'day': datetime.date(2025, 4, 15), 'sleep_start': datetime.datetime(2025, 4, 15, 1, 28, 19), 'sleep_end': datetime.datetime(2025, 4, 15, 8, 32, 19), 'sleep_duration_seconds': 25320, 'deep_sleep_seconds': 3240, 'light_sleep_seconds': 14460, 'rem_sleep_seconds': 7620, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 81, 'avg_sleep_stress': 15.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 248632)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,251 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744754464000, 'day': datetime.date(2025, 4, 16), 'sleep_start': datetime.datetime(2025, 4, 16, 2, 1, 4), 'sleep_end': datetime.datetime(2025, 4, 16, 8, 4, 4), 'sleep_duration_seconds': 19440, 'deep_sleep_seconds': 3420, 'light_sleep_seconds': 9960, 'rem_sleep_seconds': 6060, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 71, 'avg_sleep_stress': 7.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 250546)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,253 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744838706000, 'day': datetime.date(2025, 4, 17), 'sleep_start': datetime.datetime(2025, 4, 17, 1, 25, 6), 'sleep_end': datetime.datetime(2025, 4, 17, 10, 1, 6), 'sleep_duration_seconds': 29280, 'deep_sleep_seconds': 8580, 'light_sleep_seconds': 17520, 'rem_sleep_seconds': 3180, 'awake_seconds': 1680, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 18.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 252742)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,256 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1744925456000, 'day': datetime.date(2025, 4, 18), 'sleep_start': datetime.datetime(2025, 4, 18, 1, 30, 56), 'sleep_end': datetime.datetime(2025, 4, 18, 8, 44, 56), 'sleep_duration_seconds': 24360, 'deep_sleep_seconds': 4800, 'light_sleep_seconds': 12780, 'rem_sleep_seconds': 6780, 'awake_seconds': 1680, 'nap_duration_seconds': 0, 'sleep_score': 78, 'avg_sleep_stress': 21.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 255491)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,258 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745012736000, 'day': datetime.date(2025, 4, 19), 'sleep_start': datetime.datetime(2025, 4, 19, 1, 45, 36), 'sleep_end': datetime.datetime(2025, 4, 19, 10, 18, 36), 'sleep_duration_seconds': 28620, 'deep_sleep_seconds': 3540, 'light_sleep_seconds': 17640, 'rem_sleep_seconds': 7440, 'awake_seconds': 960, 'nap_duration_seconds': 0, 'sleep_score': 91, 'avg_sleep_stress': 8.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 258007)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,261 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745086741000, 'day': datetime.date(2025, 4, 20), 'sleep_start': datetime.datetime(2025, 4, 19, 22, 19, 1), 'sleep_end': datetime.datetime(2025, 4, 20, 9, 11, 1), 'sleep_duration_seconds': 34620, 'deep_sleep_seconds': 5640, 'light_sleep_seconds': 21600, 'rem_sleep_seconds': 7380, 'awake_seconds': 3420, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 7.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 260385)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,263 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745188694000, 'day': datetime.date(2025, 4, 21), 'sleep_start': datetime.datetime(2025, 4, 21, 2, 38, 14), 'sleep_end': datetime.datetime(2025, 4, 21, 10, 44, 14), 'sleep_duration_seconds': 26580, 'deep_sleep_seconds': 6960, 'light_sleep_seconds': 16500, 'rem_sleep_seconds': 3120, 'awake_seconds': 2580, 'nap_duration_seconds': 0, 'sleep_score': 66, 'avg_sleep_stress': 18.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 4, 'sleep_need_baseline': 480, 'sleep_need_actual': 440, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 262592)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,265 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745261846000, 'day': datetime.date(2025, 4, 22), 'sleep_start': datetime.datetime(2025, 4, 21, 22, 57, 26), 'sleep_end': datetime.datetime(2025, 4, 22, 10, 53, 26), 'sleep_duration_seconds': 41040, 'deep_sleep_seconds': 8100, 'light_sleep_seconds': 21720, 'rem_sleep_seconds': 11220, 'awake_seconds': 1920, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 10.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 264906)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,267 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745357799000, 'day': datetime.date(2025, 4, 23), 'sleep_start': datetime.datetime(2025, 4, 23, 1, 36, 39), 'sleep_end': datetime.datetime(2025, 4, 23, 7, 42, 28), 'sleep_duration_seconds': 21889, 'deep_sleep_seconds': 7260, 'light_sleep_seconds': 11040, 'rem_sleep_seconds': 3600, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 77, 'avg_sleep_stress': 9.0, 'avg_spo2': None, 'lowest_spo2': None, 'highest_spo2': None, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 430, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 267101)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,270 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745448434000, 'day': datetime.date(2025, 4, 24), 'sleep_start': datetime.datetime(2025, 4, 24, 2, 47, 14), 'sleep_end': datetime.datetime(2025, 4, 24, 9, 11, 2), 'sleep_duration_seconds': 22848, 'deep_sleep_seconds': 7020, 'light_sleep_seconds': 9540, 'rem_sleep_seconds': 6300, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 81, 'avg_sleep_stress': 10.0, 'avg_spo2': 95.0, 'lowest_spo2': 89, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 269571)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,272 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745530818000, 'day': datetime.date(2025, 4, 25), 'sleep_start': datetime.datetime(2025, 4, 25, 1, 40, 18), 'sleep_end': datetime.datetime(2025, 4, 25, 9, 16, 18), 'sleep_duration_seconds': 23700, 'deep_sleep_seconds': 3840, 'light_sleep_seconds': 13620, 'rem_sleep_seconds': 6240, 'awake_seconds': 1440, 'nap_duration_seconds': 0, 'sleep_score': 80, 'avg_sleep_stress': 8.0, 'avg_spo2': 95.0, 'lowest_spo2': 89, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 272089)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,274 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745614440000, 'day': datetime.date(2025, 4, 26), 'sleep_start': datetime.datetime(2025, 4, 26, 0, 54), 'sleep_end': datetime.datetime(2025, 4, 26, 8, 51), 'sleep_duration_seconds': 28140, 'deep_sleep_seconds': 6780, 'light_sleep_seconds': 16080, 'rem_sleep_seconds': 5280, 'awake_seconds': 480, 'nap_duration_seconds': 0, 'sleep_score': 94, 'avg_sleep_stress': 8.0, 'avg_spo2': 97.0, 'lowest_spo2': 90, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 274428)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,277 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745712068000, 'day': datetime.date(2025, 4, 27), 'sleep_start': datetime.datetime(2025, 4, 27, 4, 1, 8), 'sleep_end': datetime.datetime(2025, 4, 27, 9, 52, 8), 'sleep_duration_seconds': 20280, 'deep_sleep_seconds': 2640, 'light_sleep_seconds': 11160, 'rem_sleep_seconds': 6480, 'awake_seconds': 780, 'nap_duration_seconds': 0, 'sleep_score': 71, 'avg_sleep_stress': 7.0, 'avg_spo2': 98.0, 'lowest_spo2': 96, 'highest_spo2': 99, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 276619)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,280 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745789400000, 'day': datetime.date(2025, 4, 28), 'sleep_start': datetime.datetime(2025, 4, 28, 1, 30), 'sleep_end': datetime.datetime(2025, 4, 28, 10, 0), 'sleep_duration_seconds': 24420, 'deep_sleep_seconds': 4260, 'light_sleep_seconds': 16500, 'rem_sleep_seconds': 3660, 'awake_seconds': 1920, 'nap_duration_seconds': 0, 'sleep_score': 75, 'avg_sleep_stress': 13.0, 'avg_spo2': 98.0, 'lowest_spo2': 93, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 279451)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,282 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745877568000, 'day': datetime.date(2025, 4, 29), 'sleep_start': datetime.datetime(2025, 4, 29, 1, 59, 28), 'sleep_end': datetime.datetime(2025, 4, 29, 9, 2, 28), 'sleep_duration_seconds': 25020, 'deep_sleep_seconds': 3840, 'light_sleep_seconds': 15600, 'rem_sleep_seconds': 5580, 'awake_seconds': 360, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 20.0, 'avg_spo2': 96.0, 'lowest_spo2': 89, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 281730)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,284 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-04-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1745962749000, 'day': datetime.date(2025, 4, 30), 'sleep_start': datetime.datetime(2025, 4, 30, 1, 39, 9), 'sleep_end': datetime.datetime(2025, 4, 30, 8, 14, 9), 'sleep_duration_seconds': 20940, 'deep_sleep_seconds': 4140, 'light_sleep_seconds': 12840, 'rem_sleep_seconds': 3960, 'awake_seconds': 1800, 'nap_duration_seconds': 0, 'sleep_score': 72, 'avg_sleep_stress': 13.0, 'avg_spo2': 96.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 284305)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,286 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746065542000, 'day': datetime.date(2025, 5, 1), 'sleep_start': datetime.datetime(2025, 5, 1, 6, 12, 22), 'sleep_end': datetime.datetime(2025, 5, 1, 9, 51, 22), 'sleep_duration_seconds': 13020, 'deep_sleep_seconds': 3900, 'light_sleep_seconds': 9120, 'rem_sleep_seconds': 0, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 38, 'avg_sleep_stress': 31.0, 'avg_spo2': 95.0, 'lowest_spo2': 93, 'highest_spo2': 96, 'avg_respiration': 13.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 286442)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,289 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746145611000, 'day': datetime.date(2025, 5, 2), 'sleep_start': datetime.datetime(2025, 5, 2, 4, 26, 51), 'sleep_end': datetime.datetime(2025, 5, 2, 12, 19, 16), 'sleep_duration_seconds': 27805, 'deep_sleep_seconds': 11460, 'light_sleep_seconds': 10500, 'rem_sleep_seconds': 5880, 'awake_seconds': 540, 'nap_duration_seconds': 0, 'sleep_score': 92, 'avg_sleep_stress': 10.0, 'avg_spo2': 98.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 289160)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,291 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746245954000, 'day': datetime.date(2025, 5, 3), 'sleep_start': datetime.datetime(2025, 5, 3, 8, 19, 14), 'sleep_end': datetime.datetime(2025, 5, 3, 11, 25, 14), 'sleep_duration_seconds': 8640, 'deep_sleep_seconds': 2580, 'light_sleep_seconds': 6060, 'rem_sleep_seconds': 0, 'awake_seconds': 2520, 'nap_duration_seconds': 0, 'sleep_score': 30, 'avg_sleep_stress': 15.0, 'avg_spo2': 98.0, 'lowest_spo2': 97, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 290916)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,293 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746315310000, 'day': datetime.date(2025, 5, 4), 'sleep_start': datetime.datetime(2025, 5, 4, 3, 35, 10), 'sleep_end': datetime.datetime(2025, 5, 4, 9, 18, 10), 'sleep_duration_seconds': 19860, 'deep_sleep_seconds': 3780, 'light_sleep_seconds': 15480, 'rem_sleep_seconds': 600, 'awake_seconds': 720, 'nap_duration_seconds': 1020, 'sleep_score': 57, 'avg_sleep_stress': 20.0, 'avg_spo2': 96.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 13.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 292924)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,296 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746393807000, 'day': datetime.date(2025, 5, 5), 'sleep_start': datetime.datetime(2025, 5, 5, 1, 23, 27), 'sleep_end': datetime.datetime(2025, 5, 5, 10, 0, 11), 'sleep_duration_seconds': 25784, 'deep_sleep_seconds': 7260, 'light_sleep_seconds': 14400, 'rem_sleep_seconds': 4140, 'awake_seconds': 960, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 8.0, 'avg_spo2': 96.0, 'lowest_spo2': 88, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 295379)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,298 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746484955000, 'day': datetime.date(2025, 5, 6), 'sleep_start': datetime.datetime(2025, 5, 6, 2, 42, 35), 'sleep_end': datetime.datetime(2025, 5, 6, 10, 47, 35), 'sleep_duration_seconds': 27720, 'deep_sleep_seconds': 3960, 'light_sleep_seconds': 18060, 'rem_sleep_seconds': 5700, 'awake_seconds': 1380, 'nap_duration_seconds': 0, 'sleep_score': 87, 'avg_sleep_stress': 7.0, 'avg_spo2': 94.0, 'lowest_spo2': 82, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 298148)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,300 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746570026000, 'day': datetime.date(2025, 5, 7), 'sleep_start': datetime.datetime(2025, 5, 7, 2, 20, 26), 'sleep_end': datetime.datetime(2025, 5, 7, 9, 30, 26), 'sleep_duration_seconds': 25800, 'deep_sleep_seconds': 7440, 'light_sleep_seconds': 14340, 'rem_sleep_seconds': 4020, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 6.0, 'avg_spo2': 96.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 300405)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,303 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746657306000, 'day': datetime.date(2025, 5, 8), 'sleep_start': datetime.datetime(2025, 5, 8, 2, 35, 6), 'sleep_end': datetime.datetime(2025, 5, 8, 9, 20, 6), 'sleep_duration_seconds': 19500, 'deep_sleep_seconds': 3900, 'light_sleep_seconds': 9960, 'rem_sleep_seconds': 5640, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 71, 'avg_sleep_stress': 9.0, 'avg_spo2': 95.0, 'lowest_spo2': 87, 'highest_spo2': 98, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 303090)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,306 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746734697000, 'day': datetime.date(2025, 5, 9), 'sleep_start': datetime.datetime(2025, 5, 9, 0, 4, 57), 'sleep_end': datetime.datetime(2025, 5, 9, 8, 25, 57), 'sleep_duration_seconds': 28620, 'deep_sleep_seconds': 7620, 'light_sleep_seconds': 15420, 'rem_sleep_seconds': 5580, 'awake_seconds': 1440, 'nap_duration_seconds': 0, 'sleep_score': 89, 'avg_sleep_stress': 11.0, 'avg_spo2': 97.0, 'lowest_spo2': 91, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 306172)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,309 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746822600000, 'day': datetime.date(2025, 5, 10), 'sleep_start': datetime.datetime(2025, 5, 10, 0, 30), 'sleep_end': datetime.datetime(2025, 5, 10, 9, 45), 'sleep_duration_seconds': 31860, 'deep_sleep_seconds': 3600, 'light_sleep_seconds': 24540, 'rem_sleep_seconds': 3720, 'awake_seconds': 1440, 'nap_duration_seconds': 0, 'sleep_score': 80, 'avg_sleep_stress': 10.0, 'avg_spo2': 96.0, 'lowest_spo2': 85, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 308696)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,311 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1746910500000, 'day': datetime.date(2025, 5, 11), 'sleep_start': datetime.datetime(2025, 5, 11, 0, 55), 'sleep_end': datetime.datetime(2025, 5, 11, 7, 15), 'sleep_duration_seconds': 21060, 'deep_sleep_seconds': 5220, 'light_sleep_seconds': 13860, 'rem_sleep_seconds': 1980, 'awake_seconds': 1740, 'nap_duration_seconds': 4260, 'sleep_score': 69, 'avg_sleep_stress': 7.0, 'avg_spo2': 96.0, 'lowest_spo2': 93, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 310868)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,313 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747002660000, 'day': datetime.date(2025, 5, 12), 'sleep_start': datetime.datetime(2025, 5, 12, 2, 31), 'sleep_end': datetime.datetime(2025, 5, 12, 10, 0), 'sleep_duration_seconds': 26460, 'deep_sleep_seconds': 4380, 'light_sleep_seconds': 19200, 'rem_sleep_seconds': 2880, 'awake_seconds': 480, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 10.0, 'avg_spo2': 96.0, 'lowest_spo2': 91, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 430, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 313315)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,316 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747080000000, 'day': datetime.date(2025, 5, 13), 'sleep_start': datetime.datetime(2025, 5, 13, 0, 0), 'sleep_end': datetime.datetime(2025, 5, 13, 9, 59), 'sleep_duration_seconds': 32280, 'deep_sleep_seconds': 5040, 'light_sleep_seconds': 18600, 'rem_sleep_seconds': 8640, 'awake_seconds': 3660, 'nap_duration_seconds': 0, 'sleep_score': 61, 'avg_sleep_stress': 17.0, 'avg_spo2': 96.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 5, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 315884)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,319 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747169104000, 'day': datetime.date(2025, 5, 14), 'sleep_start': datetime.datetime(2025, 5, 14, 0, 45, 4), 'sleep_end': datetime.datetime(2025, 5, 14, 10, 6, 4), 'sleep_duration_seconds': 29340, 'deep_sleep_seconds': 6180, 'light_sleep_seconds': 19080, 'rem_sleep_seconds': 4080, 'awake_seconds': 2940, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 14.0, 'avg_spo2': 97.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 318396)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,321 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747281135000, 'day': datetime.date(2025, 5, 15), 'sleep_start': datetime.datetime(2025, 5, 15, 7, 52, 15), 'sleep_end': datetime.datetime(2025, 5, 15, 14, 57, 15), 'sleep_duration_seconds': 21840, 'deep_sleep_seconds': 6480, 'light_sleep_seconds': 12060, 'rem_sleep_seconds': 3300, 'awake_seconds': 2640, 'nap_duration_seconds': 0, 'sleep_score': 68, 'avg_sleep_stress': 21.0, 'avg_spo2': 96.0, 'lowest_spo2': 95, 'highest_spo2': 97, 'avg_respiration': 12.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 320858)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,324 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747341497000, 'day': datetime.date(2025, 5, 16), 'sleep_start': datetime.datetime(2025, 5, 16, 0, 38, 17), 'sleep_end': datetime.datetime(2025, 5, 16, 10, 44, 17), 'sleep_duration_seconds': 31920, 'deep_sleep_seconds': 4980, 'light_sleep_seconds': 15480, 'rem_sleep_seconds': 11460, 'awake_seconds': 540, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 9.0, 'avg_spo2': 96.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 323498)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,326 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747452967000, 'day': datetime.date(2025, 5, 17), 'sleep_start': datetime.datetime(2025, 5, 17, 7, 36, 7), 'sleep_end': datetime.datetime(2025, 5, 17, 12, 11, 7), 'sleep_duration_seconds': 16500, 'deep_sleep_seconds': 5520, 'light_sleep_seconds': 9840, 'rem_sleep_seconds': 1140, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 53, 'avg_sleep_stress': 27.0, 'avg_spo2': 96.0, 'lowest_spo2': 94, 'highest_spo2': 100, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 450, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 325432)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,326 - WARNING - No sleep ID found for 2025-05-18
2025-08-05 19:50:52,329 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747581533000, 'day': datetime.date(2025, 5, 19), 'sleep_start': datetime.datetime(2025, 5, 18, 19, 18, 53), 'sleep_end': datetime.datetime(2025, 5, 19, 10, 58, 53), 'sleep_duration_seconds': 47760, 'deep_sleep_seconds': 7020, 'light_sleep_seconds': 26520, 'rem_sleep_seconds': 14220, 'awake_seconds': 5760, 'nap_duration_seconds': 0, 'sleep_score': 73, 'avg_sleep_stress': 8.0, 'avg_spo2': 97.0, 'lowest_spo2': 93, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 328619)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,331 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747689773000, 'day': datetime.date(2025, 5, 20), 'sleep_start': datetime.datetime(2025, 5, 20, 1, 22, 53), 'sleep_end': datetime.datetime(2025, 5, 20, 10, 38, 53), 'sleep_duration_seconds': 32040, 'deep_sleep_seconds': 5700, 'light_sleep_seconds': 18120, 'rem_sleep_seconds': 8220, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 92, 'avg_sleep_stress': 15.0, 'avg_spo2': 98.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 331322)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,334 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747774049000, 'day': datetime.date(2025, 5, 21), 'sleep_start': datetime.datetime(2025, 5, 21, 0, 47, 29), 'sleep_end': datetime.datetime(2025, 5, 21, 9, 14, 29), 'sleep_duration_seconds': 30420, 'deep_sleep_seconds': 10260, 'light_sleep_seconds': 13860, 'rem_sleep_seconds': 6300, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 95, 'avg_sleep_stress': 7.0, 'avg_spo2': 95.0, 'lowest_spo2': 88, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 333706)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,336 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747864719000, 'day': datetime.date(2025, 5, 22), 'sleep_start': datetime.datetime(2025, 5, 22, 1, 58, 39), 'sleep_end': datetime.datetime(2025, 5, 22, 9, 44, 8), 'sleep_duration_seconds': 27569, 'deep_sleep_seconds': 9840, 'light_sleep_seconds': 12420, 'rem_sleep_seconds': 5340, 'awake_seconds': 360, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 13.0, 'avg_spo2': 96.0, 'lowest_spo2': 88, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 450, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 336079)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,338 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1747951291000, 'day': datetime.date(2025, 5, 23), 'sleep_start': datetime.datetime(2025, 5, 23, 2, 1, 31), 'sleep_end': datetime.datetime(2025, 5, 23, 7, 20, 31), 'sleep_duration_seconds': 17400, 'deep_sleep_seconds': 4200, 'light_sleep_seconds': 9180, 'rem_sleep_seconds': 4020, 'awake_seconds': 540, 'nap_duration_seconds': 0, 'sleep_score': 66, 'avg_sleep_stress': 20.0, 'avg_spo2': 97.0, 'lowest_spo2': 91, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 338143)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,340 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748053245000, 'day': datetime.date(2025, 5, 24), 'sleep_start': datetime.datetime(2025, 5, 24, 6, 20, 45), 'sleep_end': datetime.datetime(2025, 5, 24, 10, 32, 45), 'sleep_duration_seconds': 15120, 'deep_sleep_seconds': 3060, 'light_sleep_seconds': 12060, 'rem_sleep_seconds': 0, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 34, 'avg_sleep_stress': 82.0, 'avg_spo2': 94.0, 'lowest_spo2': 92, 'highest_spo2': 96, 'avg_respiration': 15.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 339961)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,342 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748141753000, 'day': datetime.date(2025, 5, 25), 'sleep_start': datetime.datetime(2025, 5, 25, 6, 55, 53), 'sleep_end': datetime.datetime(2025, 5, 25, 11, 0, 53), 'sleep_duration_seconds': 14700, 'deep_sleep_seconds': 5100, 'light_sleep_seconds': 8940, 'rem_sleep_seconds': 660, 'awake_seconds': 0, 'nap_duration_seconds': 1260, 'sleep_score': 35, 'avg_sleep_stress': 47.0, 'avg_spo2': 94.0, 'lowest_spo2': 91, 'highest_spo2': 97, 'avg_respiration': 13.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 341760)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,345 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748199732000, 'day': datetime.date(2025, 5, 26), 'sleep_start': datetime.datetime(2025, 5, 25, 23, 2, 12), 'sleep_end': datetime.datetime(2025, 5, 26, 10, 38, 12), 'sleep_duration_seconds': 30780, 'deep_sleep_seconds': 3900, 'light_sleep_seconds': 18840, 'rem_sleep_seconds': 8040, 'awake_seconds': 10980, 'nap_duration_seconds': 2280, 'sleep_score': 54, 'avg_sleep_stress': 39.0, 'avg_spo2': 95.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 15.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 345173)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,348 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748291666000, 'day': datetime.date(2025, 5, 27), 'sleep_start': datetime.datetime(2025, 5, 27, 0, 34, 26), 'sleep_end': datetime.datetime(2025, 5, 27, 10, 8, 26), 'sleep_duration_seconds': 34140, 'deep_sleep_seconds': 4440, 'light_sleep_seconds': 21480, 'rem_sleep_seconds': 8220, 'awake_seconds': 300, 'nap_duration_seconds': 0, 'sleep_score': 91, 'avg_sleep_stress': 8.0, 'avg_spo2': 94.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 348131)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,351 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748379443000, 'day': datetime.date(2025, 5, 28), 'sleep_start': datetime.datetime(2025, 5, 28, 0, 57, 23), 'sleep_end': datetime.datetime(2025, 5, 28, 9, 22, 23), 'sleep_duration_seconds': 30240, 'deep_sleep_seconds': 5880, 'light_sleep_seconds': 16620, 'rem_sleep_seconds': 7740, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 96, 'avg_sleep_stress': 8.0, 'avg_spo2': 98.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 351231)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,354 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748464163000, 'day': datetime.date(2025, 5, 29), 'sleep_start': datetime.datetime(2025, 5, 29, 0, 29, 23), 'sleep_end': datetime.datetime(2025, 5, 29, 10, 21, 23), 'sleep_duration_seconds': 34140, 'deep_sleep_seconds': 7560, 'light_sleep_seconds': 17400, 'rem_sleep_seconds': 9180, 'awake_seconds': 1380, 'nap_duration_seconds': 0, 'sleep_score': 94, 'avg_sleep_stress': 11.0, 'avg_spo2': 96.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 353852)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,357 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748552368000, 'day': datetime.date(2025, 5, 30), 'sleep_start': datetime.datetime(2025, 5, 30, 0, 59, 28), 'sleep_end': datetime.datetime(2025, 5, 30, 8, 51, 28), 'sleep_duration_seconds': 27540, 'deep_sleep_seconds': 6780, 'light_sleep_seconds': 16560, 'rem_sleep_seconds': 4200, 'awake_seconds': 780, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 12.0, 'avg_spo2': 97.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 356375)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,359 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-05-31.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748638395000, 'day': datetime.date(2025, 5, 31), 'sleep_start': datetime.datetime(2025, 5, 31, 0, 53, 15), 'sleep_end': datetime.datetime(2025, 5, 31, 10, 14, 15), 'sleep_duration_seconds': 30840, 'deep_sleep_seconds': 2700, 'light_sleep_seconds': 21840, 'rem_sleep_seconds': 6300, 'awake_seconds': 2820, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 9.0, 'avg_spo2': 95.0, 'lowest_spo2': 83, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 358972)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,361 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748728865000, 'day': datetime.date(2025, 6, 1), 'sleep_start': datetime.datetime(2025, 6, 1, 2, 1, 5), 'sleep_end': datetime.datetime(2025, 6, 1, 8, 23, 5), 'sleep_duration_seconds': 22140, 'deep_sleep_seconds': 4860, 'light_sleep_seconds': 15000, 'rem_sleep_seconds': 2280, 'awake_seconds': 780, 'nap_duration_seconds': 0, 'sleep_score': 74, 'avg_sleep_stress': 15.0, 'avg_spo2': 96.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 361155)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,364 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748818253000, 'day': datetime.date(2025, 6, 2), 'sleep_start': datetime.datetime(2025, 6, 2, 2, 50, 53), 'sleep_end': datetime.datetime(2025, 6, 2, 9, 36, 53), 'sleep_duration_seconds': 21840, 'deep_sleep_seconds': 7860, 'light_sleep_seconds': 11220, 'rem_sleep_seconds': 2760, 'awake_seconds': 2520, 'nap_duration_seconds': 0, 'sleep_score': 67, 'avg_sleep_stress': 22.0, 'avg_spo2': 97.0, 'lowest_spo2': 94, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 363480)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,366 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748896866000, 'day': datetime.date(2025, 6, 3), 'sleep_start': datetime.datetime(2025, 6, 3, 0, 41, 6), 'sleep_end': datetime.datetime(2025, 6, 3, 8, 38, 6), 'sleep_duration_seconds': 28380, 'deep_sleep_seconds': 3600, 'light_sleep_seconds': 18480, 'rem_sleep_seconds': 6300, 'awake_seconds': 240, 'nap_duration_seconds': 0, 'sleep_score': 92, 'avg_sleep_stress': 10.0, 'avg_spo2': 97.0, 'lowest_spo2': 91, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 365876)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,369 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1748985359000, 'day': datetime.date(2025, 6, 4), 'sleep_start': datetime.datetime(2025, 6, 4, 1, 15, 59), 'sleep_end': datetime.datetime(2025, 6, 4, 8, 42, 59), 'sleep_duration_seconds': 26580, 'deep_sleep_seconds': 4500, 'light_sleep_seconds': 15600, 'rem_sleep_seconds': 6480, 'awake_seconds': 240, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 11.0, 'avg_spo2': 96.0, 'lowest_spo2': 90, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 368529)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,372 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749070242000, 'day': datetime.date(2025, 6, 5), 'sleep_start': datetime.datetime(2025, 6, 5, 0, 50, 42), 'sleep_end': datetime.datetime(2025, 6, 5, 9, 45, 42), 'sleep_duration_seconds': 31680, 'deep_sleep_seconds': 7860, 'light_sleep_seconds': 16560, 'rem_sleep_seconds': 7260, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 89, 'avg_sleep_stress': 19.0, 'avg_spo2': 94.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 371548)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,374 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749161528000, 'day': datetime.date(2025, 6, 6), 'sleep_start': datetime.datetime(2025, 6, 6, 2, 12, 8), 'sleep_end': datetime.datetime(2025, 6, 6, 9, 11, 8), 'sleep_duration_seconds': 24840, 'deep_sleep_seconds': 3840, 'light_sleep_seconds': 15660, 'rem_sleep_seconds': 5340, 'awake_seconds': 300, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 10.0, 'avg_spo2': 96.0, 'lowest_spo2': 88, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 374233)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,377 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749246703000, 'day': datetime.date(2025, 6, 7), 'sleep_start': datetime.datetime(2025, 6, 7, 1, 51, 43), 'sleep_end': datetime.datetime(2025, 6, 7, 9, 46, 43), 'sleep_duration_seconds': 28380, 'deep_sleep_seconds': 2940, 'light_sleep_seconds': 22500, 'rem_sleep_seconds': 2940, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 7.0, 'avg_spo2': 95.0, 'lowest_spo2': 89, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 376623)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,379 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749337276000, 'day': datetime.date(2025, 6, 8), 'sleep_start': datetime.datetime(2025, 6, 8, 3, 1, 16), 'sleep_end': datetime.datetime(2025, 6, 8, 9, 46, 16), 'sleep_duration_seconds': 23880, 'deep_sleep_seconds': 4740, 'light_sleep_seconds': 14760, 'rem_sleep_seconds': 4380, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 82, 'avg_sleep_stress': 7.0, 'avg_spo2': 92.0, 'lowest_spo2': 83, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 378736)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,382 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749423995000, 'day': datetime.date(2025, 6, 9), 'sleep_start': datetime.datetime(2025, 6, 9, 3, 6, 35), 'sleep_end': datetime.datetime(2025, 6, 9, 9, 43, 58), 'sleep_duration_seconds': 20243, 'deep_sleep_seconds': 1260, 'light_sleep_seconds': 15300, 'rem_sleep_seconds': 3720, 'awake_seconds': 2220, 'nap_duration_seconds': 0, 'sleep_score': 67, 'avg_sleep_stress': 5.0, 'avg_spo2': 96.0, 'lowest_spo2': 90, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 381415)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,384 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749503773000, 'day': datetime.date(2025, 6, 10), 'sleep_start': datetime.datetime(2025, 6, 10, 1, 16, 13), 'sleep_end': datetime.datetime(2025, 6, 10, 8, 37, 45), 'sleep_duration_seconds': 20912, 'deep_sleep_seconds': 2880, 'light_sleep_seconds': 14220, 'rem_sleep_seconds': 3840, 'awake_seconds': 4740, 'nap_duration_seconds': 0, 'sleep_score': 57, 'avg_sleep_stress': 23.0, 'avg_spo2': 96.0, 'lowest_spo2': 88, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 4, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 384255)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,387 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749590518000, 'day': datetime.date(2025, 6, 11), 'sleep_start': datetime.datetime(2025, 6, 11, 1, 21, 58), 'sleep_end': datetime.datetime(2025, 6, 11, 9, 55, 57), 'sleep_duration_seconds': 28979, 'deep_sleep_seconds': 7320, 'light_sleep_seconds': 15000, 'rem_sleep_seconds': 6660, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 98, 'avg_sleep_stress': 7.0, 'avg_spo2': 96.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 386917)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,390 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749674446000, 'day': datetime.date(2025, 6, 12), 'sleep_start': datetime.datetime(2025, 6, 12, 0, 40, 46), 'sleep_end': datetime.datetime(2025, 6, 12, 8, 43, 46), 'sleep_duration_seconds': 27420, 'deep_sleep_seconds': 3960, 'light_sleep_seconds': 15600, 'rem_sleep_seconds': 7860, 'awake_seconds': 1560, 'nap_duration_seconds': 0, 'sleep_score': 87, 'avg_sleep_stress': 11.0, 'avg_spo2': 98.0, 'lowest_spo2': 89, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 390059)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,405 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-13.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749760856000, 'day': datetime.date(2025, 6, 13), 'sleep_start': datetime.datetime(2025, 6, 13, 0, 40, 56), 'sleep_end': datetime.datetime(2025, 6, 13, 9, 51, 32), 'sleep_duration_seconds': 32676, 'deep_sleep_seconds': 7620, 'light_sleep_seconds': 18480, 'rem_sleep_seconds': 6600, 'awake_seconds': 360, 'nap_duration_seconds': 0, 'sleep_score': 93, 'avg_sleep_stress': 6.0, 'avg_spo2': 96.0, 'lowest_spo2': 89, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 404187)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,407 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749852092000, 'day': datetime.date(2025, 6, 14), 'sleep_start': datetime.datetime(2025, 6, 14, 2, 1, 32), 'sleep_end': datetime.datetime(2025, 6, 14, 9, 1, 32), 'sleep_duration_seconds': 25020, 'deep_sleep_seconds': 7680, 'light_sleep_seconds': 13200, 'rem_sleep_seconds': 4140, 'awake_seconds': 180, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 9.0, 'avg_spo2': 96.0, 'lowest_spo2': 85, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 407282)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,410 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1749940119000, 'day': datetime.date(2025, 6, 15), 'sleep_start': datetime.datetime(2025, 6, 15, 2, 28, 39), 'sleep_end': datetime.datetime(2025, 6, 15, 9, 42, 39), 'sleep_duration_seconds': 24060, 'deep_sleep_seconds': 3540, 'light_sleep_seconds': 16080, 'rem_sleep_seconds': 4440, 'awake_seconds': 1980, 'nap_duration_seconds': 0, 'sleep_score': 73, 'avg_sleep_stress': 19.0, 'avg_spo2': 98.0, 'lowest_spo2': 91, 'highest_spo2': 100, 'avg_respiration': 12.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 410051)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,413 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750025663000, 'day': datetime.date(2025, 6, 16), 'sleep_start': datetime.datetime(2025, 6, 16, 2, 14, 23), 'sleep_end': datetime.datetime(2025, 6, 16, 9, 21, 3), 'sleep_duration_seconds': 25540, 'deep_sleep_seconds': 8280, 'light_sleep_seconds': 12420, 'rem_sleep_seconds': 4860, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 10.0, 'avg_spo2': 97.0, 'lowest_spo2': 91, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 412809)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,416 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750108902000, 'day': datetime.date(2025, 6, 17), 'sleep_start': datetime.datetime(2025, 6, 17, 1, 21, 42), 'sleep_end': datetime.datetime(2025, 6, 17, 9, 24, 42), 'sleep_duration_seconds': 27660, 'deep_sleep_seconds': 7020, 'light_sleep_seconds': 14700, 'rem_sleep_seconds': 5940, 'awake_seconds': 1320, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 9.0, 'avg_spo2': 97.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 415518)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,418 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750198018000, 'day': datetime.date(2025, 6, 18), 'sleep_start': datetime.datetime(2025, 6, 18, 2, 6, 58), 'sleep_end': datetime.datetime(2025, 6, 18, 9, 28, 58), 'sleep_duration_seconds': 26160, 'deep_sleep_seconds': 9180, 'light_sleep_seconds': 10560, 'rem_sleep_seconds': 6420, 'awake_seconds': 360, 'nap_duration_seconds': 0, 'sleep_score': 89, 'avg_sleep_stress': 8.0, 'avg_spo2': 96.0, 'lowest_spo2': 90, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 417914)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,421 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750276813000, 'day': datetime.date(2025, 6, 19), 'sleep_start': datetime.datetime(2025, 6, 19, 0, 0, 13), 'sleep_end': datetime.datetime(2025, 6, 19, 9, 35, 5), 'sleep_duration_seconds': 32092, 'deep_sleep_seconds': 7080, 'light_sleep_seconds': 18660, 'rem_sleep_seconds': 6360, 'awake_seconds': 2400, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 14.0, 'avg_spo2': 93.0, 'lowest_spo2': 82, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 420500)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,423 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750366937000, 'day': datetime.date(2025, 6, 20), 'sleep_start': datetime.datetime(2025, 6, 20, 1, 2, 17), 'sleep_end': datetime.datetime(2025, 6, 20, 6, 45, 17), 'sleep_duration_seconds': 17700, 'deep_sleep_seconds': 3420, 'light_sleep_seconds': 9660, 'rem_sleep_seconds': 4620, 'awake_seconds': 1980, 'nap_duration_seconds': 0, 'sleep_score': 63, 'avg_sleep_stress': 10.0, 'avg_spo2': 96.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 423083)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,426 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750450438000, 'day': datetime.date(2025, 6, 21), 'sleep_start': datetime.datetime(2025, 6, 21, 0, 13, 58), 'sleep_end': datetime.datetime(2025, 6, 21, 9, 26, 58), 'sleep_duration_seconds': 30960, 'deep_sleep_seconds': 8340, 'light_sleep_seconds': 20280, 'rem_sleep_seconds': 2340, 'awake_seconds': 2220, 'nap_duration_seconds': 0, 'sleep_score': 72, 'avg_sleep_stress': 20.0, 'avg_spo2': 97.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 520, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 425942)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,426 - WARNING - No sleep ID found for 2025-06-22
2025-08-05 19:50:52,429 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750624404000, 'day': datetime.date(2025, 6, 23), 'sleep_start': datetime.datetime(2025, 6, 23, 0, 33, 24), 'sleep_end': datetime.datetime(2025, 6, 23, 9, 38, 39), 'sleep_duration_seconds': 30195, 'deep_sleep_seconds': 7200, 'light_sleep_seconds': 18180, 'rem_sleep_seconds': 4860, 'awake_seconds': 2520, 'nap_duration_seconds': 0, 'sleep_score': 77, 'avg_sleep_stress': 22.0, 'avg_spo2': 95.0, 'lowest_spo2': 88, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 428718)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,431 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750712650000, 'day': datetime.date(2025, 6, 24), 'sleep_start': datetime.datetime(2025, 6, 24, 1, 4, 10), 'sleep_end': datetime.datetime(2025, 6, 24, 10, 30, 10), 'sleep_duration_seconds': 32340, 'deep_sleep_seconds': 4080, 'light_sleep_seconds': 22320, 'rem_sleep_seconds': 5940, 'awake_seconds': 1620, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 12.0, 'avg_spo2': 97.0, 'lowest_spo2': 90, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 431307)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,434 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750803056000, 'day': datetime.date(2025, 6, 25), 'sleep_start': datetime.datetime(2025, 6, 25, 2, 10, 56), 'sleep_end': datetime.datetime(2025, 6, 25, 10, 9, 56), 'sleep_duration_seconds': 28500, 'deep_sleep_seconds': 3540, 'light_sleep_seconds': 19200, 'rem_sleep_seconds': 5760, 'awake_seconds': 240, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 8.0, 'avg_spo2': 97.0, 'lowest_spo2': 88, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 433735)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,436 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750884382000, 'day': datetime.date(2025, 6, 26), 'sleep_start': datetime.datetime(2025, 6, 26, 0, 46, 22), 'sleep_end': datetime.datetime(2025, 6, 26, 9, 42, 22), 'sleep_duration_seconds': 30600, 'deep_sleep_seconds': 7260, 'light_sleep_seconds': 16260, 'rem_sleep_seconds': 7080, 'awake_seconds': 1560, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 22.0, 'avg_spo2': 98.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 436304)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,438 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1750983023000, 'day': datetime.date(2025, 6, 27), 'sleep_start': datetime.datetime(2025, 6, 27, 4, 10, 23), 'sleep_end': datetime.datetime(2025, 6, 27, 8, 42, 23), 'sleep_duration_seconds': 15900, 'deep_sleep_seconds': 7620, 'light_sleep_seconds': 6000, 'rem_sleep_seconds': 2280, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 56, 'avg_sleep_stress': 18.0, 'avg_spo2': 95.0, 'lowest_spo2': 89, 'highest_spo2': 99, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 438329)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,439 - WARNING - No sleep ID found for 2025-06-28
2025-08-05 19:50:52,439 - WARNING - No sleep ID found for 2025-06-29
2025-08-05 19:50:52,441 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-06-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751246322000, 'day': datetime.date(2025, 6, 30), 'sleep_start': datetime.datetime(2025, 6, 30, 5, 18, 42), 'sleep_end': datetime.datetime(2025, 6, 30, 9, 1, 42), 'sleep_duration_seconds': 13380, 'deep_sleep_seconds': 5580, 'light_sleep_seconds': 6360, 'rem_sleep_seconds': 1440, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 49, 'avg_sleep_stress': 11.0, 'avg_spo2': 95.0, 'lowest_spo2': 88, 'highest_spo2': 99, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 440695)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,444 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751318502000, 'day': datetime.date(2025, 7, 1), 'sleep_start': datetime.datetime(2025, 7, 1, 1, 21, 42), 'sleep_end': datetime.datetime(2025, 7, 1, 11, 46), 'sleep_duration_seconds': 37038, 'deep_sleep_seconds': 6060, 'light_sleep_seconds': 20100, 'rem_sleep_seconds': 10920, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 92, 'avg_sleep_stress': 12.0, 'avg_spo2': 97.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 500, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 444260)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,447 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751404059000, 'day': datetime.date(2025, 7, 2), 'sleep_start': datetime.datetime(2025, 7, 2, 1, 7, 39), 'sleep_end': datetime.datetime(2025, 7, 2, 11, 18, 39), 'sleep_duration_seconds': 36540, 'deep_sleep_seconds': 8100, 'light_sleep_seconds': 18900, 'rem_sleep_seconds': 9540, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 97, 'avg_sleep_stress': 12.0, 'avg_spo2': 96.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 447123)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,449 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751493270000, 'day': datetime.date(2025, 7, 3), 'sleep_start': datetime.datetime(2025, 7, 3, 1, 54, 30), 'sleep_end': datetime.datetime(2025, 7, 3, 4, 54, 30), 'sleep_duration_seconds': 10800, 'deep_sleep_seconds': 6120, 'light_sleep_seconds': 3900, 'rem_sleep_seconds': 780, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 40, 'avg_sleep_stress': 16.0, 'avg_spo2': 96.0, 'lowest_spo2': 92, 'highest_spo2': 99, 'avg_respiration': 12.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 430, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 449146)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,452 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751573120000, 'day': datetime.date(2025, 7, 4), 'sleep_start': datetime.datetime(2025, 7, 4, 0, 5, 20), 'sleep_end': datetime.datetime(2025, 7, 4, 10, 38, 20), 'sleep_duration_seconds': 37140, 'deep_sleep_seconds': 6840, 'light_sleep_seconds': 18600, 'rem_sleep_seconds': 11700, 'awake_seconds': 840, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 13.0, 'avg_spo2': 95.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 452132)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,455 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-05.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751679987000, 'day': datetime.date(2025, 7, 5), 'sleep_start': datetime.datetime(2025, 7, 5, 5, 46, 27), 'sleep_end': datetime.datetime(2025, 7, 5, 11, 5, 27), 'sleep_duration_seconds': 18480, 'deep_sleep_seconds': 3660, 'light_sleep_seconds': 11760, 'rem_sleep_seconds': 3060, 'awake_seconds': 660, 'nap_duration_seconds': 4560, 'sleep_score': 50, 'avg_sleep_stress': 41.0, 'avg_spo2': 94.0, 'lowest_spo2': 91, 'highest_spo2': 96, 'avg_respiration': 12.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 454765)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,457 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-06.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751754972000, 'day': datetime.date(2025, 7, 6), 'sleep_start': datetime.datetime(2025, 7, 6, 2, 36, 12), 'sleep_end': datetime.datetime(2025, 7, 6, 10, 11, 12), 'sleep_duration_seconds': 27060, 'deep_sleep_seconds': 7680, 'light_sleep_seconds': 10740, 'rem_sleep_seconds': 8640, 'awake_seconds': 240, 'nap_duration_seconds': 0, 'sleep_score': 88, 'avg_sleep_stress': 14.0, 'avg_spo2': 95.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 457152)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,460 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-07.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751833584000, 'day': datetime.date(2025, 7, 7), 'sleep_start': datetime.datetime(2025, 7, 7, 0, 26, 24), 'sleep_end': datetime.datetime(2025, 7, 7, 9, 0, 18), 'sleep_duration_seconds': 30234, 'deep_sleep_seconds': 5700, 'light_sleep_seconds': 16740, 'rem_sleep_seconds': 7800, 'awake_seconds': 600, 'nap_duration_seconds': 0, 'sleep_score': 96, 'avg_sleep_stress': 9.0, 'avg_spo2': 96.0, 'lowest_spo2': 94, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 459640)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,462 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-08.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1751922151000, 'day': datetime.date(2025, 7, 8), 'sleep_start': datetime.datetime(2025, 7, 8, 1, 2, 31), 'sleep_end': datetime.datetime(2025, 7, 8, 8, 32, 7), 'sleep_duration_seconds': 26976, 'deep_sleep_seconds': 3540, 'light_sleep_seconds': 16200, 'rem_sleep_seconds': 7260, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 7.0, 'avg_spo2': 94.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 450, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 461990)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,465 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-09.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752008673000, 'day': datetime.date(2025, 7, 9), 'sleep_start': datetime.datetime(2025, 7, 9, 1, 4, 33), 'sleep_end': datetime.datetime(2025, 7, 9, 9, 18, 33), 'sleep_duration_seconds': 28080, 'deep_sleep_seconds': 6120, 'light_sleep_seconds': 19380, 'rem_sleep_seconds': 2580, 'awake_seconds': 1560, 'nap_duration_seconds': 0, 'sleep_score': 80, 'avg_sleep_stress': 5.0, 'avg_spo2': 94.0, 'lowest_spo2': 83, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 464802)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,468 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-10.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752092668000, 'day': datetime.date(2025, 7, 10), 'sleep_start': datetime.datetime(2025, 7, 10, 0, 24, 28), 'sleep_end': datetime.datetime(2025, 7, 10, 8, 22, 27), 'sleep_duration_seconds': 28079, 'deep_sleep_seconds': 5160, 'light_sleep_seconds': 14640, 'rem_sleep_seconds': 8280, 'awake_seconds': 600, 'nap_duration_seconds': 0, 'sleep_score': 95, 'avg_sleep_stress': 11.0, 'avg_spo2': 94.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 467677)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,471 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-11.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752182343000, 'day': datetime.date(2025, 7, 11), 'sleep_start': datetime.datetime(2025, 7, 11, 1, 19, 3), 'sleep_end': datetime.datetime(2025, 7, 11, 9, 40, 3), 'sleep_duration_seconds': 29580, 'deep_sleep_seconds': 5880, 'light_sleep_seconds': 17340, 'rem_sleep_seconds': 6360, 'awake_seconds': 480, 'nap_duration_seconds': 0, 'sleep_score': 96, 'avg_sleep_stress': 6.0, 'avg_spo2': 94.0, 'lowest_spo2': 85, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 470623)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,473 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-12.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752273639000, 'day': datetime.date(2025, 7, 12), 'sleep_start': datetime.datetime(2025, 7, 12, 2, 40, 39), 'sleep_end': datetime.datetime(2025, 7, 12, 10, 59, 39), 'sleep_duration_seconds': 24960, 'deep_sleep_seconds': 3060, 'light_sleep_seconds': 15480, 'rem_sleep_seconds': 6420, 'awake_seconds': 4980, 'nap_duration_seconds': 0, 'sleep_score': 61, 'avg_sleep_stress': 19.0, 'avg_spo2': 96.0, 'lowest_spo2': 91, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 4, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 473030)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,474 - WARNING - No sleep ID found for 2025-07-13
2025-08-05 19:50:52,476 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-14.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752441300000, 'day': datetime.date(2025, 7, 14), 'sleep_start': datetime.datetime(2025, 7, 14, 1, 15), 'sleep_end': datetime.datetime(2025, 7, 14, 10, 40), 'sleep_duration_seconds': 32280, 'deep_sleep_seconds': 3240, 'light_sleep_seconds': 25860, 'rem_sleep_seconds': 3180, 'awake_seconds': 300, 'nap_duration_seconds': 0, 'sleep_score': 61, 'avg_sleep_stress': 37.0, 'avg_spo2': 96.0, 'lowest_spo2': 85, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 475884)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,478 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-15.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752529731000, 'day': datetime.date(2025, 7, 15), 'sleep_start': datetime.datetime(2025, 7, 15, 1, 48, 51), 'sleep_end': datetime.datetime(2025, 7, 15, 9, 58, 51), 'sleep_duration_seconds': 27120, 'deep_sleep_seconds': 6240, 'light_sleep_seconds': 15120, 'rem_sleep_seconds': 5760, 'awake_seconds': 300, 'nap_duration_seconds': 0, 'sleep_score': 91, 'avg_sleep_stress': 10.0, 'avg_spo2': 94.0, 'lowest_spo2': 86, 'highest_spo2': 99, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 478418)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,481 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-16.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752617408000, 'day': datetime.date(2025, 7, 16), 'sleep_start': datetime.datetime(2025, 7, 16, 2, 10, 8), 'sleep_end': datetime.datetime(2025, 7, 16, 10, 1, 8), 'sleep_duration_seconds': 27300, 'deep_sleep_seconds': 9180, 'light_sleep_seconds': 11220, 'rem_sleep_seconds': 6900, 'awake_seconds': 960, 'nap_duration_seconds': 0, 'sleep_score': 89, 'avg_sleep_stress': 8.0, 'avg_spo2': 94.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 480998)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,484 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-17.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752698817000, 'day': datetime.date(2025, 7, 17), 'sleep_start': datetime.datetime(2025, 7, 17, 0, 46, 57), 'sleep_end': datetime.datetime(2025, 7, 17, 9, 53, 10), 'sleep_duration_seconds': 32233, 'deep_sleep_seconds': 9660, 'light_sleep_seconds': 13320, 'rem_sleep_seconds': 9300, 'awake_seconds': 540, 'nap_duration_seconds': 0, 'sleep_score': 99, 'avg_sleep_stress': 9.0, 'avg_spo2': 94.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 483975)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,486 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-18.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752786480000, 'day': datetime.date(2025, 7, 18), 'sleep_start': datetime.datetime(2025, 7, 18, 1, 8), 'sleep_end': datetime.datetime(2025, 7, 18, 9, 13, 58), 'sleep_duration_seconds': 28378, 'deep_sleep_seconds': 5460, 'light_sleep_seconds': 14580, 'rem_sleep_seconds': 8340, 'awake_seconds': 780, 'nap_duration_seconds': 0, 'sleep_score': 94, 'avg_sleep_stress': 7.0, 'avg_spo2': 94.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 450, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 486418)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,489 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-19.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752877518000, 'day': datetime.date(2025, 7, 19), 'sleep_start': datetime.datetime(2025, 7, 19, 2, 25, 18), 'sleep_end': datetime.datetime(2025, 7, 19, 9, 43, 18), 'sleep_duration_seconds': 24960, 'deep_sleep_seconds': 3660, 'light_sleep_seconds': 18360, 'rem_sleep_seconds': 2940, 'awake_seconds': 1320, 'nap_duration_seconds': 0, 'sleep_score': 79, 'avg_sleep_stress': 6.0, 'avg_spo2': 95.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 489194)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,492 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-20.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1752962019000, 'day': datetime.date(2025, 7, 20), 'sleep_start': datetime.datetime(2025, 7, 20, 1, 53, 39), 'sleep_end': datetime.datetime(2025, 7, 20, 8, 51, 39), 'sleep_duration_seconds': 24840, 'deep_sleep_seconds': 3900, 'light_sleep_seconds': 16020, 'rem_sleep_seconds': 4920, 'awake_seconds': 240, 'nap_duration_seconds': 0, 'sleep_score': 85, 'avg_sleep_stress': 7.0, 'avg_spo2': 97.0, 'lowest_spo2': 92, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 491804)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,495 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-21.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753044933000, 'day': datetime.date(2025, 7, 21), 'sleep_start': datetime.datetime(2025, 7, 21, 0, 55, 33), 'sleep_end': datetime.datetime(2025, 7, 21, 9, 30, 31), 'sleep_duration_seconds': 28378, 'deep_sleep_seconds': 7080, 'light_sleep_seconds': 13320, 'rem_sleep_seconds': 7980, 'awake_seconds': 1020, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 15.0, 'avg_spo2': 95.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 494671)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,497 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-22.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753134216000, 'day': datetime.date(2025, 7, 22), 'sleep_start': datetime.datetime(2025, 7, 22, 1, 43, 36), 'sleep_end': datetime.datetime(2025, 7, 22, 9, 2, 18), 'sleep_duration_seconds': 25902, 'deep_sleep_seconds': 4740, 'light_sleep_seconds': 17580, 'rem_sleep_seconds': 3600, 'awake_seconds': 420, 'nap_duration_seconds': 0, 'sleep_score': 83, 'avg_sleep_stress': 7.0, 'avg_spo2': 94.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 496963)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,500 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-23.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753218356000, 'day': datetime.date(2025, 7, 23), 'sleep_start': datetime.datetime(2025, 7, 23, 1, 5, 56), 'sleep_end': datetime.datetime(2025, 7, 23, 9, 26, 56), 'sleep_duration_seconds': 28380, 'deep_sleep_seconds': 6960, 'light_sleep_seconds': 16800, 'rem_sleep_seconds': 4620, 'awake_seconds': 1680, 'nap_duration_seconds': 0, 'sleep_score': 87, 'avg_sleep_stress': 14.0, 'avg_spo2': 95.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 499562)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,502 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-24.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753305962000, 'day': datetime.date(2025, 7, 24), 'sleep_start': datetime.datetime(2025, 7, 24, 1, 26, 2), 'sleep_end': datetime.datetime(2025, 7, 24, 9, 0, 2), 'sleep_duration_seconds': 26700, 'deep_sleep_seconds': 5160, 'light_sleep_seconds': 15900, 'rem_sleep_seconds': 5640, 'awake_seconds': 540, 'nap_duration_seconds': 0, 'sleep_score': 89, 'avg_sleep_stress': 7.0, 'avg_spo2': 95.0, 'lowest_spo2': 93, 'highest_spo2': 99, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 501928)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,505 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-25.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753387447000, 'day': datetime.date(2025, 7, 25), 'sleep_start': datetime.datetime(2025, 7, 25, 0, 4, 7), 'sleep_end': datetime.datetime(2025, 7, 25, 9, 35, 7), 'sleep_duration_seconds': 33300, 'deep_sleep_seconds': 6240, 'light_sleep_seconds': 21540, 'rem_sleep_seconds': 5520, 'awake_seconds': 960, 'nap_duration_seconds': 0, 'sleep_score': 89, 'avg_sleep_stress': 13.0, 'avg_spo2': 95.0, 'lowest_spo2': 88, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 504523)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,507 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-26.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753491417000, 'day': datetime.date(2025, 7, 26), 'sleep_start': datetime.datetime(2025, 7, 26, 4, 56, 57), 'sleep_end': datetime.datetime(2025, 7, 26, 11, 33, 57), 'sleep_duration_seconds': 23820, 'deep_sleep_seconds': 7140, 'light_sleep_seconds': 10200, 'rem_sleep_seconds': 6480, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 82, 'avg_sleep_stress': 14.0, 'avg_spo2': 96.0, 'lowest_spo2': 91, 'highest_spo2': 100, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 506795)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,509 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-27.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753576283000, 'day': datetime.date(2025, 7, 27), 'sleep_start': datetime.datetime(2025, 7, 27, 4, 31, 23), 'sleep_end': datetime.datetime(2025, 7, 27, 11, 34, 15), 'sleep_duration_seconds': 25252, 'deep_sleep_seconds': 6060, 'light_sleep_seconds': 10440, 'rem_sleep_seconds': 8760, 'awake_seconds': 120, 'nap_duration_seconds': 0, 'sleep_score': 84, 'avg_sleep_stress': 11.0, 'avg_spo2': 95.0, 'lowest_spo2': 86, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 509222)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,512 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-28.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753654408000, 'day': datetime.date(2025, 7, 28), 'sleep_start': datetime.datetime(2025, 7, 28, 2, 13, 28), 'sleep_end': datetime.datetime(2025, 7, 28, 11, 4, 28), 'sleep_duration_seconds': 30000, 'deep_sleep_seconds': 6060, 'light_sleep_seconds': 15240, 'rem_sleep_seconds': 8700, 'awake_seconds': 300, 'nap_duration_seconds': 0, 'sleep_score': 98, 'avg_sleep_stress': 10.0, 'avg_spo2': 94.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 512072)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,515 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-29.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753738619000, 'day': datetime.date(2025, 7, 29), 'sleep_start': datetime.datetime(2025, 7, 29, 1, 36, 59), 'sleep_end': datetime.datetime(2025, 7, 29, 8, 42, 40), 'sleep_duration_seconds': 23921, 'deep_sleep_seconds': 1920, 'light_sleep_seconds': 14640, 'rem_sleep_seconds': 7380, 'awake_seconds': 720, 'nap_duration_seconds': 0, 'sleep_score': 76, 'avg_sleep_stress': 16.0, 'avg_spo2': 94.0, 'lowest_spo2': 84, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 1, 'sleep_need_baseline': 480, 'sleep_need_actual': 460, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 514425)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,517 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-30.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753824233000, 'day': datetime.date(2025, 7, 30), 'sleep_start': datetime.datetime(2025, 7, 30, 1, 23, 53), 'sleep_end': datetime.datetime(2025, 7, 30, 9, 11, 14), 'sleep_duration_seconds': 24621, 'deep_sleep_seconds': 3840, 'light_sleep_seconds': 16560, 'rem_sleep_seconds': 4260, 'awake_seconds': 1320, 'nap_duration_seconds': 0, 'sleep_score': 75, 'avg_sleep_stress': 20.0, 'avg_spo2': 96.0, 'lowest_spo2': 83, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 2, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 517293)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,520 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-07-31.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753913996000, 'day': datetime.date(2025, 7, 31), 'sleep_start': datetime.datetime(2025, 7, 31, 2, 19, 56), 'sleep_end': datetime.datetime(2025, 7, 31, 10, 30, 56), 'sleep_duration_seconds': 29460, 'deep_sleep_seconds': 5760, 'light_sleep_seconds': 13980, 'rem_sleep_seconds': 9720, 'awake_seconds': 0, 'nap_duration_seconds': 0, 'sleep_score': 90, 'avg_sleep_stress': 16.0, 'avg_spo2': 97.0, 'lowest_spo2': 85, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 510, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 520025)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,522 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-08-01.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1753997429000, 'day': datetime.date(2025, 8, 1), 'sleep_start': datetime.datetime(2025, 8, 1, 1, 30, 29), 'sleep_end': datetime.datetime(2025, 8, 1, 5, 31, 29), 'sleep_duration_seconds': 14400, 'deep_sleep_seconds': 3060, 'light_sleep_seconds': 6120, 'rem_sleep_seconds': 5220, 'awake_seconds': 60, 'nap_duration_seconds': 0, 'sleep_score': 53, 'avg_sleep_stress': 9.0, 'avg_spo2': 95.0, 'lowest_spo2': 89, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 480, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 522259)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,525 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-08-02.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1754096942000, 'day': datetime.date(2025, 8, 2), 'sleep_start': datetime.datetime(2025, 8, 2, 5, 9, 2), 'sleep_end': datetime.datetime(2025, 8, 2, 10, 29, 2), 'sleep_duration_seconds': 19200, 'deep_sleep_seconds': 10980, 'light_sleep_seconds': 7140, 'rem_sleep_seconds': 1080, 'awake_seconds': 0, 'nap_duration_seconds': 7080, 'sleep_score': 61, 'avg_sleep_stress': 17.0, 'avg_spo2': 96.0, 'lowest_spo2': 93, 'highest_spo2': 98, 'avg_respiration': 11.0, 'awake_count': 0, 'sleep_need_baseline': 480, 'sleep_need_actual': 540, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 524681)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,527 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-08-03.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1754176833000, 'day': datetime.date(2025, 8, 3), 'sleep_start': datetime.datetime(2025, 8, 3, 3, 20, 33), 'sleep_end': datetime.datetime(2025, 8, 3, 9, 54, 9), 'sleep_duration_seconds': 20616, 'deep_sleep_seconds': 5640, 'light_sleep_seconds': 13620, 'rem_sleep_seconds': 1380, 'awake_seconds': 3000, 'nap_duration_seconds': 0, 'sleep_score': 61, 'avg_sleep_stress': 17.0, 'avg_spo2': 96.0, 'lowest_spo2': 90, 'highest_spo2': 100, 'avg_respiration': 9.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 440, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 527097)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,530 - ERROR - Error processing sleep file C:\Users\barto\HealthData\Sleep\sleep_2025-08-04.json: (psycopg2.errors.InFailedSqlTransaction) current transaction is aborted, commands ignored until end of transaction block

[SQL: INSERT INTO garmin_sleep_sessions (sleep_id, day, sleep_start, sleep_end, sleep_duration_seconds, deep_sleep_seconds, light_sleep_seconds, rem_sleep_seconds, awake_seconds, nap_duration_seconds, sleep_score, avg_sleep_stress, avg_spo2, lowest_spo2, highest_spo2, avg_respiration, awake_count, sleep_need_baseline, sleep_need_actual, created_at) VALUES (%(sleep_id)s, %(day)s, %(sleep_start)s, %(sleep_end)s, %(sleep_duration_seconds)s, %(deep_sleep_seconds)s, %(light_sleep_seconds)s, %(rem_sleep_seconds)s, %(awake_seconds)s, %(nap_duration_seconds)s, %(sleep_score)s, %(avg_sleep_stress)s, %(avg_spo2)s, %(lowest_spo2)s, %(highest_spo2)s, %(avg_respiration)s, %(awake_count)s, %(sleep_need_baseline)s, %(sleep_need_actual)s, %(created_at)s) ON CONFLICT (sleep_id) DO UPDATE SET day = excluded.day, sleep_start = excluded.sleep_start, sleep_end = excluded.sleep_end, sleep_duration_seconds = excluded.sleep_duration_seconds, deep_sleep_seconds = excluded.deep_sleep_seconds, light_sleep_seconds = excluded.light_sleep_seconds, rem_sleep_seconds = excluded.rem_sleep_seconds, awake_seconds = excluded.awake_seconds, nap_duration_seconds = excluded.nap_duration_seconds, sleep_score = excluded.sleep_score, avg_sleep_stress = excluded.avg_sleep_stress, avg_spo2 = excluded.avg_spo2, lowest_spo2 = excluded.lowest_spo2, highest_spo2 = excluded.highest_spo2, avg_respiration = excluded.avg_respiration, awake_count = excluded.awake_count, sleep_need_baseline = excluded.sleep_need_baseline, sleep_need_actual = excluded.sleep_need_actual]
[parameters: {'sleep_id': 1754254377000, 'day': datetime.date(2025, 8, 4), 'sleep_start': datetime.datetime(2025, 8, 4, 0, 52, 57), 'sleep_end': datetime.datetime(2025, 8, 4, 8, 56, 57), 'sleep_duration_seconds': 26340, 'deep_sleep_seconds': 2340, 'light_sleep_seconds': 18960, 'rem_sleep_seconds': 5040, 'awake_seconds': 2700, 'nap_duration_seconds': 2460, 'sleep_score': 70, 'avg_sleep_stress': 24.0, 'avg_spo2': 95.0, 'lowest_spo2': 87, 'highest_spo2': 100, 'avg_respiration': 10.0, 'awake_count': 3, 'sleep_need_baseline': 480, 'sleep_need_actual': 530, 'created_at': datetime.datetime(2025, 8, 5, 17, 50, 52, 529993)}]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-05 19:50:52,531 - INFO - Migrated 0 sleep records (267 errors)
2025-08-05 19:50:52,535 - INFO - Migrated 0 steps records
2025-08-05 19:50:52,654 - INFO - Migrated 98 weight records
2025-08-05 19:50:52,849 - INFO - Created 0 new journal entries
2025-08-05 19:50:52,850 - INFO - Migration completed successfully!
2025-08-05 19:50:52,857 - ERROR - Migration failed: (psycopg2.errors.UndefinedColumn) column garmin_sleep_sessions.avg_sleep_stress does not exist
LINE 2: ...p_quality AS garmin_sleep_sessions_sleep_quality, garmin_sle...
                                                             ^

[SQL: SELECT count(*) AS count_1 
FROM (SELECT garmin_sleep_sessions.sleep_id AS garmin_sleep_sessions_sleep_id, garmin_sleep_sessions.day AS garmin_sleep_sessions_day, garmin_sleep_sessions.sleep_start AS garmin_sleep_sessions_sleep_start, garmin_sleep_sessions.sleep_end AS garmin_sleep_sessions_sleep_end, garmin_sleep_sessions.sleep_duration_seconds AS garmin_sleep_sessions_sleep_duration_seconds, garmin_sleep_sessions.deep_sleep_seconds AS garmin_sleep_sessions_deep_sleep_seconds, garmin_sleep_sessions.light_sleep_seconds AS garmin_sleep_sessions_light_sleep_seconds, garmin_sleep_sessions.rem_sleep_seconds AS garmin_sleep_sessions_rem_sleep_seconds, garmin_sleep_sessions.awake_seconds AS garmin_sleep_sessions_awake_seconds, garmin_sleep_sessions.nap_duration_seconds AS garmin_sleep_sessions_nap_duration_seconds, garmin_sleep_sessions.sleep_score AS garmin_sleep_sessions_sleep_score, garmin_sleep_sessions.sleep_quality AS garmin_sleep_sessions_sleep_quality, garmin_sleep_sessions.avg_sleep_stress AS garmin_sleep_sessions_avg_sleep_stress, garmin_sleep_sessions.avg_spo2 AS garmin_sleep_sessions_avg_spo2, garmin_sleep_sessions.lowest_spo2 AS garmin_sleep_sessions_lowest_spo2, garmin_sleep_sessions.highest_spo2 AS garmin_sleep_sessions_highest_spo2, garmin_sleep_sessions.avg_respiration AS garmin_sleep_sessions_avg_respiration, garmin_sleep_sessions.awake_count AS garmin_sleep_sessions_awake_count, garmin_sleep_sessions.sleep_need_baseline AS garmin_sleep_sessions_sleep_need_baseline, garmin_sleep_sessions.sleep_need_actual AS garmin_sleep_sessions_sleep_need_actual, garmin_sleep_sessions.created_at AS garmin_sleep_sessions_created_at 
FROM garmin_sleep_sessions) AS anon_1]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-05 19:51:43,302 - INFO - Database tables created/verified
2025-08-05 19:51:43,302 - INFO - Starting enhanced Garmin data migration...
2025-08-05 19:51:43,608 - INFO - Migrated 277 RHR records (0 errors)
2025-08-05 19:51:43,623 - WARNING - No sleep ID found for 2024-11-10
2025-08-05 19:51:43,773 - WARNING - No sleep ID found for 2025-02-24
2025-08-05 19:51:43,801 - WARNING - No sleep ID found for 2025-03-13
2025-08-05 19:51:43,808 - WARNING - No sleep ID found for 2025-03-16
2025-08-05 19:51:43,845 - WARNING - No sleep ID found for 2025-04-04
2025-08-05 19:51:43,942 - WARNING - No sleep ID found for 2025-05-18
2025-08-05 19:51:44,036 - WARNING - No sleep ID found for 2025-06-22
2025-08-05 19:51:44,050 - WARNING - No sleep ID found for 2025-06-28
2025-08-05 19:51:44,050 - WARNING - No sleep ID found for 2025-06-29
2025-08-05 19:51:44,085 - WARNING - No sleep ID found for 2025-07-13
2025-08-05 19:51:44,143 - INFO - Migrated 267 sleep records (0 errors)
2025-08-05 19:51:44,144 - INFO - Migrated 0 steps records
2025-08-05 19:51:44,262 - INFO - Migrated 98 weight records
2025-08-05 19:51:44,445 - INFO - Created 0 new journal entries
2025-08-05 19:51:44,445 - INFO - Migration completed successfully!
2025-08-05 20:03:35,527 - INFO - Database tables created/verified
2025-08-05 20:03:35,529 - WARNING - daily_summaries table not found in summary database
2025-08-05 20:13:33,910 - INFO - Database tables created/verified
2025-08-05 20:13:33,912 - WARNING - daily_summaries table not found in summary database
2025-08-05 20:14:02,899 - INFO - Database tables created/verified
2025-08-05 20:14:02,899 - WARNING - daily_summaries table not found in summary database
2025-08-05 20:14:57,016 - INFO - Database tables created/verified
2025-08-05 20:14:57,016 - INFO - Starting enhanced Garmin data migration...
2025-08-05 20:14:57,366 - INFO - Migrated 277 RHR records (0 errors)
2025-08-05 20:14:57,382 - WARNING - No sleep ID found for 2024-11-10
2025-08-05 20:14:57,542 - WARNING - No sleep ID found for 2025-02-24
2025-08-05 20:14:57,573 - WARNING - No sleep ID found for 2025-03-13
2025-08-05 20:14:57,578 - WARNING - No sleep ID found for 2025-03-16
2025-08-05 20:14:57,619 - WARNING - No sleep ID found for 2025-04-04
2025-08-05 20:14:57,725 - WARNING - No sleep ID found for 2025-05-18
2025-08-05 20:14:57,818 - WARNING - No sleep ID found for 2025-06-22
2025-08-05 20:14:57,834 - WARNING - No sleep ID found for 2025-06-28
2025-08-05 20:14:57,834 - WARNING - No sleep ID found for 2025-06-29
2025-08-05 20:14:57,869 - WARNING - No sleep ID found for 2025-07-13
2025-08-05 20:14:57,933 - INFO - Migrated 267 sleep records (0 errors)
2025-08-05 20:14:57,934 - WARNING - daily_summaries table not found in summary database
2025-08-05 20:14:58,073 - INFO - Migrated 98 weight records
2025-08-05 20:14:58,277 - INFO - Created 0 new journal entries
2025-08-05 20:14:58,277 - INFO - Migration completed successfully!
2025-08-05 20:18:43,475 - INFO - Database tables created/verified
2025-08-05 20:18:43,476 - INFO - Available columns in daily_summary: ['day', 'hr_min', 'hr_max', 'rhr', 'stress_avg', 'step_goal', 'steps', 'moderate_activity_time', 'vigorous_activity_time', 'intensity_time_goal', 'floors_up', 'floors_down', 'floors_goal', 'distance', 'calories_goal', 'calories_total', 'calories_bmr', 'calories_active', 'calories_consumed', 'hydration_goal', 'hydration_intake', 'sweat_loss', 'spo2_avg', 'spo2_min', 'rr_waking_avg', 'rr_max', 'rr_min', 'bb_charged', 'bb_max', 'bb_min', 'description']
2025-08-05 20:18:43,913 - INFO - Migrated 277 daily summary records
2025-08-05 20:19:27,500 - INFO - Database tables created/verified
2025-08-05 20:19:27,500 - INFO - Available columns in daily_summary: ['day', 'hr_min', 'hr_max', 'rhr', 'stress_avg', 'step_goal', 'steps', 'moderate_activity_time', 'vigorous_activity_time', 'intensity_time_goal', 'floors_up', 'floors_down', 'floors_goal', 'distance', 'calories_goal', 'calories_total', 'calories_bmr', 'calories_active', 'calories_consumed', 'hydration_goal', 'hydration_intake', 'sweat_loss', 'spo2_avg', 'spo2_min', 'rr_waking_avg', 'rr_max', 'rr_min', 'bb_charged', 'bb_max', 'bb_min', 'description']
2025-08-05 20:19:27,938 - INFO - Migrated 277 daily summary records
2025-08-05 20:25:15,569 - INFO - Database tables created/verified
2025-08-05 20:25:15,570 - INFO - Available columns in stress table: ['timestamp', 'stress']
2025-08-05 20:25:15,570 - INFO - Using columns: timestamp=timestamp, stress=stress
2025-08-05 20:25:16,541 - INFO - Migrated 1000 stress records...
2025-08-05 20:25:17,278 - INFO - Migrated 2000 stress records...
2025-08-05 20:25:18,015 - INFO - Migrated 3000 stress records...
2025-08-05 20:25:18,762 - INFO - Migrated 4000 stress records...
2025-08-05 20:25:19,515 - INFO - Migrated 5000 stress records...
2025-08-05 20:25:20,254 - INFO - Migrated 6000 stress records...
2025-08-05 20:25:20,998 - INFO - Migrated 7000 stress records...
2025-08-05 20:25:21,730 - INFO - Migrated 8000 stress records...
2025-08-05 20:25:22,452 - INFO - Migrated 9000 stress records...
2025-08-05 20:25:23,162 - INFO - Migrated 10000 stress records...
2025-08-05 20:25:23,861 - INFO - Migrated 11000 stress records...
2025-08-05 20:25:24,571 - INFO - Migrated 12000 stress records...
2025-08-05 20:25:25,303 - INFO - Migrated 13000 stress records...
2025-08-05 20:25:26,042 - INFO - Migrated 14000 stress records...
2025-08-05 20:25:26,771 - INFO - Migrated 15000 stress records...
2025-08-05 20:25:27,483 - INFO - Migrated 16000 stress records...
2025-08-05 20:25:28,181 - INFO - Migrated 17000 stress records...
2025-08-05 20:25:28,883 - INFO - Migrated 18000 stress records...
2025-08-05 20:25:29,592 - INFO - Migrated 19000 stress records...
2025-08-05 20:25:30,293 - INFO - Migrated 20000 stress records...
2025-08-05 20:25:30,992 - INFO - Migrated 21000 stress records...
2025-08-05 20:25:31,681 - INFO - Migrated 22000 stress records...
2025-08-05 20:25:32,363 - INFO - Migrated 23000 stress records...
2025-08-05 20:25:33,058 - INFO - Migrated 24000 stress records...
2025-08-05 20:25:33,751 - INFO - Migrated 25000 stress records...
2025-08-05 20:25:34,456 - INFO - Migrated 26000 stress records...
2025-08-05 20:25:35,158 - INFO - Migrated 27000 stress records...
2025-08-05 20:25:35,855 - INFO - Migrated 28000 stress records...
2025-08-05 20:25:36,570 - INFO - Migrated 29000 stress records...
2025-08-05 20:25:37,285 - INFO - Migrated 30000 stress records...
2025-08-05 20:25:38,005 - INFO - Migrated 31000 stress records...
2025-08-05 20:25:38,700 - INFO - Migrated 32000 stress records...
2025-08-05 20:25:39,374 - INFO - Migrated 33000 stress records...
2025-08-05 20:25:40,086 - INFO - Migrated 34000 stress records...
2025-08-05 20:25:40,789 - INFO - Migrated 35000 stress records...
2025-08-05 20:25:41,490 - INFO - Migrated 36000 stress records...
2025-08-05 20:25:42,196 - INFO - Migrated 37000 stress records...
2025-08-05 20:25:42,899 - INFO - Migrated 38000 stress records...
2025-08-05 20:25:43,608 - INFO - Migrated 39000 stress records...
2025-08-05 20:25:44,335 - INFO - Migrated 40000 stress records...
2025-08-05 20:25:45,072 - INFO - Migrated 41000 stress records...
2025-08-05 20:25:45,812 - INFO - Migrated 42000 stress records...
2025-08-05 20:25:46,524 - INFO - Migrated 43000 stress records...
2025-08-05 20:25:47,238 - INFO - Migrated 44000 stress records...
2025-08-05 20:25:47,967 - INFO - Migrated 45000 stress records...
2025-08-05 20:25:48,708 - INFO - Migrated 46000 stress records...
2025-08-05 20:25:49,426 - INFO - Migrated 47000 stress records...
2025-08-05 20:25:50,149 - INFO - Migrated 48000 stress records...
2025-08-05 20:25:50,863 - INFO - Migrated 49000 stress records...
2025-08-05 20:25:51,574 - INFO - Migrated 50000 stress records...
2025-08-05 20:25:52,281 - INFO - Migrated 51000 stress records...
2025-08-05 20:25:52,976 - INFO - Migrated 52000 stress records...
2025-08-05 20:25:53,681 - INFO - Migrated 53000 stress records...
2025-08-05 20:25:54,375 - INFO - Migrated 54000 stress records...
2025-08-05 20:25:55,096 - INFO - Migrated 55000 stress records...
2025-08-05 20:25:55,839 - INFO - Migrated 56000 stress records...
2025-08-05 20:25:56,585 - INFO - Migrated 57000 stress records...
2025-08-05 20:25:57,314 - INFO - Migrated 58000 stress records...
2025-08-05 20:25:58,043 - INFO - Migrated 59000 stress records...
2025-08-05 20:25:58,758 - INFO - Migrated 60000 stress records...
2025-08-05 20:25:59,482 - INFO - Migrated 61000 stress records...
2025-08-05 20:26:00,218 - INFO - Migrated 62000 stress records...
2025-08-05 20:26:00,949 - INFO - Migrated 63000 stress records...
2025-08-05 20:26:01,668 - INFO - Migrated 64000 stress records...
2025-08-05 20:26:02,368 - INFO - Migrated 65000 stress records...
2025-08-05 20:26:03,078 - INFO - Migrated 66000 stress records...
2025-08-05 20:26:03,799 - INFO - Migrated 67000 stress records...
2025-08-05 20:26:04,542 - INFO - Migrated 68000 stress records...
2025-08-05 20:26:05,272 - INFO - Migrated 69000 stress records...
2025-08-05 20:26:06,018 - INFO - Migrated 70000 stress records...
2025-08-05 20:26:06,750 - INFO - Migrated 71000 stress records...
2025-08-05 20:26:07,460 - INFO - Migrated 72000 stress records...
2025-08-05 20:26:08,175 - INFO - Migrated 73000 stress records...
2025-08-05 20:26:08,886 - INFO - Migrated 74000 stress records...
2025-08-05 20:26:09,604 - INFO - Migrated 75000 stress records...
2025-08-05 20:26:10,326 - INFO - Migrated 76000 stress records...
2025-08-05 20:26:11,043 - INFO - Migrated 77000 stress records...
2025-08-05 20:26:11,770 - INFO - Migrated 78000 stress records...
2025-08-05 20:26:12,490 - INFO - Migrated 79000 stress records...
2025-08-05 20:26:13,218 - INFO - Migrated 80000 stress records...
2025-08-05 20:26:13,939 - INFO - Migrated 81000 stress records...
2025-08-05 20:26:14,657 - INFO - Migrated 82000 stress records...
2025-08-05 20:26:15,388 - INFO - Migrated 83000 stress records...
2025-08-05 20:26:16,099 - INFO - Migrated 84000 stress records...
2025-08-05 20:26:16,828 - INFO - Migrated 85000 stress records...
2025-08-05 20:26:17,548 - INFO - Migrated 86000 stress records...
2025-08-05 20:26:18,272 - INFO - Migrated 87000 stress records...
2025-08-05 20:26:18,998 - INFO - Migrated 88000 stress records...
2025-08-05 20:26:19,722 - INFO - Migrated 89000 stress records...
2025-08-05 20:26:20,450 - INFO - Migrated 90000 stress records...
2025-08-05 20:26:21,167 - INFO - Migrated 91000 stress records...
2025-08-05 20:26:21,884 - INFO - Migrated 92000 stress records...
2025-08-05 20:26:22,593 - INFO - Migrated 93000 stress records...
2025-08-05 20:26:23,308 - INFO - Migrated 94000 stress records...
2025-08-05 20:26:24,010 - INFO - Migrated 95000 stress records...
2025-08-05 20:26:24,735 - INFO - Migrated 96000 stress records...
2025-08-05 20:26:25,460 - INFO - Migrated 97000 stress records...
2025-08-05 20:26:26,180 - INFO - Migrated 98000 stress records...
2025-08-05 20:26:26,916 - INFO - Migrated 99000 stress records...
2025-08-05 20:26:27,626 - INFO - Migrated 100000 stress records...
2025-08-05 20:26:28,354 - INFO - Migrated 101000 stress records...
2025-08-05 20:26:29,068 - INFO - Migrated 102000 stress records...
2025-08-05 20:26:29,779 - INFO - Migrated 103000 stress records...
2025-08-05 20:26:30,490 - INFO - Migrated 104000 stress records...
2025-08-05 20:26:31,220 - INFO - Migrated 105000 stress records...
2025-08-05 20:26:31,962 - INFO - Migrated 106000 stress records...
2025-08-05 20:26:32,699 - INFO - Migrated 107000 stress records...
2025-08-05 20:26:33,428 - INFO - Migrated 108000 stress records...
2025-08-05 20:26:34,150 - INFO - Migrated 109000 stress records...
2025-08-05 20:26:34,879 - INFO - Migrated 110000 stress records...
2025-08-05 20:26:35,599 - INFO - Migrated 111000 stress records...
2025-08-05 20:26:36,318 - INFO - Migrated 112000 stress records...
2025-08-05 20:26:37,041 - INFO - Migrated 113000 stress records...
2025-08-05 20:26:37,758 - INFO - Migrated 114000 stress records...
2025-08-05 20:26:38,504 - INFO - Migrated 115000 stress records...
2025-08-05 20:26:39,247 - INFO - Migrated 116000 stress records...
2025-08-05 20:26:39,956 - INFO - Migrated 117000 stress records...
2025-08-05 20:26:40,673 - INFO - Migrated 118000 stress records...
2025-08-05 20:26:41,393 - INFO - Migrated 119000 stress records...
2025-08-05 20:26:42,123 - INFO - Migrated 120000 stress records...
2025-08-05 20:26:42,847 - INFO - Migrated 121000 stress records...
2025-08-05 20:26:43,578 - INFO - Migrated 122000 stress records...
2025-08-05 20:26:44,313 - INFO - Migrated 123000 stress records...
2025-08-05 20:26:45,048 - INFO - Migrated 124000 stress records...
2025-08-05 20:26:45,787 - INFO - Migrated 125000 stress records...
2025-08-05 20:26:46,526 - INFO - Migrated 126000 stress records...
2025-08-05 20:26:47,256 - INFO - Migrated 127000 stress records...
2025-08-05 20:26:47,992 - INFO - Migrated 128000 stress records...
2025-08-05 20:26:48,722 - INFO - Migrated 129000 stress records...
2025-08-05 20:26:49,446 - INFO - Migrated 130000 stress records...
2025-08-05 20:26:50,145 - INFO - Migrated 131000 stress records...
2025-08-05 20:26:50,853 - INFO - Migrated 132000 stress records...
2025-08-05 20:26:51,583 - INFO - Migrated 133000 stress records...
2025-08-05 20:26:52,311 - INFO - Migrated 134000 stress records...
2025-08-05 20:26:53,017 - INFO - Migrated 135000 stress records...
2025-08-05 20:26:53,726 - INFO - Migrated 136000 stress records...
2025-08-05 20:26:54,424 - INFO - Migrated 137000 stress records...
2025-08-05 20:26:55,143 - INFO - Migrated 138000 stress records...
2025-08-05 20:26:55,865 - INFO - Migrated 139000 stress records...
2025-08-05 20:26:56,581 - INFO - Migrated 140000 stress records...
2025-08-05 20:26:57,284 - INFO - Migrated 141000 stress records...
2025-08-05 20:26:57,983 - INFO - Migrated 142000 stress records...
2025-08-05 20:26:58,698 - INFO - Migrated 143000 stress records...
2025-08-05 20:26:59,410 - INFO - Migrated 144000 stress records...
2025-08-05 20:27:00,121 - INFO - Migrated 145000 stress records...
2025-08-05 20:27:00,862 - INFO - Migrated 146000 stress records...
2025-08-05 20:27:01,589 - INFO - Migrated 147000 stress records...
2025-08-05 20:27:02,306 - INFO - Migrated 148000 stress records...
2025-08-05 20:27:03,031 - INFO - Migrated 149000 stress records...
2025-08-05 20:27:03,754 - INFO - Migrated 150000 stress records...
2025-08-05 20:27:04,490 - INFO - Migrated 151000 stress records...
2025-08-05 20:27:05,223 - INFO - Migrated 152000 stress records...
2025-08-05 20:27:05,942 - INFO - Migrated 153000 stress records...
2025-08-05 20:27:06,688 - INFO - Migrated 154000 stress records...
2025-08-05 20:27:07,415 - INFO - Migrated 155000 stress records...
2025-08-05 20:27:08,134 - INFO - Migrated 156000 stress records...
2025-08-05 20:27:08,880 - INFO - Migrated 157000 stress records...
2025-08-05 20:27:09,609 - INFO - Migrated 158000 stress records...
2025-08-05 20:27:10,335 - INFO - Migrated 159000 stress records...
2025-08-05 20:27:11,061 - INFO - Migrated 160000 stress records...
2025-08-05 20:27:11,790 - INFO - Migrated 161000 stress records...
2025-08-05 20:27:12,516 - INFO - Migrated 162000 stress records...
2025-08-05 20:27:13,223 - INFO - Migrated 163000 stress records...
2025-08-05 20:27:13,954 - INFO - Migrated 164000 stress records...
2025-08-05 20:27:14,681 - INFO - Migrated 165000 stress records...
2025-08-05 20:27:15,385 - INFO - Migrated 166000 stress records...
2025-08-05 20:27:16,088 - INFO - Migrated 167000 stress records...
2025-08-05 20:27:16,785 - INFO - Migrated 168000 stress records...
2025-08-05 20:27:17,513 - INFO - Migrated 169000 stress records...
2025-08-05 20:27:18,255 - INFO - Migrated 170000 stress records...
2025-08-05 20:27:18,998 - INFO - Migrated 171000 stress records...
2025-08-05 20:27:19,752 - INFO - Migrated 172000 stress records...
2025-08-05 20:27:20,490 - INFO - Migrated 173000 stress records...
2025-08-05 20:27:21,223 - INFO - Migrated 174000 stress records...
2025-08-05 20:27:21,960 - INFO - Migrated 175000 stress records...
2025-08-05 20:27:22,693 - INFO - Migrated 176000 stress records...
2025-08-05 20:27:23,428 - INFO - Migrated 177000 stress records...
2025-08-05 20:27:24,162 - INFO - Migrated 178000 stress records...
2025-08-05 20:27:24,872 - INFO - Migrated 179000 stress records...
2025-08-05 20:27:25,616 - INFO - Migrated 180000 stress records...
2025-08-05 20:27:26,352 - INFO - Migrated 181000 stress records...
2025-08-05 20:27:27,079 - INFO - Migrated 182000 stress records...
2025-08-05 20:27:27,784 - INFO - Migrated 183000 stress records...
2025-08-05 20:27:28,516 - INFO - Migrated 184000 stress records...
2025-08-05 20:27:29,243 - INFO - Migrated 185000 stress records...
2025-08-05 20:27:29,959 - INFO - Migrated 186000 stress records...
2025-08-05 20:27:30,669 - INFO - Migrated 187000 stress records...
2025-08-05 20:27:31,400 - INFO - Migrated 188000 stress records...
2025-08-05 20:27:32,145 - INFO - Migrated 189000 stress records...
2025-08-05 20:27:32,860 - INFO - Migrated 190000 stress records...
2025-08-05 20:27:33,589 - INFO - Migrated 191000 stress records...
2025-08-05 20:27:34,316 - INFO - Migrated 192000 stress records...
2025-08-05 20:27:35,054 - INFO - Migrated 193000 stress records...
2025-08-05 20:27:35,764 - INFO - Migrated 194000 stress records...
2025-08-05 20:27:36,484 - INFO - Migrated 195000 stress records...
2025-08-05 20:27:37,213 - INFO - Migrated 196000 stress records...
2025-08-05 20:27:37,924 - INFO - Migrated 197000 stress records...
2025-08-05 20:27:38,633 - INFO - Migrated 198000 stress records...
2025-08-05 20:27:39,343 - INFO - Migrated 199000 stress records...
2025-08-05 20:27:40,050 - INFO - Migrated 200000 stress records...
2025-08-05 20:27:40,759 - INFO - Migrated 201000 stress records...
2025-08-05 20:27:41,469 - INFO - Migrated 202000 stress records...
2025-08-05 20:27:42,183 - INFO - Migrated 203000 stress records...
2025-08-05 20:27:42,886 - INFO - Migrated 204000 stress records...
2025-08-05 20:27:43,599 - INFO - Migrated 205000 stress records...
2025-08-05 20:27:44,314 - INFO - Migrated 206000 stress records...
2025-08-05 20:27:45,025 - INFO - Migrated 207000 stress records...
2025-08-05 20:27:45,762 - INFO - Migrated 208000 stress records...
2025-08-05 20:27:46,502 - INFO - Migrated 209000 stress records...
2025-08-05 20:27:47,226 - INFO - Migrated 210000 stress records...
2025-08-05 20:27:47,939 - INFO - Migrated 211000 stress records...
2025-08-05 20:27:48,665 - INFO - Migrated 212000 stress records...
2025-08-05 20:27:49,387 - INFO - Migrated 213000 stress records...
2025-08-05 20:27:50,094 - INFO - Migrated 214000 stress records...
2025-08-05 20:27:50,800 - INFO - Migrated 215000 stress records...
2025-08-05 20:27:51,510 - INFO - Migrated 216000 stress records...
2025-08-05 20:27:52,214 - INFO - Migrated 217000 stress records...
2025-08-05 20:27:52,899 - INFO - Migrated 218000 stress records...
2025-08-05 20:27:53,572 - INFO - Migrated 219000 stress records...
2025-08-05 20:27:54,239 - INFO - Migrated 220000 stress records...
2025-08-05 20:27:54,909 - INFO - Migrated 221000 stress records...
2025-08-05 20:27:55,593 - INFO - Migrated 222000 stress records...
2025-08-05 20:27:56,300 - INFO - Migrated 223000 stress records...
2025-08-05 20:27:57,036 - INFO - Migrated 224000 stress records...
2025-08-05 20:27:57,765 - INFO - Migrated 225000 stress records...
2025-08-05 20:27:58,488 - INFO - Migrated 226000 stress records...
2025-08-05 20:27:59,204 - INFO - Migrated 227000 stress records...
2025-08-05 20:27:59,933 - INFO - Migrated 228000 stress records...
2025-08-05 20:28:00,668 - INFO - Migrated 229000 stress records...
2025-08-05 20:28:01,383 - INFO - Migrated 230000 stress records...
2025-08-05 20:28:02,139 - INFO - Migrated 231000 stress records...
2025-08-05 20:28:02,880 - INFO - Migrated 232000 stress records...
2025-08-05 20:28:03,625 - INFO - Migrated 233000 stress records...
2025-08-05 20:28:04,367 - INFO - Migrated 234000 stress records...
2025-08-05 20:28:05,102 - INFO - Migrated 235000 stress records...
2025-08-05 20:28:05,854 - INFO - Migrated 236000 stress records...
2025-08-05 20:28:06,607 - INFO - Migrated 237000 stress records...
2025-08-05 20:28:07,348 - INFO - Migrated 238000 stress records...
2025-08-05 20:28:08,065 - INFO - Migrated 239000 stress records...
2025-08-05 20:28:08,783 - INFO - Migrated 240000 stress records...
2025-08-05 20:28:09,488 - INFO - Migrated 241000 stress records...
2025-08-05 20:28:10,210 - INFO - Migrated 242000 stress records...
2025-08-05 20:28:10,900 - INFO - Migrated 243000 stress records...
2025-08-05 20:28:11,628 - INFO - Migrated 244000 stress records...
2025-08-05 20:28:12,358 - INFO - Migrated 245000 stress records...
2025-08-05 20:28:13,090 - INFO - Migrated 246000 stress records...
2025-08-05 20:28:13,790 - INFO - Migrated 247000 stress records...
2025-08-05 20:28:14,486 - INFO - Migrated 248000 stress records...
2025-08-05 20:28:15,199 - INFO - Migrated 249000 stress records...
2025-08-05 20:28:15,930 - INFO - Migrated 250000 stress records...
2025-08-05 20:28:16,666 - INFO - Migrated 251000 stress records...
2025-08-05 20:28:17,397 - INFO - Migrated 252000 stress records...
2025-08-05 20:28:18,114 - INFO - Migrated 253000 stress records...
2025-08-05 20:28:18,842 - INFO - Migrated 254000 stress records...
2025-08-05 20:28:19,580 - INFO - Migrated 255000 stress records...
2025-08-05 20:28:20,307 - INFO - Migrated 256000 stress records...
2025-08-05 20:28:21,030 - INFO - Migrated 257000 stress records...
2025-08-05 20:28:21,734 - INFO - Migrated 258000 stress records...
2025-08-05 20:28:22,429 - INFO - Migrated 259000 stress records...
2025-08-05 20:28:23,114 - INFO - Migrated 260000 stress records...
2025-08-05 20:28:23,813 - INFO - Migrated 261000 stress records...
2025-08-05 20:28:24,511 - INFO - Migrated 262000 stress records...
2025-08-05 20:28:25,244 - INFO - Migrated 263000 stress records...
2025-08-05 20:28:25,986 - INFO - Migrated 264000 stress records...
2025-08-05 20:28:26,741 - INFO - Migrated 265000 stress records...
2025-08-05 20:28:27,485 - INFO - Migrated 266000 stress records...
2025-08-05 20:28:28,226 - INFO - Migrated 267000 stress records...
2025-08-05 20:28:28,960 - INFO - Migrated 268000 stress records...
2025-08-05 20:28:29,684 - INFO - Migrated 269000 stress records...
2025-08-05 20:28:30,409 - INFO - Migrated 270000 stress records...
2025-08-05 20:28:31,122 - INFO - Migrated 271000 stress records...
2025-08-05 20:28:31,843 - INFO - Migrated 272000 stress records...
2025-08-05 20:28:32,574 - INFO - Migrated 273000 stress records...
2025-08-05 20:28:33,299 - INFO - Migrated 274000 stress records...
2025-08-05 20:28:34,024 - INFO - Migrated 275000 stress records...
2025-08-05 20:28:34,752 - INFO - Migrated 276000 stress records...
2025-08-05 20:28:35,478 - INFO - Migrated 277000 stress records...
2025-08-05 20:28:36,202 - INFO - Migrated 278000 stress records...
2025-08-05 20:28:36,940 - INFO - Migrated 279000 stress records...
2025-08-05 20:28:37,690 - INFO - Migrated 280000 stress records...
2025-08-05 20:28:38,411 - INFO - Migrated 281000 stress records...
2025-08-05 20:28:39,147 - INFO - Migrated 282000 stress records...
2025-08-05 20:28:39,859 - INFO - Migrated 283000 stress records...
2025-08-05 20:28:40,550 - INFO - Migrated 284000 stress records...
2025-08-05 20:28:41,256 - INFO - Migrated 285000 stress records...
2025-08-05 20:28:41,980 - INFO - Migrated 286000 stress records...
2025-08-05 20:28:42,716 - INFO - Migrated 287000 stress records...
2025-08-05 20:28:43,454 - INFO - Migrated 288000 stress records...
2025-08-05 20:28:44,185 - INFO - Migrated 289000 stress records...
2025-08-05 20:28:44,920 - INFO - Migrated 290000 stress records...
2025-08-05 20:28:45,632 - INFO - Migrated 291000 stress records...
2025-08-05 20:28:46,351 - INFO - Migrated 292000 stress records...
2025-08-05 20:28:47,074 - INFO - Migrated 293000 stress records...
2025-08-05 20:28:47,811 - INFO - Migrated 294000 stress records...
2025-08-05 20:28:48,545 - INFO - Migrated 295000 stress records...
2025-08-05 20:28:49,279 - INFO - Migrated 296000 stress records...
2025-08-05 20:28:50,020 - INFO - Migrated 297000 stress records...
2025-08-05 20:28:50,748 - INFO - Migrated 298000 stress records...
2025-08-05 20:28:51,483 - INFO - Migrated 299000 stress records...
2025-08-05 20:28:52,199 - INFO - Migrated 300000 stress records...
2025-08-05 20:28:52,912 - INFO - Migrated 301000 stress records...
2025-08-05 20:28:53,628 - INFO - Migrated 302000 stress records...
2025-08-05 20:28:54,333 - INFO - Migrated 303000 stress records...
2025-08-05 20:28:55,048 - INFO - Migrated 304000 stress records...
2025-08-05 20:28:55,774 - INFO - Migrated 305000 stress records...
2025-08-05 20:28:56,501 - INFO - Migrated 306000 stress records...
2025-08-05 20:28:57,222 - INFO - Migrated 307000 stress records...
2025-08-05 20:28:57,945 - INFO - Migrated 308000 stress records...
2025-08-05 20:28:58,662 - INFO - Migrated 309000 stress records...
2025-08-05 20:28:59,368 - INFO - Migrated 310000 stress records...
2025-08-05 20:29:00,070 - INFO - Migrated 311000 stress records...
2025-08-05 20:29:00,773 - INFO - Migrated 312000 stress records...
2025-08-05 20:29:01,493 - INFO - Migrated 313000 stress records...
2025-08-05 20:29:02,234 - INFO - Migrated 314000 stress records...
2025-08-05 20:29:02,961 - INFO - Migrated 315000 stress records...
2025-08-05 20:29:03,683 - INFO - Migrated 316000 stress records...
2025-08-05 20:29:04,427 - INFO - Migrated 317000 stress records...
2025-08-05 20:29:05,175 - INFO - Migrated 318000 stress records...
2025-08-05 20:29:05,921 - INFO - Migrated 319000 stress records...
2025-08-05 20:29:06,650 - INFO - Migrated 320000 stress records...
2025-08-05 20:29:07,380 - INFO - Migrated 321000 stress records...
2025-08-05 20:29:08,117 - INFO - Migrated 322000 stress records...
2025-08-05 20:29:08,834 - INFO - Migrated 323000 stress records...
2025-08-05 20:29:09,551 - INFO - Migrated 324000 stress records...
2025-08-05 20:29:10,285 - INFO - Migrated 325000 stress records...
2025-08-05 20:29:11,019 - INFO - Migrated 326000 stress records...
2025-08-05 20:29:11,750 - INFO - Migrated 327000 stress records...
2025-08-05 20:29:12,473 - INFO - Migrated 328000 stress records...
2025-08-05 20:29:13,192 - INFO - Migrated 329000 stress records...
2025-08-05 20:29:13,929 - INFO - Migrated 330000 stress records...
2025-08-05 20:29:14,663 - INFO - Migrated 331000 stress records...
2025-08-05 20:29:15,402 - INFO - Migrated 332000 stress records...
2025-08-05 20:29:16,135 - INFO - Migrated 333000 stress records...
2025-08-05 20:29:16,861 - INFO - Migrated 334000 stress records...
2025-08-05 20:29:17,588 - INFO - Migrated 335000 stress records...
2025-08-05 20:29:18,327 - INFO - Migrated 336000 stress records...
2025-08-05 20:29:19,045 - INFO - Migrated 337000 stress records...
2025-08-05 20:29:19,779 - INFO - Migrated 338000 stress records...
2025-08-05 20:29:20,534 - INFO - Migrated 339000 stress records...
2025-08-05 20:29:21,293 - INFO - Migrated 340000 stress records...
2025-08-05 20:29:22,047 - INFO - Migrated 341000 stress records...
2025-08-05 20:29:22,788 - INFO - Migrated 342000 stress records...
2025-08-05 20:29:23,531 - INFO - Migrated 343000 stress records...
2025-08-05 20:29:24,271 - INFO - Migrated 344000 stress records...
2025-08-05 20:29:25,025 - INFO - Migrated 345000 stress records...
2025-08-05 20:29:25,761 - INFO - Migrated 346000 stress records...
2025-08-05 20:29:26,509 - INFO - Migrated 347000 stress records...
2025-08-05 20:29:27,249 - INFO - Migrated 348000 stress records...
2025-08-05 20:29:27,992 - INFO - Migrated 349000 stress records...
2025-08-05 20:29:28,704 - INFO - Migrated 350000 stress records...
2025-08-05 20:29:29,427 - INFO - Migrated 351000 stress records...
2025-08-05 20:29:30,153 - INFO - Migrated 352000 stress records...
2025-08-05 20:29:30,868 - INFO - Migrated 353000 stress records...
2025-08-05 20:29:31,591 - INFO - Migrated 354000 stress records...
2025-08-05 20:29:32,336 - INFO - Migrated 355000 stress records...
2025-08-05 20:29:33,088 - INFO - Migrated 356000 stress records...
2025-08-05 20:29:33,837 - INFO - Migrated 357000 stress records...
2025-08-05 20:29:34,576 - INFO - Migrated 358000 stress records...
2025-08-05 20:29:35,293 - INFO - Migrated 359000 stress records...
2025-08-05 20:29:36,001 - INFO - Migrated 360000 stress records...
2025-08-05 20:29:36,698 - INFO - Migrated 361000 stress records...
2025-08-05 20:29:37,412 - INFO - Migrated 362000 stress records...
2025-08-05 20:29:38,125 - INFO - Migrated 363000 stress records...
2025-08-05 20:29:38,840 - INFO - Migrated 364000 stress records...
2025-08-05 20:29:39,568 - INFO - Migrated 365000 stress records...
2025-08-05 20:29:40,300 - INFO - Migrated 366000 stress records...
2025-08-05 20:29:41,010 - INFO - Migrated 367000 stress records...
2025-08-05 20:29:41,721 - INFO - Migrated 368000 stress records...
2025-08-05 20:29:42,441 - INFO - Migrated 369000 stress records...
2025-08-05 20:29:43,160 - INFO - Migrated 370000 stress records...
2025-08-05 20:29:43,884 - INFO - Migrated 371000 stress records...
2025-08-05 20:29:44,624 - INFO - Migrated 372000 stress records...
2025-08-05 20:29:45,348 - INFO - Migrated 373000 stress records...
2025-08-05 20:29:46,058 - INFO - Migrated 374000 stress records...
2025-08-05 20:29:46,815 - INFO - Migrated 375000 stress records...
2025-08-05 20:29:47,548 - INFO - Migrated 376000 stress records...
2025-08-05 20:29:48,296 - INFO - Migrated 377000 stress records...
2025-08-05 20:29:49,044 - INFO - Migrated 378000 stress records...
2025-08-05 20:29:49,770 - INFO - Migrated 379000 stress records...
2025-08-05 20:29:50,496 - INFO - Migrated 380000 stress records...
2025-08-05 20:29:51,008 - INFO - Migrated 380672 stress records
2025-08-05 20:32:58,199 - INFO - Database tables created/verified
2025-08-05 20:32:58,199 - INFO - Available columns in monitoring_hr table: ['timestamp', 'heart_rate']
2025-08-05 20:32:58,199 - INFO - Using columns: timestamp=timestamp, heart_rate=heart_rate
2025-08-05 20:32:59,287 - INFO - Migrated 1000 heart rate records...
2025-08-05 20:33:00,000 - INFO - Migrated 2000 heart rate records...
2025-08-05 20:33:00,723 - INFO - Migrated 3000 heart rate records...
2025-08-05 20:33:01,438 - INFO - Migrated 4000 heart rate records...
2025-08-05 20:33:02,169 - INFO - Migrated 5000 heart rate records...
2025-08-05 20:33:02,906 - INFO - Migrated 6000 heart rate records...
2025-08-05 20:33:03,630 - INFO - Migrated 7000 heart rate records...
2025-08-05 20:33:04,376 - INFO - Migrated 8000 heart rate records...
2025-08-05 20:33:05,103 - INFO - Migrated 9000 heart rate records...
2025-08-05 20:33:05,835 - INFO - Migrated 10000 heart rate records...
2025-08-05 20:33:06,572 - INFO - Migrated 11000 heart rate records...
2025-08-05 20:33:07,308 - INFO - Migrated 12000 heart rate records...
2025-08-05 20:33:08,022 - INFO - Migrated 13000 heart rate records...
2025-08-05 20:33:08,744 - INFO - Migrated 14000 heart rate records...
2025-08-05 20:33:09,449 - INFO - Migrated 15000 heart rate records...
2025-08-05 20:33:10,162 - INFO - Migrated 16000 heart rate records...
2025-08-05 20:33:10,875 - INFO - Migrated 17000 heart rate records...
2025-08-05 20:33:11,594 - INFO - Migrated 18000 heart rate records...
2025-08-05 20:33:12,319 - INFO - Migrated 19000 heart rate records...
2025-08-05 20:33:13,045 - INFO - Migrated 20000 heart rate records...
2025-08-05 20:33:13,764 - INFO - Migrated 21000 heart rate records...
2025-08-05 20:33:14,490 - INFO - Migrated 22000 heart rate records...
2025-08-05 20:33:15,210 - INFO - Migrated 23000 heart rate records...
2025-08-05 20:33:15,936 - INFO - Migrated 24000 heart rate records...
2025-08-05 20:33:16,663 - INFO - Migrated 25000 heart rate records...
2025-08-05 20:33:17,390 - INFO - Migrated 26000 heart rate records...
2025-08-05 20:33:18,111 - INFO - Migrated 27000 heart rate records...
2025-08-05 20:33:18,846 - INFO - Migrated 28000 heart rate records...
2025-08-05 20:33:19,581 - INFO - Migrated 29000 heart rate records...
2025-08-05 20:33:20,308 - INFO - Migrated 30000 heart rate records...
2025-08-05 20:33:21,027 - INFO - Migrated 31000 heart rate records...
2025-08-05 20:33:21,757 - INFO - Migrated 32000 heart rate records...
2025-08-05 20:33:22,488 - INFO - Migrated 33000 heart rate records...
2025-08-05 20:33:23,224 - INFO - Migrated 34000 heart rate records...
2025-08-05 20:33:23,948 - INFO - Migrated 35000 heart rate records...
2025-08-05 20:33:24,672 - INFO - Migrated 36000 heart rate records...
2025-08-05 20:33:25,384 - INFO - Migrated 37000 heart rate records...
2025-08-05 20:33:26,114 - INFO - Migrated 38000 heart rate records...
2025-08-05 20:33:26,843 - INFO - Migrated 39000 heart rate records...
2025-08-05 20:33:27,535 - INFO - Migrated 40000 heart rate records...
2025-08-05 20:33:28,241 - INFO - Migrated 41000 heart rate records...
2025-08-05 20:33:28,962 - INFO - Migrated 42000 heart rate records...
2025-08-05 20:33:29,677 - INFO - Migrated 43000 heart rate records...
2025-08-05 20:33:30,380 - INFO - Migrated 44000 heart rate records...
2025-08-05 20:33:31,084 - INFO - Migrated 45000 heart rate records...
2025-08-05 20:33:31,800 - INFO - Migrated 46000 heart rate records...
2025-08-05 20:33:32,513 - INFO - Migrated 47000 heart rate records...
2025-08-05 20:33:33,240 - INFO - Migrated 48000 heart rate records...
2025-08-05 20:33:33,963 - INFO - Migrated 49000 heart rate records...
2025-08-05 20:33:34,689 - INFO - Migrated 50000 heart rate records...
2025-08-05 20:33:35,418 - INFO - Migrated 51000 heart rate records...
2025-08-05 20:33:36,139 - INFO - Migrated 52000 heart rate records...
2025-08-05 20:33:36,862 - INFO - Migrated 53000 heart rate records...
2025-08-05 20:33:37,594 - INFO - Migrated 54000 heart rate records...
2025-08-05 20:33:38,326 - INFO - Migrated 55000 heart rate records...
2025-08-05 20:33:39,048 - INFO - Migrated 56000 heart rate records...
2025-08-05 20:33:39,769 - INFO - Migrated 57000 heart rate records...
2025-08-05 20:33:40,500 - INFO - Migrated 58000 heart rate records...
2025-08-05 20:33:41,240 - INFO - Migrated 59000 heart rate records...
2025-08-05 20:33:41,976 - INFO - Migrated 60000 heart rate records...
2025-08-05 20:33:42,714 - INFO - Migrated 61000 heart rate records...
2025-08-05 20:33:43,450 - INFO - Migrated 62000 heart rate records...
2025-08-05 20:33:44,173 - INFO - Migrated 63000 heart rate records...
2025-08-05 20:33:44,898 - INFO - Migrated 64000 heart rate records...
2025-08-05 20:33:45,624 - INFO - Migrated 65000 heart rate records...
2025-08-05 20:33:46,342 - INFO - Migrated 66000 heart rate records...
2025-08-05 20:33:47,071 - INFO - Migrated 67000 heart rate records...
2025-08-05 20:33:47,799 - INFO - Migrated 68000 heart rate records...
2025-08-05 20:33:48,529 - INFO - Migrated 69000 heart rate records...
2025-08-05 20:33:49,239 - INFO - Migrated 70000 heart rate records...
2025-08-05 20:33:49,960 - INFO - Migrated 71000 heart rate records...
2025-08-05 20:33:50,679 - INFO - Migrated 72000 heart rate records...
2025-08-05 20:33:51,406 - INFO - Migrated 73000 heart rate records...
2025-08-05 20:33:52,135 - INFO - Migrated 74000 heart rate records...
2025-08-05 20:33:52,869 - INFO - Migrated 75000 heart rate records...
2025-08-05 20:33:53,600 - INFO - Migrated 76000 heart rate records...
2025-08-05 20:33:54,310 - INFO - Migrated 77000 heart rate records...
2025-08-05 20:33:55,022 - INFO - Migrated 78000 heart rate records...
2025-08-05 20:33:55,747 - INFO - Migrated 79000 heart rate records...
2025-08-05 20:33:56,472 - INFO - Migrated 80000 heart rate records...
2025-08-05 20:33:57,199 - INFO - Migrated 81000 heart rate records...
2025-08-05 20:33:57,924 - INFO - Migrated 82000 heart rate records...
2025-08-05 20:33:58,665 - INFO - Migrated 83000 heart rate records...
2025-08-05 20:33:59,402 - INFO - Migrated 84000 heart rate records...
2025-08-05 20:34:00,143 - INFO - Migrated 85000 heart rate records...
2025-08-05 20:34:00,881 - INFO - Migrated 86000 heart rate records...
2025-08-05 20:34:01,624 - INFO - Migrated 87000 heart rate records...
2025-08-05 20:34:02,360 - INFO - Migrated 88000 heart rate records...
2025-08-05 20:34:03,088 - INFO - Migrated 89000 heart rate records...
2025-08-05 20:34:03,829 - INFO - Migrated 90000 heart rate records...
2025-08-05 20:34:04,541 - INFO - Migrated 91000 heart rate records...
2025-08-05 20:34:05,264 - INFO - Migrated 92000 heart rate records...
2025-08-05 20:34:05,976 - INFO - Migrated 93000 heart rate records...
2025-08-05 20:34:06,698 - INFO - Migrated 94000 heart rate records...
2025-08-05 20:34:07,432 - INFO - Migrated 95000 heart rate records...
2025-08-05 20:34:08,156 - INFO - Migrated 96000 heart rate records...
2025-08-05 20:34:08,889 - INFO - Migrated 97000 heart rate records...
2025-08-05 20:34:09,625 - INFO - Migrated 98000 heart rate records...
2025-08-05 20:34:10,368 - INFO - Migrated 99000 heart rate records...
2025-08-05 20:34:11,109 - INFO - Migrated 100000 heart rate records...
2025-08-05 20:34:11,850 - INFO - Migrated 101000 heart rate records...
2025-08-05 20:34:12,596 - INFO - Migrated 102000 heart rate records...
2025-08-05 20:34:13,334 - INFO - Migrated 103000 heart rate records...
2025-08-05 20:34:14,077 - INFO - Migrated 104000 heart rate records...
2025-08-05 20:34:14,824 - INFO - Migrated 105000 heart rate records...
2025-08-05 20:34:15,564 - INFO - Migrated 106000 heart rate records...
2025-08-05 20:34:16,295 - INFO - Migrated 107000 heart rate records...
2025-08-05 20:34:17,039 - INFO - Migrated 108000 heart rate records...
2025-08-05 20:34:17,765 - INFO - Migrated 109000 heart rate records...
2025-08-05 20:34:18,488 - INFO - Migrated 110000 heart rate records...
2025-08-05 20:34:19,214 - INFO - Migrated 111000 heart rate records...
2025-08-05 20:34:19,951 - INFO - Migrated 112000 heart rate records...
2025-08-05 20:34:20,664 - INFO - Migrated 113000 heart rate records...
2025-08-05 20:34:21,377 - INFO - Migrated 114000 heart rate records...
2025-08-05 20:34:22,099 - INFO - Migrated 115000 heart rate records...
2025-08-05 20:34:22,815 - INFO - Migrated 116000 heart rate records...
2025-08-05 20:34:23,522 - INFO - Migrated 117000 heart rate records...
2025-08-05 20:34:24,221 - INFO - Migrated 118000 heart rate records...
2025-08-05 20:34:24,942 - INFO - Migrated 119000 heart rate records...
2025-08-05 20:34:25,653 - INFO - Migrated 120000 heart rate records...
2025-08-05 20:34:26,373 - INFO - Migrated 121000 heart rate records...
2025-08-05 20:34:27,093 - INFO - Migrated 122000 heart rate records...
2025-08-05 20:34:27,814 - INFO - Migrated 123000 heart rate records...
2025-08-05 20:34:28,529 - INFO - Migrated 124000 heart rate records...
2025-08-05 20:34:29,252 - INFO - Migrated 125000 heart rate records...
2025-08-05 20:34:29,989 - INFO - Migrated 126000 heart rate records...
2025-08-05 20:34:30,722 - INFO - Migrated 127000 heart rate records...
2025-08-05 20:34:31,457 - INFO - Migrated 128000 heart rate records...
2025-08-05 20:34:32,193 - INFO - Migrated 129000 heart rate records...
2025-08-05 20:34:32,907 - INFO - Migrated 130000 heart rate records...
2025-08-05 20:34:33,622 - INFO - Migrated 131000 heart rate records...
2025-08-05 20:34:34,361 - INFO - Migrated 132000 heart rate records...
2025-08-05 20:34:35,086 - INFO - Migrated 133000 heart rate records...
2025-08-05 20:34:35,801 - INFO - Migrated 134000 heart rate records...
2025-08-05 20:34:36,536 - INFO - Migrated 135000 heart rate records...
2025-08-05 20:34:37,282 - INFO - Migrated 136000 heart rate records...
2025-08-05 20:34:38,022 - INFO - Migrated 137000 heart rate records...
2025-08-05 20:34:38,754 - INFO - Migrated 138000 heart rate records...
2025-08-05 20:34:39,467 - INFO - Migrated 139000 heart rate records...
2025-08-05 20:34:40,188 - INFO - Migrated 140000 heart rate records...
2025-08-05 20:34:40,905 - INFO - Migrated 141000 heart rate records...
2025-08-05 20:34:41,633 - INFO - Migrated 142000 heart rate records...
2025-08-05 20:34:42,345 - INFO - Migrated 143000 heart rate records...
2025-08-05 20:34:43,059 - INFO - Migrated 144000 heart rate records...
2025-08-05 20:34:43,772 - INFO - Migrated 145000 heart rate records...
2025-08-05 20:34:44,501 - INFO - Migrated 146000 heart rate records...
2025-08-05 20:34:45,220 - INFO - Migrated 147000 heart rate records...
2025-08-05 20:34:45,934 - INFO - Migrated 148000 heart rate records...
2025-08-05 20:34:46,644 - INFO - Migrated 149000 heart rate records...
2025-08-05 20:34:47,366 - INFO - Migrated 150000 heart rate records...
2025-08-05 20:34:48,093 - INFO - Migrated 151000 heart rate records...
2025-08-05 20:34:48,835 - INFO - Migrated 152000 heart rate records...
2025-08-05 20:34:49,572 - INFO - Migrated 153000 heart rate records...
2025-08-05 20:34:50,292 - INFO - Migrated 154000 heart rate records...
2025-08-05 20:34:51,012 - INFO - Migrated 155000 heart rate records...
2025-08-05 20:34:51,721 - INFO - Migrated 156000 heart rate records...
2025-08-05 20:34:52,442 - INFO - Migrated 157000 heart rate records...
2025-08-05 20:34:53,155 - INFO - Migrated 158000 heart rate records...
2025-08-05 20:34:53,863 - INFO - Migrated 159000 heart rate records...
2025-08-05 20:34:54,565 - INFO - Migrated 160000 heart rate records...
2025-08-05 20:34:55,280 - INFO - Migrated 161000 heart rate records...
2025-08-05 20:34:55,991 - INFO - Migrated 162000 heart rate records...
2025-08-05 20:34:56,699 - INFO - Migrated 163000 heart rate records...
2025-08-05 20:34:57,424 - INFO - Migrated 164000 heart rate records...
2025-08-05 20:34:58,150 - INFO - Migrated 165000 heart rate records...
2025-08-05 20:34:58,885 - INFO - Migrated 166000 heart rate records...
2025-08-05 20:34:59,612 - INFO - Migrated 167000 heart rate records...
2025-08-05 20:35:00,346 - INFO - Migrated 168000 heart rate records...
2025-08-05 20:35:01,076 - INFO - Migrated 169000 heart rate records...
2025-08-05 20:35:01,809 - INFO - Migrated 170000 heart rate records...
2025-08-05 20:35:02,523 - INFO - Migrated 171000 heart rate records...
2025-08-05 20:35:03,247 - INFO - Migrated 172000 heart rate records...
2025-08-05 20:35:03,978 - INFO - Migrated 173000 heart rate records...
2025-08-05 20:35:04,707 - INFO - Migrated 174000 heart rate records...
2025-08-05 20:35:05,437 - INFO - Migrated 175000 heart rate records...
2025-08-05 20:35:06,159 - INFO - Migrated 176000 heart rate records...
2025-08-05 20:35:06,891 - INFO - Migrated 177000 heart rate records...
2025-08-05 20:35:07,624 - INFO - Migrated 178000 heart rate records...
2025-08-05 20:35:08,353 - INFO - Migrated 179000 heart rate records...
2025-08-05 20:35:09,082 - INFO - Migrated 180000 heart rate records...
2025-08-05 20:35:09,802 - INFO - Migrated 181000 heart rate records...
2025-08-05 20:35:10,520 - INFO - Migrated 182000 heart rate records...
2025-08-05 20:35:11,235 - INFO - Migrated 183000 heart rate records...
2025-08-05 20:35:11,952 - INFO - Migrated 184000 heart rate records...
2025-08-05 20:35:12,689 - INFO - Migrated 185000 heart rate records...
2025-08-05 20:35:13,406 - INFO - Migrated 186000 heart rate records...
2025-08-05 20:35:14,119 - INFO - Migrated 187000 heart rate records...
2025-08-05 20:35:14,840 - INFO - Migrated 188000 heart rate records...
2025-08-05 20:35:15,555 - INFO - Migrated 189000 heart rate records...
2025-08-05 20:35:16,274 - INFO - Migrated 190000 heart rate records...
2025-08-05 20:35:16,991 - INFO - Migrated 191000 heart rate records...
2025-08-05 20:35:17,719 - INFO - Migrated 192000 heart rate records...
2025-08-05 20:35:18,441 - INFO - Migrated 193000 heart rate records...
2025-08-05 20:35:19,180 - INFO - Migrated 194000 heart rate records...
2025-08-05 20:35:19,899 - INFO - Migrated 195000 heart rate records...
2025-08-05 20:35:20,640 - INFO - Migrated 196000 heart rate records...
2025-08-05 20:35:21,381 - INFO - Migrated 197000 heart rate records...
2025-08-05 20:35:22,122 - INFO - Migrated 198000 heart rate records...
2025-08-05 20:35:22,857 - INFO - Migrated 199000 heart rate records...
2025-08-05 20:35:23,579 - INFO - Migrated 200000 heart rate records...
2025-08-05 20:35:24,304 - INFO - Migrated 201000 heart rate records...
2025-08-05 20:35:24,993 - INFO - Migrated 202000 heart rate records...
2025-08-05 20:35:25,686 - INFO - Migrated 203000 heart rate records...
2025-08-05 20:35:26,380 - INFO - Migrated 204000 heart rate records...
2025-08-05 20:35:27,109 - INFO - Migrated 205000 heart rate records...
2025-08-05 20:35:27,850 - INFO - Migrated 206000 heart rate records...
2025-08-05 20:35:28,589 - INFO - Migrated 207000 heart rate records...
2025-08-05 20:35:29,333 - INFO - Migrated 208000 heart rate records...
2025-08-05 20:35:30,069 - INFO - Migrated 209000 heart rate records...
2025-08-05 20:35:30,811 - INFO - Migrated 210000 heart rate records...
2025-08-05 20:35:31,532 - INFO - Migrated 211000 heart rate records...
2025-08-05 20:35:32,239 - INFO - Migrated 212000 heart rate records...
2025-08-05 20:35:32,950 - INFO - Migrated 213000 heart rate records...
2025-08-05 20:35:33,677 - INFO - Migrated 214000 heart rate records...
2025-08-05 20:35:34,406 - INFO - Migrated 215000 heart rate records...
2025-08-05 20:35:35,122 - INFO - Migrated 216000 heart rate records...
2025-08-05 20:35:35,842 - INFO - Migrated 217000 heart rate records...
2025-08-05 20:35:36,571 - INFO - Migrated 218000 heart rate records...
2025-08-05 20:35:37,312 - INFO - Migrated 219000 heart rate records...
2025-08-05 20:35:38,022 - INFO - Migrated 220000 heart rate records...
2025-08-05 20:35:38,742 - INFO - Migrated 221000 heart rate records...
2025-08-05 20:35:39,462 - INFO - Migrated 222000 heart rate records...
2025-08-05 20:35:40,175 - INFO - Migrated 223000 heart rate records...
2025-08-05 20:35:40,893 - INFO - Migrated 224000 heart rate records...
2025-08-05 20:35:41,621 - INFO - Migrated 225000 heart rate records...
2025-08-05 20:35:42,340 - INFO - Migrated 226000 heart rate records...
2025-08-05 20:35:43,066 - INFO - Migrated 227000 heart rate records...
2025-08-05 20:35:43,783 - INFO - Migrated 228000 heart rate records...
2025-08-05 20:35:44,513 - INFO - Migrated 229000 heart rate records...
2025-08-05 20:35:45,235 - INFO - Migrated 230000 heart rate records...
2025-08-05 20:35:45,962 - INFO - Migrated 231000 heart rate records...
2025-08-05 20:35:46,689 - INFO - Migrated 232000 heart rate records...
2025-08-05 20:35:47,410 - INFO - Migrated 233000 heart rate records...
2025-08-05 20:35:48,130 - INFO - Migrated 234000 heart rate records...
2025-08-05 20:35:48,848 - INFO - Migrated 235000 heart rate records...
2025-08-05 20:35:49,560 - INFO - Migrated 236000 heart rate records...
2025-08-05 20:35:50,282 - INFO - Migrated 237000 heart rate records...
2025-08-05 20:35:50,993 - INFO - Migrated 238000 heart rate records...
2025-08-05 20:35:51,727 - INFO - Migrated 239000 heart rate records...
2025-08-05 20:35:52,450 - INFO - Migrated 240000 heart rate records...
2025-08-05 20:35:53,172 - INFO - Migrated 241000 heart rate records...
2025-08-05 20:35:53,893 - INFO - Migrated 242000 heart rate records...
2025-08-05 20:35:54,624 - INFO - Migrated 243000 heart rate records...
2025-08-05 20:35:55,343 - INFO - Migrated 244000 heart rate records...
2025-08-05 20:35:56,060 - INFO - Migrated 245000 heart rate records...
2025-08-05 20:35:56,781 - INFO - Migrated 246000 heart rate records...
2025-08-05 20:35:57,523 - INFO - Migrated 247000 heart rate records...
2025-08-05 20:35:58,233 - INFO - Migrated 248000 heart rate records...
2025-08-05 20:35:58,931 - INFO - Migrated 249000 heart rate records...
2025-08-05 20:35:59,654 - INFO - Migrated 250000 heart rate records...
2025-08-05 20:36:00,367 - INFO - Migrated 251000 heart rate records...
2025-08-05 20:36:01,086 - INFO - Migrated 252000 heart rate records...
2025-08-05 20:36:01,806 - INFO - Migrated 253000 heart rate records...
2025-08-05 20:36:02,513 - INFO - Migrated 254000 heart rate records...
2025-08-05 20:36:03,227 - INFO - Migrated 255000 heart rate records...
2025-08-05 20:36:03,927 - INFO - Migrated 256000 heart rate records...
2025-08-05 20:36:04,626 - INFO - Migrated 257000 heart rate records...
2025-08-05 20:36:05,310 - INFO - Migrated 258000 heart rate records...
2025-08-05 20:36:06,017 - INFO - Migrated 259000 heart rate records...
2025-08-05 20:36:06,703 - INFO - Migrated 260000 heart rate records...
2025-08-05 20:36:07,408 - INFO - Migrated 261000 heart rate records...
2025-08-05 20:36:08,114 - INFO - Migrated 262000 heart rate records...
2025-08-05 20:36:08,839 - INFO - Migrated 263000 heart rate records...
2025-08-05 20:36:09,557 - INFO - Migrated 264000 heart rate records...
2025-08-05 20:36:10,260 - INFO - Migrated 265000 heart rate records...
2025-08-05 20:36:10,979 - INFO - Migrated 266000 heart rate records...
2025-08-05 20:36:11,699 - INFO - Migrated 267000 heart rate records...
2025-08-05 20:36:12,401 - INFO - Migrated 268000 heart rate records...
2025-08-05 20:36:13,121 - INFO - Migrated 269000 heart rate records...
2025-08-05 20:36:13,834 - INFO - Migrated 270000 heart rate records...
2025-08-05 20:36:14,589 - INFO - Migrated 271000 heart rate records...
2025-08-05 20:36:15,317 - INFO - Migrated 272000 heart rate records...
2025-08-05 20:36:16,021 - INFO - Migrated 273000 heart rate records...
2025-08-05 20:36:16,734 - INFO - Migrated 274000 heart rate records...
2025-08-05 20:36:17,460 - INFO - Migrated 275000 heart rate records...
2025-08-05 20:36:18,171 - INFO - Migrated 276000 heart rate records...
2025-08-05 20:36:18,888 - INFO - Migrated 277000 heart rate records...
2025-08-05 20:36:19,601 - INFO - Migrated 278000 heart rate records...
2025-08-05 20:36:20,338 - INFO - Migrated 279000 heart rate records...
2025-08-05 20:36:21,063 - INFO - Migrated 280000 heart rate records...
2025-08-05 20:36:21,785 - INFO - Migrated 281000 heart rate records...
2025-08-05 20:36:22,510 - INFO - Migrated 282000 heart rate records...
2025-08-05 20:36:23,233 - INFO - Migrated 283000 heart rate records...
2025-08-05 20:36:23,950 - INFO - Migrated 284000 heart rate records...
2025-08-05 20:36:24,669 - INFO - Migrated 285000 heart rate records...
2025-08-05 20:36:25,384 - INFO - Migrated 286000 heart rate records...
2025-08-05 20:36:26,089 - INFO - Migrated 287000 heart rate records...
2025-08-05 20:36:26,809 - INFO - Migrated 288000 heart rate records...
2025-08-05 20:36:27,532 - INFO - Migrated 289000 heart rate records...
2025-08-05 20:36:28,241 - INFO - Migrated 290000 heart rate records...
2025-08-05 20:36:28,939 - INFO - Migrated 291000 heart rate records...
2025-08-05 20:36:29,664 - INFO - Migrated 292000 heart rate records...
2025-08-05 20:36:30,393 - INFO - Migrated 293000 heart rate records...
2025-08-05 20:36:31,110 - INFO - Migrated 294000 heart rate records...
2025-08-05 20:36:31,831 - INFO - Migrated 295000 heart rate records...
2025-08-05 20:36:32,549 - INFO - Migrated 296000 heart rate records...
2025-08-05 20:36:33,264 - INFO - Migrated 297000 heart rate records...
2025-08-05 20:36:33,978 - INFO - Migrated 298000 heart rate records...
2025-08-05 20:36:34,706 - INFO - Migrated 299000 heart rate records...
2025-08-05 20:36:35,425 - INFO - Migrated 300000 heart rate records...
2025-08-05 20:36:36,119 - INFO - Migrated 301000 heart rate records...
2025-08-05 20:36:36,824 - INFO - Migrated 302000 heart rate records...
2025-08-05 20:36:37,533 - INFO - Migrated 303000 heart rate records...
2025-08-05 20:36:38,253 - INFO - Migrated 304000 heart rate records...
2025-08-05 20:36:38,963 - INFO - Migrated 305000 heart rate records...
2025-08-05 20:36:39,221 - INFO - Migrated 305354 heart rate records
2025-08-05 20:41:42,498 - INFO - Database tables created/verified
2025-08-05 20:41:42,499 - INFO - Available columns in monitoring_rr table: ['timestamp', 'rr']
2025-08-05 20:41:42,499 - INFO - Using columns: timestamp=timestamp, respiratory_rate=rr
2025-08-05 20:41:43,380 - INFO - Migrated 1000 respiratory rate records...
2025-08-05 20:41:44,126 - INFO - Migrated 2000 respiratory rate records...
2025-08-05 20:41:44,855 - INFO - Migrated 3000 respiratory rate records...
2025-08-05 20:41:45,578 - INFO - Migrated 4000 respiratory rate records...
2025-08-05 20:41:46,299 - INFO - Migrated 5000 respiratory rate records...
2025-08-05 20:41:47,029 - INFO - Migrated 6000 respiratory rate records...
2025-08-05 20:41:47,774 - INFO - Migrated 7000 respiratory rate records...
2025-08-05 20:41:48,517 - INFO - Migrated 8000 respiratory rate records...
2025-08-05 20:41:49,271 - INFO - Migrated 9000 respiratory rate records...
2025-08-05 20:41:50,016 - INFO - Migrated 10000 respiratory rate records...
2025-08-05 20:41:50,726 - INFO - Migrated 11000 respiratory rate records...
2025-08-05 20:41:51,458 - INFO - Migrated 12000 respiratory rate records...
2025-08-05 20:41:52,192 - INFO - Migrated 13000 respiratory rate records...
2025-08-05 20:41:52,940 - INFO - Migrated 14000 respiratory rate records...
2025-08-05 20:41:53,678 - INFO - Migrated 15000 respiratory rate records...
2025-08-05 20:41:54,389 - INFO - Migrated 16000 respiratory rate records...
2025-08-05 20:41:55,082 - INFO - Migrated 17000 respiratory rate records...
2025-08-05 20:41:55,789 - INFO - Migrated 18000 respiratory rate records...
2025-08-05 20:41:56,498 - INFO - Migrated 19000 respiratory rate records...
2025-08-05 20:41:57,217 - INFO - Migrated 20000 respiratory rate records...
2025-08-05 20:41:57,938 - INFO - Migrated 21000 respiratory rate records...
2025-08-05 20:41:58,644 - INFO - Migrated 22000 respiratory rate records...
2025-08-05 20:41:59,372 - INFO - Migrated 23000 respiratory rate records...
2025-08-05 20:42:00,084 - INFO - Migrated 24000 respiratory rate records...
2025-08-05 20:42:00,794 - INFO - Migrated 25000 respiratory rate records...
2025-08-05 20:42:01,500 - INFO - Migrated 26000 respiratory rate records...
2025-08-05 20:42:02,219 - INFO - Migrated 27000 respiratory rate records...
2025-08-05 20:42:02,945 - INFO - Migrated 28000 respiratory rate records...
2025-08-05 20:42:03,664 - INFO - Migrated 29000 respiratory rate records...
2025-08-05 20:42:04,383 - INFO - Migrated 30000 respiratory rate records...
2025-08-05 20:42:05,104 - INFO - Migrated 31000 respiratory rate records...
2025-08-05 20:42:05,823 - INFO - Migrated 32000 respiratory rate records...
2025-08-05 20:42:06,554 - INFO - Migrated 33000 respiratory rate records...
2025-08-05 20:42:07,263 - INFO - Migrated 34000 respiratory rate records...
2025-08-05 20:42:07,987 - INFO - Migrated 35000 respiratory rate records...
2025-08-05 20:42:08,709 - INFO - Migrated 36000 respiratory rate records...
2025-08-05 20:42:09,446 - INFO - Migrated 37000 respiratory rate records...
2025-08-05 20:42:10,176 - INFO - Migrated 38000 respiratory rate records...
2025-08-05 20:42:10,914 - INFO - Migrated 39000 respiratory rate records...
2025-08-05 20:42:11,621 - INFO - Migrated 40000 respiratory rate records...
2025-08-05 20:42:12,350 - INFO - Migrated 41000 respiratory rate records...
2025-08-05 20:42:13,077 - INFO - Migrated 42000 respiratory rate records...
2025-08-05 20:42:13,786 - INFO - Migrated 43000 respiratory rate records...
2025-08-05 20:42:14,493 - INFO - Migrated 44000 respiratory rate records...
2025-08-05 20:42:15,200 - INFO - Migrated 45000 respiratory rate records...
2025-08-05 20:42:15,916 - INFO - Migrated 46000 respiratory rate records...
2025-08-05 20:42:16,626 - INFO - Migrated 47000 respiratory rate records...
2025-08-05 20:42:17,326 - INFO - Migrated 48000 respiratory rate records...
2025-08-05 20:42:18,048 - INFO - Migrated 49000 respiratory rate records...
2025-08-05 20:42:18,764 - INFO - Migrated 50000 respiratory rate records...
2025-08-05 20:42:19,484 - INFO - Migrated 51000 respiratory rate records...
2025-08-05 20:42:20,195 - INFO - Migrated 52000 respiratory rate records...
2025-08-05 20:42:20,901 - INFO - Migrated 53000 respiratory rate records...
2025-08-05 20:42:21,642 - INFO - Migrated 54000 respiratory rate records...
2025-08-05 20:42:22,364 - INFO - Migrated 55000 respiratory rate records...
2025-08-05 20:42:23,079 - INFO - Migrated 56000 respiratory rate records...
2025-08-05 20:42:23,801 - INFO - Migrated 57000 respiratory rate records...
2025-08-05 20:42:24,515 - INFO - Migrated 58000 respiratory rate records...
2025-08-05 20:42:25,227 - INFO - Migrated 59000 respiratory rate records...
2025-08-05 20:42:25,942 - INFO - Migrated 60000 respiratory rate records...
2025-08-05 20:42:26,659 - INFO - Migrated 61000 respiratory rate records...
2025-08-05 20:42:27,389 - INFO - Migrated 62000 respiratory rate records...
2025-08-05 20:42:28,126 - INFO - Migrated 63000 respiratory rate records...
2025-08-05 20:42:28,870 - INFO - Migrated 64000 respiratory rate records...
2025-08-05 20:42:29,607 - INFO - Migrated 65000 respiratory rate records...
2025-08-05 20:42:30,342 - INFO - Migrated 66000 respiratory rate records...
2025-08-05 20:42:31,078 - INFO - Migrated 67000 respiratory rate records...
2025-08-05 20:42:31,823 - INFO - Migrated 68000 respiratory rate records...
2025-08-05 20:42:32,566 - INFO - Migrated 69000 respiratory rate records...
2025-08-05 20:42:33,316 - INFO - Migrated 70000 respiratory rate records...
2025-08-05 20:42:34,069 - INFO - Migrated 71000 respiratory rate records...
2025-08-05 20:42:34,821 - INFO - Migrated 72000 respiratory rate records...
2025-08-05 20:42:35,562 - INFO - Migrated 73000 respiratory rate records...
2025-08-05 20:42:36,304 - INFO - Migrated 74000 respiratory rate records...
2025-08-05 20:42:37,045 - INFO - Migrated 75000 respiratory rate records...
2025-08-05 20:42:37,786 - INFO - Migrated 76000 respiratory rate records...
2025-08-05 20:42:38,503 - INFO - Migrated 77000 respiratory rate records...
2025-08-05 20:42:39,211 - INFO - Migrated 78000 respiratory rate records...
2025-08-05 20:42:39,911 - INFO - Migrated 79000 respiratory rate records...
2025-08-05 20:42:40,636 - INFO - Migrated 80000 respiratory rate records...
2025-08-05 20:42:41,336 - INFO - Migrated 81000 respiratory rate records...
2025-08-05 20:42:42,036 - INFO - Migrated 82000 respiratory rate records...
2025-08-05 20:42:42,763 - INFO - Migrated 83000 respiratory rate records...
2025-08-05 20:42:43,505 - INFO - Migrated 84000 respiratory rate records...
2025-08-05 20:42:44,250 - INFO - Migrated 85000 respiratory rate records...
2025-08-05 20:42:44,981 - INFO - Migrated 86000 respiratory rate records...
2025-08-05 20:42:45,732 - INFO - Migrated 87000 respiratory rate records...
2025-08-05 20:42:46,506 - INFO - Migrated 88000 respiratory rate records...
2025-08-05 20:42:47,272 - INFO - Migrated 89000 respiratory rate records...
2025-08-05 20:42:48,021 - INFO - Migrated 90000 respiratory rate records...
2025-08-05 20:42:48,740 - INFO - Migrated 91000 respiratory rate records...
2025-08-05 20:42:49,474 - INFO - Migrated 92000 respiratory rate records...
2025-08-05 20:42:50,218 - INFO - Migrated 93000 respiratory rate records...
2025-08-05 20:42:50,954 - INFO - Migrated 94000 respiratory rate records...
2025-08-05 20:42:51,708 - INFO - Migrated 95000 respiratory rate records...
2025-08-05 20:42:52,460 - INFO - Migrated 96000 respiratory rate records...
2025-08-05 20:42:53,199 - INFO - Migrated 97000 respiratory rate records...
2025-08-05 20:42:53,945 - INFO - Migrated 98000 respiratory rate records...
2025-08-05 20:42:54,691 - INFO - Migrated 99000 respiratory rate records...
2025-08-05 20:42:55,413 - INFO - Migrated 100000 respiratory rate records...
2025-08-05 20:42:56,149 - INFO - Migrated 101000 respiratory rate records...
2025-08-05 20:42:56,889 - INFO - Migrated 102000 respiratory rate records...
2025-08-05 20:42:57,629 - INFO - Migrated 103000 respiratory rate records...
2025-08-05 20:42:58,357 - INFO - Migrated 104000 respiratory rate records...
2025-08-05 20:42:59,083 - INFO - Migrated 105000 respiratory rate records...
2025-08-05 20:42:59,810 - INFO - Migrated 106000 respiratory rate records...
2025-08-05 20:43:00,552 - INFO - Migrated 107000 respiratory rate records...
2025-08-05 20:43:01,286 - INFO - Migrated 108000 respiratory rate records...
2025-08-05 20:43:02,024 - INFO - Migrated 109000 respiratory rate records...
2025-08-05 20:43:02,766 - INFO - Migrated 110000 respiratory rate records...
2025-08-05 20:43:03,514 - INFO - Migrated 111000 respiratory rate records...
2025-08-05 20:43:04,247 - INFO - Migrated 112000 respiratory rate records...
2025-08-05 20:43:04,997 - INFO - Migrated 113000 respiratory rate records...
2025-08-05 20:43:05,754 - INFO - Migrated 114000 respiratory rate records...
2025-08-05 20:43:06,518 - INFO - Migrated 115000 respiratory rate records...
2025-08-05 20:43:07,271 - INFO - Migrated 116000 respiratory rate records...
2025-08-05 20:43:08,022 - INFO - Migrated 117000 respiratory rate records...
2025-08-05 20:43:08,743 - INFO - Migrated 118000 respiratory rate records...
2025-08-05 20:43:09,473 - INFO - Migrated 119000 respiratory rate records...
2025-08-05 20:43:10,219 - INFO - Migrated 120000 respiratory rate records...
2025-08-05 20:43:10,978 - INFO - Migrated 121000 respiratory rate records...
2025-08-05 20:43:11,743 - INFO - Migrated 122000 respiratory rate records...
2025-08-05 20:43:12,489 - INFO - Migrated 123000 respiratory rate records...
2025-08-05 20:43:13,233 - INFO - Migrated 124000 respiratory rate records...
2025-08-05 20:43:13,992 - INFO - Migrated 125000 respiratory rate records...
2025-08-05 20:43:14,737 - INFO - Migrated 126000 respiratory rate records...
2025-08-05 20:43:15,474 - INFO - Migrated 127000 respiratory rate records...
2025-08-05 20:43:16,224 - INFO - Migrated 128000 respiratory rate records...
2025-08-05 20:43:16,961 - INFO - Migrated 129000 respiratory rate records...
2025-08-05 20:43:17,701 - INFO - Migrated 130000 respiratory rate records...
2025-08-05 20:43:18,448 - INFO - Migrated 131000 respiratory rate records...
2025-08-05 20:43:19,170 - INFO - Migrated 132000 respiratory rate records...
2025-08-05 20:43:19,902 - INFO - Migrated 133000 respiratory rate records...
2025-08-05 20:43:20,646 - INFO - Migrated 134000 respiratory rate records...
2025-08-05 20:43:21,388 - INFO - Migrated 135000 respiratory rate records...
2025-08-05 20:43:22,132 - INFO - Migrated 136000 respiratory rate records...
2025-08-05 20:43:22,893 - INFO - Migrated 137000 respiratory rate records...
2025-08-05 20:43:23,639 - INFO - Migrated 138000 respiratory rate records...
2025-08-05 20:43:24,379 - INFO - Migrated 139000 respiratory rate records...
2025-08-05 20:43:25,098 - INFO - Migrated 140000 respiratory rate records...
2025-08-05 20:43:25,848 - INFO - Migrated 141000 respiratory rate records...
2025-08-05 20:43:26,590 - INFO - Migrated 142000 respiratory rate records...
2025-08-05 20:43:27,333 - INFO - Migrated 143000 respiratory rate records...
2025-08-05 20:43:28,079 - INFO - Migrated 144000 respiratory rate records...
2025-08-05 20:43:28,838 - INFO - Migrated 145000 respiratory rate records...
2025-08-05 20:43:29,592 - INFO - Migrated 146000 respiratory rate records...
2025-08-05 20:43:30,340 - INFO - Migrated 147000 respiratory rate records...
2025-08-05 20:43:31,089 - INFO - Migrated 148000 respiratory rate records...
2025-08-05 20:43:31,843 - INFO - Migrated 149000 respiratory rate records...
2025-08-05 20:43:32,604 - INFO - Migrated 150000 respiratory rate records...
2025-08-05 20:43:33,334 - INFO - Migrated 151000 respiratory rate records...
2025-08-05 20:43:34,076 - INFO - Migrated 152000 respiratory rate records...
2025-08-05 20:43:34,833 - INFO - Migrated 153000 respiratory rate records...
2025-08-05 20:43:35,556 - INFO - Migrated 154000 respiratory rate records...
2025-08-05 20:43:36,300 - INFO - Migrated 155000 respiratory rate records...
2025-08-05 20:43:37,050 - INFO - Migrated 156000 respiratory rate records...
2025-08-05 20:43:37,779 - INFO - Migrated 157000 respiratory rate records...
2025-08-05 20:43:38,529 - INFO - Migrated 158000 respiratory rate records...
2025-08-05 20:43:39,255 - INFO - Migrated 159000 respiratory rate records...
2025-08-05 20:43:40,014 - INFO - Migrated 160000 respiratory rate records...
2025-08-05 20:43:40,790 - INFO - Migrated 161000 respiratory rate records...
2025-08-05 20:43:41,514 - INFO - Migrated 162000 respiratory rate records...
2025-08-05 20:43:42,240 - INFO - Migrated 163000 respiratory rate records...
2025-08-05 20:43:42,970 - INFO - Migrated 164000 respiratory rate records...
2025-08-05 20:43:43,705 - INFO - Migrated 165000 respiratory rate records...
2025-08-05 20:43:44,439 - INFO - Migrated 166000 respiratory rate records...
2025-08-05 20:43:45,204 - INFO - Migrated 167000 respiratory rate records...
2025-08-05 20:43:45,974 - INFO - Migrated 168000 respiratory rate records...
2025-08-05 20:43:46,739 - INFO - Migrated 169000 respiratory rate records...
2025-08-05 20:43:47,495 - INFO - Migrated 170000 respiratory rate records...
2025-08-05 20:43:48,266 - INFO - Migrated 171000 respiratory rate records...
2025-08-05 20:43:49,029 - INFO - Migrated 172000 respiratory rate records...
2025-08-05 20:43:49,789 - INFO - Migrated 173000 respiratory rate records...
2025-08-05 20:43:50,568 - INFO - Migrated 174000 respiratory rate records...
2025-08-05 20:43:51,348 - INFO - Migrated 175000 respiratory rate records...
2025-08-05 20:43:52,100 - INFO - Migrated 176000 respiratory rate records...
2025-08-05 20:43:52,857 - INFO - Migrated 177000 respiratory rate records...
2025-08-05 20:43:53,610 - INFO - Migrated 178000 respiratory rate records...
2025-08-05 20:43:54,340 - INFO - Migrated 179000 respiratory rate records...
2025-08-05 20:43:55,056 - INFO - Migrated 180000 respiratory rate records...
2025-08-05 20:43:55,802 - INFO - Migrated 181000 respiratory rate records...
2025-08-05 20:43:56,550 - INFO - Migrated 182000 respiratory rate records...
2025-08-05 20:43:57,279 - INFO - Migrated 183000 respiratory rate records...
2025-08-05 20:43:58,019 - INFO - Migrated 184000 respiratory rate records...
2025-08-05 20:43:58,752 - INFO - Migrated 185000 respiratory rate records...
2025-08-05 20:43:59,498 - INFO - Migrated 186000 respiratory rate records...
2025-08-05 20:44:00,250 - INFO - Migrated 187000 respiratory rate records...
2025-08-05 20:44:01,017 - INFO - Migrated 188000 respiratory rate records...
2025-08-05 20:44:01,770 - INFO - Migrated 189000 respiratory rate records...
2025-08-05 20:44:02,518 - INFO - Migrated 190000 respiratory rate records...
2025-08-05 20:44:03,274 - INFO - Migrated 191000 respiratory rate records...
2025-08-05 20:44:04,026 - INFO - Migrated 192000 respiratory rate records...
2025-08-05 20:44:04,792 - INFO - Migrated 193000 respiratory rate records...
2025-08-05 20:44:05,544 - INFO - Migrated 194000 respiratory rate records...
2025-08-05 20:44:06,317 - INFO - Migrated 195000 respiratory rate records...
2025-08-05 20:44:07,080 - INFO - Migrated 196000 respiratory rate records...
2025-08-05 20:44:07,824 - INFO - Migrated 197000 respiratory rate records...
2025-08-05 20:44:08,570 - INFO - Migrated 198000 respiratory rate records...
2025-08-05 20:44:09,329 - INFO - Migrated 199000 respiratory rate records...
2025-08-05 20:44:10,073 - INFO - Migrated 200000 respiratory rate records...
2025-08-05 20:44:10,813 - INFO - Migrated 201000 respiratory rate records...
2025-08-05 20:44:11,545 - INFO - Migrated 202000 respiratory rate records...
2025-08-05 20:44:12,270 - INFO - Migrated 203000 respiratory rate records...
2025-08-05 20:44:12,993 - INFO - Migrated 204000 respiratory rate records...
2025-08-05 20:44:13,724 - INFO - Migrated 205000 respiratory rate records...
2025-08-05 20:44:14,449 - INFO - Migrated 206000 respiratory rate records...
2025-08-05 20:44:15,181 - INFO - Migrated 207000 respiratory rate records...
2025-08-05 20:44:15,937 - INFO - Migrated 208000 respiratory rate records...
2025-08-05 20:44:16,670 - INFO - Migrated 209000 respiratory rate records...
2025-08-05 20:44:17,398 - INFO - Migrated 210000 respiratory rate records...
2025-08-05 20:44:18,136 - INFO - Migrated 211000 respiratory rate records...
2025-08-05 20:44:18,892 - INFO - Migrated 212000 respiratory rate records...
2025-08-05 20:44:19,643 - INFO - Migrated 213000 respiratory rate records...
2025-08-05 20:44:20,406 - INFO - Migrated 214000 respiratory rate records...
2025-08-05 20:44:21,150 - INFO - Migrated 215000 respiratory rate records...
2025-08-05 20:44:21,911 - INFO - Migrated 216000 respiratory rate records...
2025-08-05 20:44:22,665 - INFO - Migrated 217000 respiratory rate records...
2025-08-05 20:44:23,409 - INFO - Migrated 218000 respiratory rate records...
2025-08-05 20:44:24,129 - INFO - Migrated 219000 respiratory rate records...
2025-08-05 20:44:24,854 - INFO - Migrated 220000 respiratory rate records...
2025-08-05 20:44:25,582 - INFO - Migrated 221000 respiratory rate records...
2025-08-05 20:44:26,310 - INFO - Migrated 222000 respiratory rate records...
2025-08-05 20:44:27,056 - INFO - Migrated 223000 respiratory rate records...
2025-08-05 20:44:27,809 - INFO - Migrated 224000 respiratory rate records...
2025-08-05 20:44:28,539 - INFO - Migrated 225000 respiratory rate records...
2025-08-05 20:44:29,287 - INFO - Migrated 226000 respiratory rate records...
2025-08-05 20:44:30,037 - INFO - Migrated 227000 respiratory rate records...
2025-08-05 20:44:30,765 - INFO - Migrated 228000 respiratory rate records...
2025-08-05 20:44:31,489 - INFO - Migrated 229000 respiratory rate records...
2025-08-05 20:44:32,212 - INFO - Migrated 230000 respiratory rate records...
2025-08-05 20:44:32,948 - INFO - Migrated 231000 respiratory rate records...
2025-08-05 20:44:33,679 - INFO - Migrated 232000 respiratory rate records...
2025-08-05 20:44:34,434 - INFO - Migrated 233000 respiratory rate records...
2025-08-05 20:44:35,177 - INFO - Migrated 234000 respiratory rate records...
2025-08-05 20:44:35,919 - INFO - Migrated 235000 respiratory rate records...
2025-08-05 20:44:36,666 - INFO - Migrated 236000 respiratory rate records...
2025-08-05 20:44:37,396 - INFO - Migrated 237000 respiratory rate records...
2025-08-05 20:44:38,123 - INFO - Migrated 238000 respiratory rate records...
2025-08-05 20:44:38,850 - INFO - Migrated 239000 respiratory rate records...
2025-08-05 20:44:39,573 - INFO - Migrated 240000 respiratory rate records...
2025-08-05 20:44:40,300 - INFO - Migrated 241000 respiratory rate records...
2025-08-05 20:44:41,022 - INFO - Migrated 242000 respiratory rate records...
2025-08-05 20:44:41,758 - INFO - Migrated 243000 respiratory rate records...
2025-08-05 20:44:42,480 - INFO - Migrated 244000 respiratory rate records...
2025-08-05 20:44:43,201 - INFO - Migrated 245000 respiratory rate records...
2025-08-05 20:44:43,930 - INFO - Migrated 246000 respiratory rate records...
2025-08-05 20:44:44,664 - INFO - Migrated 247000 respiratory rate records...
2025-08-05 20:44:45,405 - INFO - Migrated 248000 respiratory rate records...
2025-08-05 20:44:46,138 - INFO - Migrated 249000 respiratory rate records...
2025-08-05 20:44:46,860 - INFO - Migrated 250000 respiratory rate records...
2025-08-05 20:44:47,584 - INFO - Migrated 251000 respiratory rate records...
2025-08-05 20:44:48,309 - INFO - Migrated 252000 respiratory rate records...
2025-08-05 20:44:49,024 - INFO - Migrated 253000 respiratory rate records...
2025-08-05 20:44:49,752 - INFO - Migrated 254000 respiratory rate records...
2025-08-05 20:44:50,472 - INFO - Migrated 255000 respiratory rate records...
2025-08-05 20:44:51,201 - INFO - Migrated 256000 respiratory rate records...
2025-08-05 20:44:51,928 - INFO - Migrated 257000 respiratory rate records...
2025-08-05 20:44:52,646 - INFO - Migrated 258000 respiratory rate records...
2025-08-05 20:44:53,379 - INFO - Migrated 259000 respiratory rate records...
2025-08-05 20:44:54,123 - INFO - Migrated 260000 respiratory rate records...
2025-08-05 20:44:54,852 - INFO - Migrated 261000 respiratory rate records...
2025-08-05 20:44:55,592 - INFO - Migrated 262000 respiratory rate records...
2025-08-05 20:44:56,326 - INFO - Migrated 263000 respiratory rate records...
2025-08-05 20:44:57,039 - INFO - Migrated 264000 respiratory rate records...
2025-08-05 20:44:57,771 - INFO - Migrated 265000 respiratory rate records...
2025-08-05 20:44:58,523 - INFO - Migrated 266000 respiratory rate records...
2025-08-05 20:44:59,276 - INFO - Migrated 267000 respiratory rate records...
2025-08-05 20:45:00,033 - INFO - Migrated 268000 respiratory rate records...
2025-08-05 20:45:00,660 - INFO - Migrated 268844 respiratory rate records
